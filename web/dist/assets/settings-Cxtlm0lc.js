import{d as k,b as x,h as S,s as h,i as _,y as P,u as e,E as D,c as C,e as z,Q as B}from"./query-client-DIfHb7sS.js";import{C as M}from"./LoadingIndicator-DbxhRnFU.js";import{H as L,F as I}from"./Footer-D76HMRTv.js";function H(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function T(){const[t,g]=k({logLevel:"2",storagePath:"/var/lib/lightnvr/recordings",storagePathHls:"",maxStorage:"0",retention:"30",autoDelete:!0,dbPath:"/var/lib/lightnvr/lightnvr.db",webPort:"8080",authEnabled:!0,username:"admin",password:"admin",webrtcDisabled:!1,bufferSize:"1024",useSwap:!0,swapSize:"128",detectionModelsPath:"",defaultDetectionThreshold:50,defaultPreBuffer:5,defaultPostBuffer:10}),{data:r,isLoading:u,error:E,refetch:m}=x(["settings"],"/api/settings",{timeout:15e3,retries:2,retryDelay:1e3}),p=S({mutationKey:["saveSettings"],mutationFn:async s=>await _("/api/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),timeout:2e4,retries:1,retryDelay:2e3}),onSuccess:()=>{h("Settings saved successfully"),m()},onError:s=>{console.error("Error saving settings:",s),h("Error saving settings: ".concat(s.message))}});P(()=>{var s,d,n,i,o,l,c,b;if(r){console.log("Settings loaded:",r);const w={logLevel:((s=r.log_level)==null?void 0:s.toString())||"",storagePath:r.storage_path||"",storagePathHls:r.storage_path_hls||"",maxStorage:((d=r.max_storage_size)==null?void 0:d.toString())||"",retention:((n=r.retention_days)==null?void 0:n.toString())||"",autoDelete:r.auto_delete_oldest||!1,dbPath:r.db_path||"",webPort:((i=r.web_port)==null?void 0:i.toString())||"",authEnabled:r.web_auth_enabled||!1,username:r.web_username||"",password:r.web_password||"",webrtcDisabled:r.webrtc_disabled||!1,bufferSize:((o=r.buffer_size)==null?void 0:o.toString())||"",useSwap:r.use_swap||!1,swapSize:((l=r.swap_size)==null?void 0:l.toString())||"",detectionModelsPath:r.models_path||"",defaultDetectionThreshold:r.default_detection_threshold||50,defaultPreBuffer:((c=r.pre_detection_buffer)==null?void 0:c.toString())||"5",defaultPostBuffer:((b=r.post_detection_buffer)==null?void 0:b.toString())||"10"};g(v=>({...v,...w}))}},[r]);const f=()=>{const s={log_level:parseInt(t.logLevel,10),storage_path:t.storagePath,storage_path_hls:t.storagePathHls,max_storage_size:parseInt(t.maxStorage,10),retention_days:parseInt(t.retention,10),auto_delete_oldest:t.autoDelete,db_path:t.dbPath,web_port:parseInt(t.webPort,10),web_auth_enabled:t.authEnabled,web_username:t.username,web_password:t.password,webrtc_disabled:t.webrtcDisabled,buffer_size:parseInt(t.bufferSize,10),use_swap:t.useSwap,swap_size:parseInt(t.swapSize,10),models_path:t.detectionModelsPath,default_detection_threshold:t.defaultDetectionThreshold,pre_detection_buffer:parseInt(t.defaultPreBuffer,10),post_detection_buffer:parseInt(t.defaultPostBuffer,10)};p.mutate(s)},a=s=>{const{name:d,value:n,type:i,checked:o}=s.target;g(l=>({...l,[d]:i==="checkbox"?o:n}))},y=s=>{const d=parseInt(s.target.value,10);g(n=>({...n,defaultDetectionThreshold:d}))};return e("section",{id:"settings-page",class:"page",children:[e("div",{class:"page-header flex justify-between items-center mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow",children:[e("h2",{class:"text-xl font-bold",children:"Settings"}),e("div",{class:"controls",children:e("button",{id:"save-settings-btn",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",onClick:f,children:"Save Settings"})})]}),e(M,{isLoading:u,hasData:!!r,loadingMessage:"Loading settings...",emptyMessage:"No settings available. Please try again later.",children:e("div",{class:"settings-container space-y-6",children:[e("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"General Settings"}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-log-level",class:"font-medium",children:"Log Level"}),e("select",{id:"setting-log-level",name:"logLevel",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.logLevel,onChange:a,children:[e("option",{value:"0",children:"Error"}),e("option",{value:"1",children:"Warning"}),e("option",{value:"2",children:"Info"}),e("option",{value:"3",children:"Debug"})]})]})]}),e("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Storage Settings"}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-storage-path",class:"font-medium",children:"Storage Path"}),e("input",{type:"text",id:"setting-storage-path",name:"storagePath",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.storagePath,onChange:a})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-storage-path-hls",class:"font-medium",children:"HLS Storage Path"}),e("div",{class:"col-span-2",children:[e("input",{type:"text",id:"setting-storage-path-hls",name:"storagePathHls",class:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.storagePathHls,onChange:a}),e("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Optional path for HLS segments. If not specified, Storage Path will be used."})]})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-max-storage",class:"font-medium",children:"Maximum Storage Size (GB)"}),e("div",{class:"col-span-2 flex items-center",children:[e("input",{type:"number",id:"setting-max-storage",name:"maxStorage",min:"0",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.maxStorage,onChange:a}),e("span",{class:"hint ml-2 text-sm text-gray-500 dark:text-gray-400",children:"0 = unlimited"})]})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-retention",class:"font-medium",children:"Retention Period (days)"}),e("input",{type:"number",id:"setting-retention",name:"retention",min:"1",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.retention,onChange:a})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-auto-delete",class:"font-medium",children:"Auto Delete Oldest"}),e("div",{class:"col-span-2",children:e("input",{type:"checkbox",id:"setting-auto-delete",name:"autoDelete",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:t.autoDelete,onChange:a})})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-db-path",class:"font-medium",children:"Database Path"}),e("input",{type:"text",id:"setting-db-path",name:"dbPath",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.dbPath,onChange:a})]})]}),e("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Web Interface Settings"}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-web-port",class:"font-medium",children:"Web Port"}),e("input",{type:"number",id:"setting-web-port",name:"webPort",min:"1",max:"65535",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.webPort,onChange:a})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-auth-enabled",class:"font-medium",children:"Enable Authentication"}),e("div",{class:"col-span-2",children:e("input",{type:"checkbox",id:"setting-auth-enabled",name:"authEnabled",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:t.authEnabled,onChange:a})})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-username",class:"font-medium",children:"Username"}),e("input",{type:"text",id:"setting-username",name:"username",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.username,onChange:a})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-password",class:"font-medium",children:"Password"}),e("input",{type:"password",id:"setting-password",name:"password",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.password,onChange:a})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-webrtc-disabled",class:"font-medium",children:"Disable WebRTC (Use HLS Only)"}),e("div",{class:"col-span-2",children:[e("input",{type:"checkbox",id:"setting-webrtc-disabled",name:"webrtcDisabled",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:t.webrtcDisabled,onChange:a}),e("span",{class:"hint ml-2 text-sm text-gray-500 dark:text-gray-400",children:"When enabled, all streams will use HLS instead of WebRTC"})]})]})]}),e("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Memory Optimization"}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-buffer-size",class:"font-medium",children:"Buffer Size (KB)"}),e("input",{type:"number",id:"setting-buffer-size",name:"bufferSize",min:"128",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.bufferSize,onChange:a})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-use-swap",class:"font-medium",children:"Use Swap File"}),e("div",{class:"col-span-2",children:e("input",{type:"checkbox",id:"setting-use-swap",name:"useSwap",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:t.useSwap,onChange:a})})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-swap-size",class:"font-medium",children:"Swap Size (MB)"}),e("input",{type:"number",id:"setting-swap-size",name:"swapSize",min:"32",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.swapSize,onChange:a})]})]}),e("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Detection-Based Recording"}),e("div",{class:"setting mb-4",children:[e("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:"Configure detection-based recording for streams. When enabled, recordings will only be saved when objects are detected."}),e("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:[e("strong",{children:"Motion Detection:"}),' Built-in motion detection is available without requiring any external models. Select "motion" as the detection model in stream settings to use this feature.']}),e("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:[e("strong",{children:"Optimized Motion Detection:"}),' Memory and CPU optimized motion detection for embedded devices. Select "motion" as the detection model in stream settings to use this feature.']})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-detection-models-path",class:"font-medium",children:"Detection Models Path"}),e("div",{class:"col-span-2",children:[e("input",{type:"text",id:"setting-detection-models-path",name:"detectionModelsPath",placeholder:"/var/lib/lightnvr/models",class:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.detectionModelsPath,onChange:a}),e("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Directory where detection models are stored"})]})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-default-detection-threshold",class:"font-medium",children:"Default Detection Threshold"}),e("div",{class:"col-span-2",children:[e("div",{class:"flex items-center",children:[e("input",{type:"range",id:"setting-default-detection-threshold",name:"defaultDetectionThreshold",min:"0",max:"100",step:"1",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700",value:t.defaultDetectionThreshold,onChange:y}),e("span",{id:"threshold-value",class:"ml-2 min-w-[3rem] text-center",children:[t.defaultDetectionThreshold,"%"]})]}),e("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Confidence threshold for detection (0-100%)"})]})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-default-pre-buffer",class:"font-medium",children:"Default Pre-detection Buffer (seconds)"}),e("div",{class:"col-span-2",children:[e("input",{type:"number",id:"setting-default-pre-buffer",name:"defaultPreBuffer",min:"0",max:"60",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.defaultPreBuffer,onChange:a}),e("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Seconds of video to keep before detection"})]})]}),e("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[e("label",{for:"setting-default-post-buffer",class:"font-medium",children:"Default Post-detection Buffer (seconds)"}),e("div",{class:"col-span-2",children:[e("input",{type:"number",id:"setting-default-post-buffer",name:"defaultPostBuffer",min:"0",max:"300",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:t.defaultPostBuffer,onChange:a}),e("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Seconds of video to keep after detection"})]})]})]})]})})]})}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("main-content");t&&D(e(B,{client:C,children:[e(L,{}),e(z,{}),e(T,{}),e(I,{})]}),t)});export{H as __vite_legacy_guard};
//# sourceMappingURL=settings-Cxtlm0lc.js.map
