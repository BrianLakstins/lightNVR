{"version":3,"file":"Footer-legacy-CpSOvPOh.js","sources":["../../js/components/preact/Footer.jsx","../../js/components/preact/Header.jsx","../../js/version.js"],"sourcesContent":["/**\n * LightNVR Web Interface Footer Component\n * Preact component for the site footer\n */\n\nimport { h } from 'preact';\nimport { useState } from 'preact/hooks';\n\n/**\n * Footer component\n * @param {Object} props - Component props\n * @returns {JSX.Element} Footer component\n */\nexport function Footer() {\n  const [year] = useState(new Date().getFullYear());\n\n  return (\n    <footer class=\"bg-gray-800 text-white py-3 px-4 mt-4 shadow-inner\">\n      <div class=\"container mx-auto flex flex-col sm:flex-row justify-between items-center\">\n        <div class=\"text-center sm:text-left mb-2 sm:mb-0\">\n          <p class=\"text-sm\">© {year} LightNVR ·\n            <a href=\"https://github.com/opensensor/lightnvr\" class=\"text-blue-300 hover:text-blue-100 text-sm\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub</a>\n          </p>\n          <p class=\"text-xs text-gray-400 mt-1 hidden sm:block\">Lightweight Network Video Recorder</p>\n        </div>\n      </div>\n    </footer>\n  );\n}\n\n","/**\n * LightNVR Web Interface Header Component\n * Preact component for the site header\n */\n\nimport { h } from 'preact';\nimport { useState, useEffect } from 'preact/hooks';\nimport {VERSION} from '../../version.js';\n\n/**\n * Header component\n * @param {Object} props - Component props\n * @param {string} props.version - System version\n * @returns {JSX.Element} Header component\n */\nexport function Header({ version = VERSION }) {\n  // Get active navigation from data attribute on header container\n  const headerContainer = document.getElementById('header-container');\n  const activeNav = headerContainer?.dataset?.activeNav || '';\n  const [username, setUsername] = useState('');\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  // Get the current username from localStorage\n  useEffect(() => {\n    const auth = localStorage.getItem('auth');\n    if (auth) {\n      try {\n        // Decode the base64 auth string (username:password)\n        const decoded = atob(auth);\n        // Extract the username (everything before the colon)\n        const extractedUsername = decoded.split(':')[0];\n        setUsername(extractedUsername);\n      } catch (error) {\n        console.error('Error decoding auth token:', error);\n        setUsername('User');\n      }\n    } else {\n      setUsername('User');\n    }\n  }, []);\n\n  // Handle logout\n  const handleLogout = (e) => {\n    e.preventDefault();\n\n    // Clear localStorage\n    localStorage.removeItem('auth');\n\n    // Clear cookies\n    document.cookie = \"auth=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Strict\";\n    document.cookie = \"session=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Strict\";\n\n    // Call the logout endpoint to clear browser's basic auth cache\n    fetch('/api/auth/logout', {\n      method: 'POST'\n    }).then(() => {\n      window.location.href = 'login.html?auth_required=true&logout=true';\n    }).catch(() => {\n      // Redirect even if the request fails\n      window.location.href = 'login.html?auth_required=true&logout=true';\n    });\n  };\n\n  // Toggle mobile menu\n  const toggleMobileMenu = () => {\n    setMobileMenuOpen(!mobileMenuOpen);\n  };\n\n  // Special handling for Live View link to handle both index.html and root URL\n  const getLiveViewHref = () => {\n    // Check if we're on the root URL or index.html\n    const isRoot = window.location.pathname === '/' || window.location.pathname.endsWith('/');\n\n    // If we're on the root URL, stay on the root URL\n    if (isRoot) {\n      return './';\n    }\n\n    // Otherwise, default to index.html\n    return 'index.html';\n  };\n\n  // Navigation items - don't preserve query parameters when navigating via header\n  const navItems = [\n    { id: 'nav-live', href: getLiveViewHref(), label: 'Live View' },\n    { id: 'nav-recordings', href: 'recordings.html', label: 'Recordings' },\n    { id: 'nav-streams', href: 'streams.html', label: 'Streams' },\n    { id: 'nav-settings', href: 'settings.html', label: 'Settings' },\n    { id: 'nav-users', href: 'users.html', label: 'Users' },\n    { id: 'nav-system', href: 'system.html', label: 'System' }\n  ];\n\n  // Render navigation item\n  const renderNavItem = (item) => {\n    const isActive = activeNav === item.id;\n    const baseClasses = \"text-white no-underline rounded transition-colors\";\n    const desktopClasses = \"px-3 py-2\";\n    const mobileClasses = \"block w-full px-4 py-3 text-left\";\n    const activeClass = isActive ? 'bg-blue-600' : 'hover:bg-blue-700';\n\n    return (\n      <li className={mobileMenuOpen ? \"w-full\" : \"mx-1\"}>\n        <a\n          href={item.href}\n          id={item.id}\n          className={`${baseClasses} ${mobileMenuOpen ? mobileClasses : desktopClasses} ${activeClass}`}\n          onClick={mobileMenuOpen ? toggleMobileMenu : null}\n        >\n          {item.label}\n        </a>\n      </li>\n    );\n  };\n\n  return (\n    <header className=\"bg-gray-800 text-white py-2 shadow-md mb-4 w-full\">\n      <div className=\"container mx-auto px-4 flex justify-between items-center\">\n        <div className=\"logo flex items-center\">\n          <h1 className=\"text-xl font-bold m-0\">LightNVR</h1>\n          <span className=\"version text-blue-200 text-xs ml-2\">v{version}</span>\n        </div>\n\n        {/* Desktop Navigation */}\n        <nav className=\"hidden md:block\">\n          <ul className=\"flex list-none m-0 p-0\">\n            {navItems.map(renderNavItem)}\n          </ul>\n        </nav>\n\n        {/* User Menu (Desktop) */}\n        <div className=\"user-menu hidden md:flex items-center\">\n          <span className=\"mr-2\">{username}</span>\n          <a href=\"#\" onClick={handleLogout} className=\"logout-link text-white no-underline hover:bg-blue-700 px-3 py-1 rounded transition-colors\">Logout</a>\n        </div>\n\n        {/* Mobile Menu Button */}\n        <button\n          className=\"md:hidden text-white p-2 focus:outline-none\"\n          onClick={toggleMobileMenu}\n          aria-label=\"Toggle menu\"\n        >\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d={mobileMenuOpen ? \"M6 18L18 6M6 6l12 12\" : \"M4 6h16M4 12h16M4 18h16\"} />\n          </svg>\n        </button>\n      </div>\n\n      {/* Mobile Navigation */}\n      {mobileMenuOpen && (\n        <div className=\"md:hidden mt-2 border-t border-gray-700 pt-2 container mx-auto px-4\">\n          <ul className=\"list-none m-0 p-0 flex flex-col w-full\">\n            {navItems.map(renderNavItem)}\n            <li className=\"w-full mt-2 pt-2 border-t border-gray-700\">\n              <div className=\"flex justify-between items-center px-4 py-2\">\n                <span>{username}</span>\n                <a href=\"#\" onClick={handleLogout} className=\"logout-link text-white no-underline hover:bg-blue-700 px-3 py-1 rounded transition-colors\">Logout</a>\n              </div>\n            </li>\n          </ul>\n        </div>\n      )}\n    </header>\n  );\n}","/**\n * LightNVR version information\n * This file is auto-generated from CMakeLists.txt during the build process\n * DO NOT EDIT MANUALLY\n */\n\nexport const VERSION = '0.11.19';\n"],"names":["year","useState","Date","getFullYear","jsx","class","children","jsxs","href","target","rel","version","VERSION","headerContainer","document","getElementById","activeNav","dataset","username","setUsername","mobileMenuOpen","setMobileMenuOpen","useEffect","auth","localStorage","getItem","extractedUsername","atob","split","error","console","handleLogout","e","preventDefault","removeItem","cookie","fetch","method","then","window","location","catch","toggleMobileMenu","navItems","id","pathname","endsWith","label","renderNavItem","item","activeClass","className","onClick","map","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d"],"mappings":"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"}