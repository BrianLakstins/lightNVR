System.register(["./preact-app-legacy-CG_QZm6V.js"],(function(e,t){"use strict";var n;return{setters:[e=>{n=e.s}],execute:function(){function t(e,t){e&&(e.stopPropagation(),e.preventDefault()),console.log("DIRECT EXIT FUNCTION CALLED");const n=document.getElementById("live-page");if(!n)return void console.error("Live page element not found");n.classList.remove("fullscreen-mode"),document.body.style.overflow="";const o=document.querySelector(".fullscreen-exit");o?o.remove():console.warn("Exit button not found when trying to remove it");const l=document.getElementById("fullscreen-btn");l?l.style.display="":console.warn("Fullscreen button not found when trying to show it again"),window._fullscreenEscapeHandler&&(document.removeEventListener("keydown",window._fullscreenEscapeHandler),delete window._fullscreenEscapeHandler),t(!1),console.log("Fullscreen mode exited, state set to false")}e({a:function(e,n){console.log("toggleFullscreen called, current state:",e);const o=document.getElementById("live-page");if(!o)return void console.error("Live page element not found");const l=o.classList.contains("fullscreen-mode");if(console.log("DOM check for fullscreen mode:",l),l)t(null,n);else{console.log("Entering fullscreen mode"),o.classList.add("fullscreen-mode"),document.body.style.overflow="hidden";const e=document.createElement("button");e.className="fullscreen-exit fixed top-4 right-4 w-10 h-10 bg-black/70 text-white rounded-full flex justify-center items-center cursor-pointer z-50 transition-all duration-200 hover:bg-black/85 hover:scale-110 shadow-md",e.innerHTML="âœ•";const l=function(e){console.log("Exit button clicked - STANDALONE HANDLER"),t(e,n)};e.addEventListener("click",l),o.appendChild(e);const c=document.getElementById("fullscreen-btn");c&&(c.style.display="none");const r=function(e){"Escape"===e.key&&(console.log("Escape key pressed in fullscreen mode"),t(null,n))};window._fullscreenEscapeHandler=r,document.addEventListener("keydown",r),n(!0),console.log("Fullscreen mode entered, state set to true")}},c:function(e,t){const n=`canvas-${e.replace(/\s+/g,"-")}`,o=document.getElementById(n);o&&o.detectionInterval&&(clearInterval(o.detectionInterval),delete o.detectionInterval),t[e]&&(clearInterval(t[e]),delete t[e])},e:t,s:function(e,t,n,o){o[e]&&clearInterval(o[e]);let l=0,c=1e3;const r=()=>{n.videoWidth&&fetch(`/api/detection/results/${encodeURIComponent(e)}`).then((e=>{if(!e.ok)throw new Error(`Failed to fetch detection results: ${e.status}`);return l=0,e.json()})).then((e=>{e&&e.detections&&(e=>{const o=t,l=o.getContext("2d");if(o.width=n.clientWidth,o.height=n.clientHeight,l.clearRect(0,0,o.width,o.height),!e||0===e.length)return;const c=n.videoWidth,r=n.videoHeight;if(!c||!r)return void console.log("Video dimensions not available yet, skipping detection drawing");const s=c/r,i=o.width/o.height;let d,a,u=0,f=0;s>i?(d=o.width,a=o.width/s,f=(o.height-a)/2):(a=o.height,d=o.height*s,u=(o.width-d)/2),e.forEach((e=>{const t=e.x*d+u,n=e.y*a+f,o=e.width*d,c=e.height*a;l.strokeStyle="rgba(255, 0, 0, 0.8)",l.lineWidth=3,l.strokeRect(t,n,o,c);const r=`${e.label} (${Math.round(100*e.confidence)}%)`;l.font="14px Arial";const s=l.measureText(r).width;l.fillStyle="rgba(255, 0, 0, 0.7)",l.fillRect(t,n-20,s+10,20),l.fillStyle="white",l.fillText(r,t+5,n-5)}))})(e.detections)})).catch((n=>{console.error(`Error fetching detection results for ${e}:`,n),t.getContext("2d").clearRect(0,0,t.width,t.height),l++,l>3&&(clearInterval(o[e]),c=Math.min(5e3,2*c),console.log(`Reducing detection polling frequency to ${c}ms due to errors`),o[e]=setInterval(r,c))}))},s=setInterval(r,c);return o[e]=s,t.detectionInterval=s,s},t:function(e){const t=`video-${e.replace(/\s+/g,"-")}`,o=document.getElementById(t),l=o?o.closest(".video-cell"):null;l?document.fullscreenElement?document.exitFullscreen():l.requestFullscreen().catch((e=>{console.error(`Error attempting to enable fullscreen: ${e.message}`),n(`Could not enable fullscreen mode: ${e.message}`)})):console.error("Stream not found:",e)}})}}}));
//# sourceMappingURL=FullscreenManager-legacy-BIRYA34B.js.map
