import{d as i,A as h,y as f,u as e,E as y,q as x,Q as v}from"./query-client-mfCUf3pQ.js";/* empty css               */function P(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function k(){const[o,p]=i(""),[s,b]=i(""),[d,c]=i(!1),[n,t]=i(""),l=h(null);f(()=>{const r=new URLSearchParams(window.location.search);r.has("error")?t("Invalid username or password"):r.has("auth_required")&&r.has("logout")?t("You have been successfully logged out."):r.has("auth_required")?t("Authentication required. Please log in to continue."):r.has("logout")&&t("You have been successfully logged out.")},[]),h(null),f(()=>()=>{l.current&&clearTimeout(l.current)},[]);const w=async r=>{if(r.preventDefault(),!o||!s){t("Please enter both username and password");return}c(!0),t("");try{const a=btoa("".concat(o,":").concat(s));if(localStorage.setItem("auth",a),(await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic ".concat(a)},body:JSON.stringify({username:o,password:s}),timeout:1e4})).ok){console.log("Login successful, proceeding to redirect");try{const g=new URLSearchParams(window.location.search).get("redirect"),m=g||"/index.html";l.current=setTimeout(()=>{console.log("Fallback: trying window.location.href"),window.location.href=m,l.current=setTimeout(()=>{console.log("Fallback: trying window.location.replace"),window.location.replace(m)},500)},500)}catch(u){console.error("Redirect error:",u),window.location.replace("index.html")}}else c(!1),t("Invalid username or password"),localStorage.removeItem("auth")}catch(a){console.error("Login error:",a),c(!1),t("An error occurred during login. Please try again."),localStorage.removeItem("auth")}};return e("section",{id:"login-page",className:"page flex items-center justify-center min-h-screen",children:e("div",{className:"login-container w-full max-w-md p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[e("div",{className:"text-center mb-8",children:[e("h1",{className:"text-2xl font-bold",children:"LightNVR"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Please sign in to continue"})]}),n&&e("div",{className:(()=>{const r="mb-4 p-3 rounded-lg ",a=n.includes("successfully logged out")||n.includes("Click the button below")||n.includes("Login successful");return r+(a?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200")})(),children:n}),e("form",{id:"login-form",className:"space-y-6",action:"/api/auth/login",method:"POST",onSubmit:w,children:[e("div",{className:"form-group",children:[e("label",{htmlFor:"username",className:"block text-sm font-medium mb-1",children:"Username"}),e("input",{type:"text",id:"username",name:"username",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Enter your username",value:o,onChange:r=>p(r.target.value),required:!0,autoComplete:"username"})]}),e("div",{className:"form-group",children:[e("label",{htmlFor:"password",className:"block text-sm font-medium mb-1",children:"Password"}),e("input",{type:"password",id:"password",name:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Enter your password",value:s,onChange:r=>b(r.target.value),required:!0,autoComplete:"current-password"})]}),e("div",{className:"form-group",children:e("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:d,children:d?"Signing in...":"Sign In"})})]}),e("div",{className:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400",children:[e("p",{children:"Default credentials: admin / admin"}),e("p",{className:"mt-2",children:"You can change these in Settings after login"})]})]})})}document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("main-content");o&&y(e(v,{client:x,children:e(k,{})}),o)});export{P as __vite_legacy_guard};
//# sourceMappingURL=login-Bmwna6B_.js.map
