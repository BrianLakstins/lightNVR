System.register(["./query-client-legacy-DpGFWkK1.js","./Footer-legacy-DqOCiyV5.js","./LoadingIndicator-legacy-CgixVNwJ.js","./websocket-client-legacy-BO-Yc0A6.js"],(function(e,t){"use strict";var r,a,n,o,d,i,s,l,c,g,m,h,u,p,b,y,w,f,x,v,k;return{setters:[e=>{r=e.c,a=e.a,n=e.f,o=e.u,d=e.b,i=e.g,s=e.h,l=e.d,c=e.A,g=e.y,m=e.E,h=e.e,u=e.Q},e=>{p=e.c,b=e.D,y=e.e,w=e.H,f=e.F},e=>{x=e.C},e=>{v=e.W,k=e.B}],execute:function(){var e=document.createElement("style");function t(e,t=3e3){let r=document.getElementById("status-message-container");r||(r=document.createElement("div"),r.id="status-message-container",r.className="fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50 flex flex-col items-center",document.body.appendChild(r));const a=document.createElement("div");a.className="bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg mb-2 transition-all duration-300 opacity-0 transform translate-y-2",a.textContent=e,r.appendChild(a),setTimeout((()=>{a.classList.remove("opacity-0","translate-y-2")}),10),setTimeout((()=>{a.classList.add("opacity-0","translate-y-2"),setTimeout((()=>{a.parentNode===r&&r.removeChild(a),0===r.children.length&&document.body.removeChild(r)}),300)}),t)}function D(){let e=document.getElementById("batch-delete-modal-container");e||(e=document.createElement("div"),e.id="batch-delete-modal-container",document.body.appendChild(e)),e.innerHTML='\n        <div id="batch-delete-modal" class="modal hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50">\n            <div class="modal-content relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md mx-auto p-6 w-full">\n                <div class="modal-header flex justify-between items-center mb-4 pb-2 border-b border-gray-200 dark:border-gray-700">\n                    <h3 id="batch-delete-modal-title" class="text-xl font-bold text-gray-900 dark:text-white">Batch Delete Progress</h3>\n                    <button id="batch-delete-close-btn" class="close text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-2xl font-bold">&times;</button>\n                </div>\n                <div class="modal-body">\n                    <div id="batch-delete-status" class="mb-4 text-gray-700 dark:text-gray-300">\n                        Preparing to delete recordings...\n                    </div>\n                    <div class="progress-container bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-4">\n                        <div id="batch-delete-progress-bar" class="bg-green-500 h-4 rounded-full text-center text-xs text-white" style="width: 0%"></div>\n                    </div>\n                    <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-6">\n                        <div id="batch-delete-count">0 / 0</div>\n                        <div id="batch-delete-percentage">0%</div>\n                    </div>\n                    <div id="batch-delete-details" class="mb-4">\n                        <div class="flex justify-between mb-2">\n                            <span class="text-gray-700 dark:text-gray-300">Succeeded:</span>\n                            <span id="batch-delete-succeeded" class="font-bold text-green-600 dark:text-green-400">0</span>\n                        </div>\n                        <div class="flex justify-between">\n                            <span class="text-gray-700 dark:text-gray-300">Failed:</span>\n                            <span id="batch-delete-failed" class="font-bold text-red-600 dark:text-red-400">0</span>\n                        </div>\n                    </div>\n                    <div id="batch-delete-message" class="text-sm italic text-gray-600 dark:text-gray-400 mb-4"></div>\n                </div>\n                <div class="modal-footer flex justify-end pt-2 border-t border-gray-200 dark:border-gray-700">\n                    <button id="batch-delete-done-btn" class="btn btn-primary hidden">Done</button>\n                    <button id="batch-delete-cancel-btn" class="btn btn-secondary">Cancel</button>\n                </div>\n            </div>\n        </div>\n    ';const t=document.getElementById("batch-delete-modal"),r=document.getElementById("batch-delete-close-btn"),a=document.getElementById("batch-delete-done-btn"),n=document.getElementById("batch-delete-cancel-btn");r&&r.addEventListener("click",R),a&&a.addEventListener("click",R),n&&n.addEventListener("click",C),window.addEventListener("click",(e=>{e.target===t&&R()}))}function S(){const e=document.getElementById("batch-delete-modal");e||D(),function(){const e=document.getElementById("batch-delete-progress-bar");e&&(e.style.width="0%");const t=document.getElementById("batch-delete-status");t&&(t.textContent="Preparing to delete recordings...");const r=document.getElementById("batch-delete-count");r&&(r.textContent="0 / 0");const a=document.getElementById("batch-delete-percentage");a&&(a.textContent="0%");const n=document.getElementById("batch-delete-succeeded");n&&(n.textContent="0");const o=document.getElementById("batch-delete-failed");o&&(o.textContent="0");const d=document.getElementById("batch-delete-message");d&&(d.textContent="");const i=document.getElementById("batch-delete-done-btn");i&&i.classList.add("hidden");const s=document.getElementById("batch-delete-cancel-btn");s&&s.classList.remove("hidden")}(),e.classList.remove("hidden")}function R(){const e=document.getElementById("batch-delete-modal");e&&e.classList.add("hidden")}function C(){R(),t("Batch delete operation cancelled",5e3)}function T({filters:e,setFilters:t,pagination:a,setPagination:n,streams:o,filtersVisible:d,applyFilters:i,resetFilters:s,handleDateRangeChange:l,setDefaultDateRange:c}){return r("aside",{id:"filters-sidebar",className:"filters-sidebar w-full md:w-64 bg-white dark:bg-gray-800 rounded-lg shadow p-4 md:sticky md:top-4 md:self-start transition-all duration-300 "+(d?"":"hidden md:block"),children:[r("div",{className:"filter-group mb-4",children:[r("h3",{className:"text-lg font-medium mb-2 pb-1 border-b border-gray-200 dark:border-gray-700",children:"Date Range"}),r("div",{className:"filter-option mb-2",children:[r("label",{htmlFor:"date-range-select",className:"block mb-1 text-sm font-medium",children:"Quick Select:"}),r("select",{id:"date-range-select",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.dateRange,onChange:l,children:[r("option",{value:"today",children:"Today"}),r("option",{value:"yesterday",children:"Yesterday"}),r("option",{value:"last7days",children:"Last 7 Days"}),r("option",{value:"last30days",children:"Last 30 Days"}),r("option",{value:"custom",children:"Custom Range"})]})]}),r("div",{id:"custom-date-range",className:"filter-option space-y-3",style:{display:"custom"===e.dateRange?"block":"none"},children:[r("div",{className:"space-y-1",children:[r("label",{htmlFor:"start-date",className:"block text-sm font-medium",children:"Start Date:"}),r("input",{type:"date",id:"start-date",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.startDate,onChange:e=>t((t=>({...t,startDate:e.target.value})))}),r("div",{className:"mt-1",children:[r("label",{htmlFor:"start-time",className:"block text-sm font-medium",children:"Time:"}),r("input",{type:"time",id:"start-time",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.startTime,onChange:e=>t((t=>({...t,startTime:e.target.value})))})]})]}),r("div",{className:"space-y-1",children:[r("label",{htmlFor:"end-date",className:"block text-sm font-medium",children:"End Date:"}),r("input",{type:"date",id:"end-date",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.endDate,onChange:e=>t((t=>({...t,endDate:e.target.value})))}),r("div",{className:"mt-1",children:[r("label",{htmlFor:"end-time",className:"block text-sm font-medium",children:"Time:"}),r("input",{type:"time",id:"end-time",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.endTime,onChange:e=>t((t=>({...t,endTime:e.target.value})))})]})]})]})]}),r("div",{className:"filter-group mb-4",children:[r("h3",{className:"text-lg font-medium mb-2 pb-1 border-b border-gray-200 dark:border-gray-700",children:"Stream"}),r("div",{className:"filter-option",children:r("select",{id:"stream-filter",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.streamId,onChange:e=>t((t=>({...t,streamId:e.target.value}))),children:[r("option",{value:"all",children:"All Streams"}),o.map((e=>r("option",{value:e.name,children:e.name},e.name)))]})})]}),r("div",{className:"filter-group mb-4",children:[r("h3",{className:"text-lg font-medium mb-2 pb-1 border-b border-gray-200 dark:border-gray-700",children:"Recording Type"}),r("div",{className:"filter-option",children:r("select",{id:"detection-filter",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.recordingType,onChange:e=>t((t=>({...t,recordingType:e.target.value}))),children:[r("option",{value:"all",children:"All Recordings"}),r("option",{value:"detection",children:"Detection Events Only"})]})})]}),r("div",{className:"filter-group mb-4",children:[r("h3",{className:"text-lg font-medium mb-2 pb-1 border-b border-gray-200 dark:border-gray-700",children:"Display Options"}),r("div",{className:"filter-option",children:[r("label",{htmlFor:"page-size",className:"block mb-1 text-sm font-medium",children:"Items per page:"}),r("select",{id:"page-size",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:a.pageSize,onChange:e=>n((t=>({...t,pageSize:parseInt(e.target.value,10)}))),children:[r("option",{value:"10",children:"10"}),r("option",{value:"20",children:"20"}),r("option",{value:"50",children:"50"}),r("option",{value:"100",children:"100"})]})]})]}),r("div",{className:"filter-actions flex space-x-2",children:[r("button",{id:"apply-filters-btn",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",onClick:i,children:"Apply Filters"}),r("button",{id:"reset-filters-btn",className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 transition-colors dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",onClick:s,children:"Reset"})]})]})}function P({activeFiltersDisplay:e,removeFilter:t,hasActiveFilters:a}){return a?r("div",{id:"active-filters",className:"active-filters mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg flex flex-wrap gap-2",children:e.map(((e,a)=>r("div",{className:"filter-tag inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200",children:[r("span",{children:e.label}),r("button",{className:"ml-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none",onClick:()=>t(e.key),children:"×"})]},a)))}):null}e.textContent=".sortable{position:relative;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none}.sortable:hover{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}@media (prefers-color-scheme: dark){.sortable:hover{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}}.sort-icon{margin-left:.375rem;display:inline-block;width:.625rem;opacity:.5}.sort-asc .sort-icon,.sort-desc .sort-icon{opacity:1}.filters-sidebar{width:100%;flex-shrink:0;border-radius:.5rem;padding:1rem;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}@media (min-width: 768px){.filters-sidebar{width:18rem}}.filters-sidebar{transition:transform .3s ease,opacity .3s ease,width .3s ease}.filters-sidebar.collapsed{margin-top:0;margin-bottom:0;max-height:0px;overflow:hidden;padding-top:0;padding-bottom:0;opacity:0}.filter-tag{display:inline-flex;align-items:center;border-radius:9999px;--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1));padding:.25rem .75rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}@media (prefers-color-scheme: dark){.filter-tag{background-color:rgba(30,58,138,.3);--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}}.filter-tag .remove-filter{margin-left:.5rem;cursor:pointer;font-size:1rem;line-height:1.5rem;font-weight:700;line-height:1}@media (max-width: 576px){#recordings-table{min-width:500px;max-width:100%}.recordings-container,.overflow-x-auto{max-width:100%}}\n/*$vite$:1*/",document.head.appendChild(e),window.updateBatchDeleteProgress=function(e){console.log("Updating batch delete progress UI:",e),S();const t=document.getElementById("batch-delete-progress-bar");if(t){if(console.log(`Updating progress bar: current=${e.current}, total=${e.total}`),e.total>0){const r=Math.round(e.current/e.total*100);console.log(`Setting progress bar width to ${r}%`),t.style.width=`${r}%`,t.classList.remove("animate-pulse"),t.offsetWidth}else if(e.current>0){const r=Math.min(90,e.current/10);console.log(`Setting progress bar width to ${r}% (estimated)`),t.style.width=`${r}%`,t.classList.add("animate-pulse"),t.offsetWidth}else e.complete?(console.log("Setting progress bar to 100% (complete)"),t.style.width="100%",t.classList.remove("animate-pulse"),t.offsetWidth):(console.log("Setting progress bar to 50% (indeterminate)"),t.style.width="50%",t.classList.add("animate-pulse"),t.offsetWidth);e.error?(t.classList.add("bg-red-500"),t.classList.remove("bg-blue-500")):(t.classList.add("bg-blue-500"),t.classList.remove("bg-red-500"))}const r=document.getElementById("batch-delete-status");r&&e.status&&(r.textContent=e.status);const a=document.getElementById("batch-delete-count");a&&(e.total>0?a.textContent=`${e.current} / ${e.total}`:a.textContent=`${e.current} / ?`);const n=document.getElementById("batch-delete-percentage");if(n)if(e.total>0){const t=Math.round(e.current/e.total*100);n.textContent=`${t}%`}else e.complete?n.textContent="100%":n.textContent="In progress";const o=document.getElementById("batch-delete-succeeded");o&&(o.textContent=e.succeeded||"0");const d=document.getElementById("batch-delete-failed");if(d&&(d.textContent=e.failed||"0"),e.complete){const a=document.getElementById("batch-delete-done-btn");a&&a.classList.remove("hidden");const n=document.getElementById("batch-delete-cancel-btn");n&&n.classList.add("hidden"),!r||e.status&&"Preparing to delete recordings..."!==e.status||(r.textContent="Batch delete operation complete"),t&&(t.style.width="100%",t.classList.remove("animate-pulse"))}},window.batchDeleteRecordingsByHttpRequest=function(e){return console.log("Using HTTP fallback for batch delete with params:",e),new Promise(((r,a)=>{S();let n=0;e.ids?n=e.ids.length:e.filter&&e.totalCount&&(n=e.totalCount),updateBatchDeleteProgress({current:0,total:n,status:"Using HTTP fallback for batch delete operation",succeeded:0,failed:0}),fetch("/api/recordings/batch-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(!e.ok)throw new Error(`HTTP error ${e.status}: ${e.statusText}`);return e.json()})).then((e=>{console.log("HTTP batch delete result:",e);const a=e.total||n||0,o=e.succeeded||0,d=e.failed||0;updateBatchDeleteProgress({current:a,total:a,succeeded:o,failed:d,status:"Batch delete operation complete",complete:!0}),t(e.success?`Successfully deleted ${o} recordings`:`Deleted ${o} recordings with ${d} failures`,5e3),setTimeout((()=>{"function"==typeof loadRecordings&&loadRecordings()}),1e3),r(e)})).catch((e=>{console.error("HTTP batch delete error:",e),updateBatchDeleteProgress({current:0,total:0,succeeded:0,failed:0,status:`Error: ${e.message||"Unknown error"}`,complete:!0,error:!0}),t(`Error: ${e.message||"Unknown error"}`,5e3),a(e)}))}))},document.addEventListener("DOMContentLoaded",(()=>{if(console.log("Initializing batch delete modal"),D(),!document.getElementById("batch-delete-modal-container")){console.error("Batch delete modal container not found, creating it");const e=document.createElement("div");e.id="batch-delete-modal-container",document.body.appendChild(e),D()}"function"!=typeof window.updateBatchDeleteProgress&&(console.error("updateBatchDeleteProgress function not available, setting it up"),window.updateBatchDeleteProgress=updateBatchDeleteProgress),"function"!=typeof window.showBatchDeleteModal&&(console.error("showBatchDeleteModal function not available, setting it up"),window.showBatchDeleteModal=S)})),window.showBatchDeleteModal=S,window.updateBatchDeleteProgress=updateBatchDeleteProgress,window.initBatchDeleteModal=D;const I=e=>e?new Date(e).toLocaleString():"",N=e=>{if(!e)return"00:00:00";const t=Math.floor(e/3600),r=Math.floor(e%3600/60),a=Math.floor(e%60);return[t.toString().padStart(2,"0"),r.toString().padStart(2,"0"),a.toString().padStart(2,"0")].join(":")};function E({recordings:e,sortField:t,sortDirection:a,sortBy:n,selectedRecordings:o,toggleRecordingSelection:d,selectAll:i,toggleSelectAll:s,getSelectedCount:l,openDeleteModal:c,playRecording:g,downloadRecording:m,deleteRecording:h,recordingsTableBodyRef:u,pagination:p}){return r("div",{className:"recordings-container bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden w-full",children:[r("div",{className:"batch-actions p-3 border-b border-gray-200 dark:border-gray-700 flex flex-wrap gap-2 items-center",children:[r("div",{className:"selected-count text-sm text-gray-600 dark:text-gray-400 mr-2",children:l()>0?`${l()} recording${1!==l()?"s":""} selected`:"No recordings selected"}),r("button",{className:"px-3 py-1.5 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:0===l(),onClick:()=>c("selected"),children:"Delete Selected"}),r("button",{className:"px-3 py-1.5 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",onClick:()=>c("all"),children:"Delete All Filtered"})]}),r("div",{className:"overflow-x-auto",children:r("table",{id:"recordings-table",className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[r("thead",{className:"bg-gray-50 dark:bg-gray-700",children:r("tr",{children:[r("th",{className:"w-10 px-4 py-3",children:r("input",{type:"checkbox",checked:i,onChange:s,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})}),r("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer",onClick:()=>n("stream_name"),children:r("div",{className:"flex items-center",children:["Stream","stream_name"===t&&r("span",{className:"sort-icon ml-1",children:"asc"===a?"▲":"▼"})]})}),r("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer",onClick:()=>n("start_time"),children:r("div",{className:"flex items-center",children:["Start Time","start_time"===t&&r("span",{className:"sort-icon ml-1",children:"asc"===a?"▲":"▼"})]})}),r("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Duration"}),r("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer",onClick:()=>n("size_bytes"),children:r("div",{className:"flex items-center",children:["Size","size_bytes"===t&&r("span",{className:"sort-icon ml-1",children:"asc"===a?"▲":"▼"})]})}),r("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Detections"}),r("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),r("tbody",{ref:u,className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:0===e.length?r("tr",{children:r("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:0===p.totalItems?"No recordings found":"Loading recordings..."})}):e.map((e=>r("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[r("td",{className:"px-4 py-4 whitespace-nowrap",children:r("input",{type:"checkbox",checked:!!o[e.id],onChange:()=>d(e.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})}),r("td",{className:"px-6 py-4 whitespace-nowrap",children:e.stream||""}),r("td",{className:"px-6 py-4 whitespace-nowrap",children:I(e.start_time)}),r("td",{className:"px-6 py-4 whitespace-nowrap",children:N(e.duration)}),r("td",{className:"px-6 py-4 whitespace-nowrap",children:e.size||""}),r("td",{className:"px-6 py-4 whitespace-nowrap",children:e.has_detections?r("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100",children:[r("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[r("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),r("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}),"Yes"]}):""}),r("td",{className:"px-6 py-4 whitespace-nowrap",children:r("div",{className:"flex space-x-2",children:[r("button",{className:"p-1 rounded-full text-blue-600 hover:bg-blue-100 dark:text-blue-400 dark:hover:bg-blue-900 focus:outline-none",onClick:()=>g(e),title:"Play",children:r("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:r("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),r("button",{className:"p-1 rounded-full text-green-600 hover:bg-green-100 dark:text-green-400 dark:hover:bg-green-900 focus:outline-none",onClick:()=>m(e),title:"Download",children:r("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:r("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})}),r("button",{className:"p-1 rounded-full text-red-600 hover:bg-red-100 dark:text-red-400 dark:hover:bg-red-900 focus:outline-none",onClick:()=>h(e),title:"Delete",children:r("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:r("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})})]},e.id)))})]})})]})}function $({pagination:e,goToPage:t}){return r("div",{className:"pagination-controls flex flex-col sm:flex-row justify-between items-center p-4 border-t border-gray-200 dark:border-gray-700",children:[r("div",{className:"pagination-info text-sm text-gray-600 dark:text-gray-400 mb-2 sm:mb-0",children:["Showing ",r("span",{id:"pagination-showing",children:[e.startItem,"-",e.endItem]})," of ",r("span",{id:"pagination-total",children:e.totalItems})," recordings"]}),r("div",{className:"pagination-buttons flex items-center space-x-1",children:[r("button",{id:"pagination-first",className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"First Page",onClick:()=>t(1),disabled:1===e.currentPage,children:"«"}),r("button",{id:"pagination-prev",className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous Page",onClick:()=>t(e.currentPage-1),disabled:1===e.currentPage,children:"‹"}),r("span",{id:"pagination-current",className:"px-2 text-sm text-gray-700 dark:text-gray-300",children:["Page ",e.currentPage," of ",e.totalPages]}),r("button",{id:"pagination-next",className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Next Page",onClick:()=>t(e.currentPage+1),disabled:e.currentPage===e.totalPages,children:"›"}),r("button",{id:"pagination-last",className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Last Page",onClick:()=>t(e.totalPages),disabled:e.currentPage===e.totalPages,children:"»"})]})]})}const B={hooks:{useStreams:()=>d("streams","/api/streams",{timeout:15e3,retries:2,retryDelay:1e3}),useRecordings:(e,t,r,a)=>{const n=new URLSearchParams;if(n.append("page",t.currentPage),n.append("limit",t.pageSize),n.append("sort",r),n.append("order",a),"custom"===e.dateRange)n.append("start",`${e.startDate}T${e.startTime}:00`),n.append("end",`${e.endDate}T${e.endTime}:00`);else{const{start:t,end:r}=B.getDateRangeFromPreset(e.dateRange);n.append("start",t),n.append("end",r)}return"all"!==e.streamId&&n.append("stream",e.streamId),"detection"===e.recordingType&&n.append("detection","1"),d(["recordings",e,t,r,a],`/api/recordings?${n.toString()}`,{timeout:3e4,retries:2,retryDelay:1e3})},useDeleteRecording:()=>{const e=a();return o({mutationFn:async e=>{const t=`/api/recordings/${e}`;return await i(t,{method:"DELETE",timeout:15e3,retries:1,retryDelay:1e3})},onSuccess:()=>{e.invalidateQueries({queryKey:["recordings"]}),p("Recording deleted successfully")},onError:e=>{console.error("Error deleting recording:",e),p("Error deleting recording: "+e.message)}})},useBatchDeleteRecordings:()=>{const e=a();return n("/api/recordings/batch-delete",{timeout:6e4,retries:1,retryDelay:2e3},{onSuccess:t=>{e.invalidateQueries({queryKey:["recordings"]});const r=t.succeeded,a=t.failed;p(r>0&&0===a?`Successfully deleted ${r} recording${1!==r?"s":""}`:r>0&&a>0?`Deleted ${r} recording${1!==r?"s":""}, but failed to delete ${a}`:`Failed to delete ${a} recording${1!==a?"s":""}`)},onError:e=>{console.error("Error in batch delete operation:",e),p("Error in batch delete operation: "+e.message)}})}},loadStreams:async()=>{try{return await i("/api/streams",{timeout:15e3,retries:2,retryDelay:1e3})||[]}catch(e){return console.error("Error loading streams for filter:",e),p("Error loading streams: "+e.message),[]}},getDateRangeFromPreset:e=>{const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59),a=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);let n,o;switch(e){case"today":n=a.toISOString(),o=r.toISOString();break;case"yesterday":const e=new Date(a);e.setDate(e.getDate()-1);const t=new Date(e);t.setHours(23,59,59),n=e.toISOString(),o=t.toISOString();break;case"last7days":const d=new Date(a);d.setDate(d.getDate()-7),n=d.toISOString(),o=r.toISOString();break;case"last30days":const i=new Date(a);i.setDate(i.getDate()-30),n=i.toISOString(),o=r.toISOString();break;default:const s=new Date(a);s.setDate(s.getDate()-7),n=s.toISOString(),o=r.toISOString()}return{start:n,end:o}},loadRecordings:async(e,t,r,a)=>{try{const n=new URLSearchParams;if(n.append("page",t.currentPage),n.append("limit",t.pageSize),n.append("sort",r),n.append("order",a),"custom"===e.dateRange)n.append("start",`${e.startDate}T${e.startTime}:00`),n.append("end",`${e.endDate}T${e.endTime}:00`);else{const{start:t,end:r}=B.getDateRangeFromPreset(e.dateRange);n.append("start",t),n.append("end",r)}"all"!==e.streamId&&n.append("stream",e.streamId),"detection"===e.recordingType&&n.append("detection","1"),console.log("API Request:",`/api/recordings?${n.toString()}`);const o=await i(`/api/recordings?${n.toString()}`,{timeout:3e4,retries:2,retryDelay:1e3});if(console.log("Recordings data received:",o),o.recordings&&o.recordings.length>0){const e=5;for(let t=0;t<o.recordings.length;t+=e){const r=o.recordings.slice(t,t+e);await Promise.all(r.map((async e=>{try{e.has_detections=await B.checkRecordingHasDetections(e)}catch(t){console.error(`Error checking detections for recording ${e.id}:`,t),e.has_detections=!1}})))}}return o}catch(n){throw console.error("Error loading recordings:",n),p("Error loading recordings: "+n.message),n}},deleteRecording:async e=>{try{return await s(`/api/recordings/${e.id}`,{method:"DELETE",timeout:15e3,retries:1,retryDelay:1e3}),p("Recording deleted successfully"),!0}catch(t){return console.error("Error deleting recording:",t),p("Error deleting recording: "+t.message),!1}},deleteSelectedRecordings:async e=>{const t=Object.entries(e).filter((([e,t])=>t)).map((([e,t])=>parseInt(e,10)));if(0===t.length)return p("No recordings selected"),{succeeded:0,failed:0};try{if(window.wsClient){if(console.log("Using WebSocket for batch delete operation"),window.wsClient.isConnected()||(console.log("WebSocket not connected, connecting now..."),window.wsClient.connect()),!window.batchDeleteClient){if("undefined"==typeof BatchDeleteRecordingsClient)return console.warn("BatchDeleteRecordingsClient not available, falling back to HTTP"),B.deleteSelectedRecordingsHttp(t);console.log("Creating new BatchDeleteRecordingsClient"),window.batchDeleteClient=new BatchDeleteRecordingsClient(window.wsClient)}return"function"==typeof showBatchDeleteModal&&showBatchDeleteModal(),await window.batchDeleteClient.deleteWithProgress({ids:t})}return console.log("WebSocket client not available, using HTTP for batch delete"),B.deleteSelectedRecordingsHttp(t)}catch(r){return console.error("Error in batch delete operation:",r),p("Error in batch delete operation: "+r.message),{succeeded:0,failed:0}}},deleteSelectedRecordingsHttp:async e=>{try{const t=await s("/api/recordings/batch-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:e}),timeout:6e4,retries:1,retryDelay:2e3}),r=await t.json(),a=r.succeeded,n=r.failed;return p(a>0&&0===n?`Successfully deleted ${a} recording${1!==a?"s":""}`:a>0&&n>0?`Deleted ${a} recording${1!==a?"s":""}, but failed to delete ${n}`:`Failed to delete ${n} recording${1!==n?"s":""}`),r}catch(t){return console.error("Error in HTTP batch delete operation:",t),p("Error in batch delete operation: "+t.message),{succeeded:0,failed:0}}},deleteAllFilteredRecordings:async e=>{try{const a={};if("custom"===e.dateRange)a.start=`${e.startDate}T${e.startTime}:00`,a.end=`${e.endDate}T${e.endTime}:00`;else{const{start:t,end:r}=B.getDateRangeFromPreset(e.dateRange);a.start=t,a.end=r}"all"!==e.streamId&&(a.stream_name=e.streamId),"detection"===e.recordingType&&(a.detection=1),console.log("Deleting with filter:",a),"function"==typeof showBatchDeleteModal&&(showBatchDeleteModal(),"function"==typeof window.updateBatchDeleteProgress&&window.updateBatchDeleteProgress({current:0,total:0,succeeded:0,failed:0,status:"Preparing to delete recordings matching filter...",complete:!1}));let n=0;try{const e=new URLSearchParams;a.start&&e.append("start",a.start),a.end&&e.append("end",a.end),a.stream_name&&e.append("stream",a.stream_name),a.detection&&e.append("detection","1"),e.append("page","1"),e.append("limit","1"),console.log("Getting total count with params:",e.toString());const t=await fetch(`/api/recordings?${e.toString()}`);if(t.ok){const e=await t.json();e&&e.pagination&&e.pagination.total&&(n=e.pagination.total,console.log(`Found ${n} recordings matching filter`),"function"==typeof window.updateBatchDeleteProgress&&window.updateBatchDeleteProgress({current:0,total:n,succeeded:0,failed:0,status:`Found ${n} recordings matching filter. Starting deletion...`,complete:!1}))}}catch(t){console.warn("Error getting recording count:",t)}const o=e=>(console.error("Error in delete all operation:",e),p("Error in delete all operation: "+e.message),"function"==typeof window.updateBatchDeleteProgress&&window.updateBatchDeleteProgress({current:0,total:0,succeeded:0,failed:0,status:`Error: ${e.message}`,complete:!0}),{succeeded:0,failed:0});if(!window.wsClient)return console.log("WebSocket client not available, using HTTP for batch delete with filter"),B.deleteAllFilteredRecordingsHttp(a);{if(console.log("Using WebSocket for batch delete with filter"),window.wsClient.isConnected()||(console.log("WebSocket not connected, connecting now..."),window.wsClient.connect()),!window.batchDeleteClient){if("undefined"==typeof BatchDeleteRecordingsClient)return console.warn("BatchDeleteRecordingsClient not available, falling back to HTTP"),B.deleteAllFilteredRecordingsHttp(a);console.log("Creating new BatchDeleteRecordingsClient for filtered delete"),window.batchDeleteClient=new BatchDeleteRecordingsClient(window.wsClient)}console.log("Using WebSocket client ID for filtered batch delete:",window.wsClient.getClientId());const e=new Promise(((e,t)=>{setTimeout((()=>{t(new Error("Operation timed out or server crashed. Some recordings may have been deleted."))}),6e4)}));try{return await Promise.race([window.batchDeleteClient.deleteWithProgress({filter:a,totalCount:n}),e])}catch(r){return console.error("WebSocket error or timeout:",r),setTimeout((()=>{"function"==typeof loadRecordings&&loadRecordings()}),1e3),o(r)}}}catch(a){return console.error("Error in delete all operation:",a),p("Error in delete all operation: "+a.message),{succeeded:0,failed:0}}},deleteAllFilteredRecordingsHttp:async e=>{try{const t=await s("/api/recordings/batch-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filter:e}),timeout:12e4,retries:1,retryDelay:3e3}),r=await t.json(),a=r.succeeded,n=r.failed;return p(a>0&&0===n?`Successfully deleted ${a} recording${1!==a?"s":""}`:a>0&&n>0?`Deleted ${a} recording${1!==a?"s":""}, but failed to delete ${n}`:`Failed to delete ${n} recording${1!==n?"s":""}`),r}catch(t){return console.error("Error in HTTP delete all operation:",t),p("Error in delete all operation: "+t.message),{succeeded:0,failed:0}}},checkRecordingHasDetections:async e=>{if(!(e&&e.id&&e.stream&&e.start_time&&e.end_time))return!1;try{const t=Math.floor(new Date(e.start_time).getTime()/1e3),r=Math.floor(new Date(e.end_time).getTime()/1e3),a=new URLSearchParams({start:t,end:r}),n=await i(`/api/detection/results/${e.stream}?${a.toString()}`,{timeout:1e4,retries:1,retryDelay:500});return n.detections&&n.detections.length>0}catch(t){return console.error("Error checking detections:",t),!1}},getRecordingDetections:async e=>{if(!(e&&e.id&&e.stream&&e.start_time&&e.end_time))return[];try{const t=Math.floor(new Date(e.start_time).getTime()/1e3),r=Math.floor(new Date(e.end_time).getTime()/1e3),a=new URLSearchParams({start:t,end:r});return(await i(`/api/detection/results/${e.stream}?${a.toString()}`,{timeout:15e3,retries:1,retryDelay:1e3})).detections||[]}catch(t){return console.error("Error getting detections:",t),[]}},playRecording:(e,t)=>{if(console.log("Play recording clicked:",e),!e.id)return console.error("Recording has no id property:",e),void p("Error: Recording has no id property");const r=`/api/recordings/play/${e.id}`,a=`${e.stream} - ${I(e.start_time)}`,n=`/api/recordings/download/${e.id}`;console.log("Video URL:",r),console.log("Title:",a),console.log("Download URL:",n),t(r,a,n),console.log("Video modal should be shown now")},downloadRecording:e=>{const t=`/api/recordings/download/${e.id}`,r=document.createElement("a");r.href=t,r.download=`${e.stream}_${new Date(e.start_time).toISOString().replace(/[:.]/g,"-")}.mp4`,document.body.appendChild(r),r.click(),document.body.removeChild(r),p("Download started")}},L=()=>{const e=new URLSearchParams(window.location.search);if(!(e.has("dateRange")||e.has("page")||e.has("sort")||e.has("detection")||e.has("stream")))return null;const t={filters:{dateRange:"last7days",startDate:"",startTime:"00:00",endDate:"",endTime:"23:59",streamId:"all",recordingType:"all"},page:1,limit:20,sort:"start_time",order:"desc"};return e.has("dateRange")&&(t.filters.dateRange=e.get("dateRange"),"custom"===t.filters.dateRange&&(e.has("startDate")&&(t.filters.startDate=e.get("startDate")),e.has("startTime")&&(t.filters.startTime=e.get("startTime")),e.has("endDate")&&(t.filters.endDate=e.get("endDate")),e.has("endTime")&&(t.filters.endTime=e.get("endTime")))),e.has("stream")&&(t.filters.streamId=e.get("stream")),e.has("detection")&&"1"===e.get("detection")&&(t.filters.recordingType="detection"),e.has("page")&&(t.page=parseInt(e.get("page"),10)),e.has("limit")&&(t.limit=parseInt(e.get("limit"),10)),e.has("sort")&&(t.sort=e.get("sort")),e.has("order")&&(t.order=e.get("order")),t},F=e=>{const t=[];if("last7days"!==e.dateRange||"all"!==e.streamId||"all"!==e.recordingType){if("last7days"!==e.dateRange){let r="";switch(e.dateRange){case"today":r="Today";break;case"yesterday":r="Yesterday";break;case"last30days":r="Last 30 Days";break;case"custom":r=`${e.startDate} to ${e.endDate}`}t.push({key:"dateRange",label:`Date: ${r}`})}"all"!==e.streamId&&t.push({key:"streamId",label:`Stream: ${e.streamId}`}),"all"!==e.recordingType&&t.push({key:"recordingType",label:"Detection Events Only"})}return t},M=(e,t,r,a)=>{const n=new URLSearchParams(window.location.search);n.set("t",Date.now().toString()),n.set("dateRange",e.dateRange),"custom"===e.dateRange?(n.set("startDate",e.startDate),n.set("startTime",e.startTime),n.set("endDate",e.endDate),n.set("endTime",e.endTime)):(n.delete("startDate"),n.delete("startTime"),n.delete("endDate"),n.delete("endTime")),"all"!==e.streamId?n.set("stream",e.streamId):n.delete("stream"),"detection"===e.recordingType?n.set("detection","1"):n.delete("detection"),n.set("page",t.currentPage.toString()),n.set("limit",t.pageSize.toString()),n.set("sort",r),n.set("order",a);const o=`${window.location.pathname}?${n.toString()}`;window.history.pushState({path:o},"",o);const d=o;window.onbeforeunload=function(){window.history.replaceState({path:d},"",d)}};function z(){const[e,t]=l([]),[n,o]=l([]),[d,i]=l(!0),[s,m]=l("start_time"),[h,u]=l("desc"),[w,f]=l({dateRange:"last7days",startDate:"",startTime:"00:00",endDate:"",endTime:"23:59",streamId:"all",recordingType:"all"}),[D,S]=l({currentPage:1,pageSize:20,totalItems:0,totalPages:1,startItem:0,endItem:0}),[R,C]=l(!1),[I,N]=l([]),[z,O]=l({}),[_,H]=l(!1),[j,A]=l(!1),[W,U]=l("selected"),V=c(null);a();const{data:q,isLoading:Y,error:J}=B.hooks.useStreams();g((()=>{q&&Array.isArray(q)&&o(q)}),[q]),g((()=>{J&&(console.error("Error loading streams for filter:",J),p("Error loading streams: "+J.message))}),[J]),g((()=>{if(void 0!==v){if(window.wsClient=new v,console.log("WebSocket client initialized at application level"),window.wsClient){console.log("Initial WebSocket connection state:",{connected:window.wsClient.isConnected(),clientId:window.wsClient.getClientId()});const e=window.wsClient.connect;window.wsClient.connect=function(){const t=e.apply(this,arguments);if(this.socket){const e=this.socket.onopen;this.socket.onopen=t=>{console.log("WebSocket connection opened at application level"),e&&e.call(this,t)};const t=this.socket.onerror;this.socket.onerror=e=>{console.error("WebSocket error at application level:",e),t&&t.call(this,e)};const r=this.socket.onclose;this.socket.onclose=e=>{console.log(`WebSocket connection closed at application level: ${e.code} ${e.reason}`),r&&r.call(this,e)};const a=this.socket.onmessage;this.socket.onmessage=e=>{e.data.includes('"type":"welcome"')||console.log("WebSocket message received at application level"),a&&a.call(this,e)}}return t};const t=window.wsClient.handleMessage;window.wsClient.handleMessage=function(e){const r=this.clientId;t.call(this,e);const a=this.clientId;r!==a&&a&&console.log(`WebSocket client ID changed at application level: ${a}`)}}void 0!==k&&(window.batchDeleteClient=new k(window.wsClient),console.log("Batch delete client initialized"))}Q();const e=L();if(e){console.log("Found URL filters:",e);const t=new URLSearchParams(window.location.search);t.has("detection")&&"1"===t.get("detection")&&(e.filters.recordingType="detection"),f(e.filters),S((t=>({...t,currentPage:e.page||1,pageSize:e.limit||20}))),m(e.sort||"start_time"),u(e.order||"desc")}return ee(),window.addEventListener("resize",ee),()=>{window.removeEventListener("resize",ee)}}),[]),g((()=>{ne()}),[w]);const Q=()=>{const e=new Date,t=new Date(e);t.setDate(e.getDate()-7),f((r=>({...r,endDate:e.toISOString().split("T")[0],startDate:t.toISOString().split("T")[0]})))},{data:K,isLoading:G,error:X,refetch:Z}=B.hooks.useRecordings(w,D,s,h);g((()=>{if(K){const e=K.recordings||[];"detection"===w.recordingType&&e.forEach((e=>{e.has_detections=!0})),t(e),re(e.length>0),K.pagination&&ae(K,D.currentPage)}}),[K,w.recordingType]),g((()=>{X&&(console.error("Error loading recordings:",X),p("Error loading recordings: "+X.message),re(!1))}),[X]);const ee=()=>{window.innerWidth<768?i(!1):i(!0)},[te,re]=l(!1),ae=(e,t)=>{if(t=t||D.currentPage,e.pagination){const r=e.pagination.limit||20,a=e.pagination.total||0,n=e.pagination.pages||1;let o=0,d=0;e.recordings.length>0&&(o=(t-1)*r+1,d=Math.min(o+e.recordings.length-1,a)),console.log("Pagination update:",{currentPage:t,pageSize:r,totalItems:a,totalPages:n,startItem:o,endItem:d,recordingsLength:e.recordings.length}),S((e=>({...e,totalItems:a,totalPages:n,pageSize:r,startItem:o,endItem:d})))}else{const r=D.pageSize,a=e.total||0,n=Math.ceil(a/r)||1;let o=0,d=0;e.recordings.length>0&&(o=(t-1)*r+1,d=Math.min(o+e.recordings.length-1,a)),console.log("Pagination update (fallback):",{currentPage:t,pageSize:r,totalItems:a,totalPages:n,startItem:o,endItem:d,recordingsLength:e.recordings.length}),S((e=>({...e,totalItems:a,totalPages:n,startItem:o,endItem:d})))}},ne=()=>{const e=F(w);C(e.length>0),N(e)},oe=(e=!0)=>{e&&S((e=>({...e,currentPage:1}))),M(w,e?{...D,currentPage:1}:D,s,h)},de=()=>Object.values(z).filter(Boolean).length,ie=()=>{A(!1)},se=(e,r,a)=>{m(e),u(r),S((e=>({...e,currentPage:a}))),setTimeout((()=>{const n={...D,currentPage:a};M(w,n,e,r),B.loadRecordings(w,n,e,r).then((e=>{console.log("Recordings data received:",e),t(e.recordings||[]),ae(e,a)})).catch((e=>{console.error("Error loading recordings:",e),p("Error loading recordings: "+e.message)}))}),0)},{mutate:le}=B.hooks.useDeleteRecording();return r("section",{id:"recordings-page",class:"page",children:[r("div",{class:"page-header flex justify-between items-center mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow",children:[r("div",{class:"flex items-center",children:[r("h2",{class:"text-xl font-bold",children:"Recordings"}),r("div",{class:"ml-4 flex",children:[r("a",{href:"recordings.html",class:"px-3 py-1 bg-blue-500 text-white rounded-l-md",children:"Table View"}),r("a",{href:"timeline.html",class:"px-3 py-1 bg-gray-300 text-gray-700 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-400 dark:hover:bg-gray-600 rounded-r-md",children:"Timeline View"})]})]}),r("button",{id:"toggle-filters-btn",class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 focus:outline-none",title:"Toggle Filters",onClick:()=>{i(!d)},children:r("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:r("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})})})]}),r("div",{class:"recordings-layout flex flex-col md:flex-row gap-4 w-full",children:[r(T,{filters:w,setFilters:f,pagination:D,setPagination:S,streams:n,filtersVisible:d,applyFilters:oe,resetFilters:()=>{const e={dateRange:"last7days",startDate:"",startTime:"00:00",endDate:"",endTime:"23:59",streamId:"all",recordingType:"all"},t=new Date,r=new Date(t);r.setDate(t.getDate()-7),e.endDate=t.toISOString().split("T")[0],e.startDate=r.toISOString().split("T")[0],f(e),S((e=>({...e,currentPage:1}))),m("start_time"),u("desc");const a=window.location.pathname;window.history.pushState({path:a},"",a)},handleDateRangeChange:e=>{const t=e.target.value;if(f((e=>({...e,dateRange:t}))),!("custom"!==t||w.startDate&&w.endDate)){const e=new Date,t=new Date(e);t.setDate(e.getDate()-7),f((r=>({...r,endDate:e.toISOString().split("T")[0],startDate:t.toISOString().split("T")[0]})))}},setDefaultDateRange:Q}),r("div",{class:"recordings-content flex-1",children:[r(P,{activeFiltersDisplay:I,removeFilter:e=>{switch(e){case"dateRange":f((e=>({...e,dateRange:"last7days"})));break;case"streamId":f((e=>({...e,streamId:"all"})));break;case"recordingType":f((e=>({...e,recordingType:"all"})))}oe()},hasActiveFilters:R}),r(x,{isLoading:G,hasData:te,loadingMessage:"Loading recordings...",emptyMessage:"No recordings found matching your criteria",children:[r(E,{recordings:e,sortField:s,sortDirection:h,sortBy:e=>{s===e?u("asc"===h?"desc":"asc"):(u("start_time"===e?"desc":"asc"),m(e)),S((e=>({...e,currentPage:1}))),M(w,{...D,currentPage:1},e,e===s?"asc"===h?"desc":"asc":"start_time"===e?"desc":"asc")},selectedRecordings:z,toggleRecordingSelection:e=>{O((t=>({...t,[e]:!t[e]})))},selectAll:_,toggleSelectAll:()=>{const t=!_;H(t);const r={};t&&e.forEach((e=>{r[e.id]=!0})),O(r)},getSelectedCount:de,openDeleteModal:e=>{U(e),A(!0)},playRecording:e=>{B.playRecording(e,y)},downloadRecording:e=>{B.downloadRecording(e)},deleteRecording:e=>{confirm(`Are you sure you want to delete this recording from ${e.stream}?`)&&le(e.id)},recordingsTableBodyRef:V,pagination:D}),r($,{pagination:D,goToPage:e=>{e<1||e>D.totalPages||(S((t=>({...t,currentPage:e}))),M(w,{...D,currentPage:e},s,h))}})]})]})]}),r(b,{isOpen:j,onClose:ie,onConfirm:async()=>{ie();const e=new URLSearchParams(window.location.search),t=e.get("sort")||s,r=e.get("order")||h,a=parseInt(e.get("page"),10)||D.currentPage;if("selected"===W){const e=await B.deleteSelectedRecordings(z);O({}),H(!1),e.succeeded>0&&se(t,r,a)}else{const e=await B.deleteAllFilteredRecordings(w);O({}),H(!1),e.succeeded>0&&((e=D.currentPage,t=!0)=>{console.log("Loading recordings with filters:",JSON.stringify(w));const r={...D,currentPage:e};S(r),t&&M(w,r,s,h)})()}},mode:W,count:de()})]})}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("main-content");e&&m(r(u,{client:h,children:[r(w,{}),r(z,{}),r(f,{})]}),e)}))}}}));
//# sourceMappingURL=recordings-legacy-BDegoxcC.js.map
