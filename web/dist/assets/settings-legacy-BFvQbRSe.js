System.register(["./query-client-legacy-CQtkeh2X.js","./Footer-legacy-x_P_Y9af.js","./LoadingIndicator-legacy-CYuV7fuN.js"],(function(e,t){"use strict";var r,a,s,d,n,i,o,l,g,c,b,h,u;return{setters:[e=>{r=e.d,a=e.b,s=e.u,d=e.g,n=e.y,i=e.c,o=e.E,l=e.e,g=e.Q},e=>{c=e.c,b=e.H,h=e.F},e=>{u=e.C}],execute:function(){function e(){const[e,t]=r({logLevel:"2",storagePath:"/var/lib/lightnvr/recordings",storagePathHls:"",maxStorage:"0",retention:"30",autoDelete:!0,dbPath:"/var/lib/lightnvr/lightnvr.db",webPort:"8080",authEnabled:!0,username:"admin",password:"admin",webrtcDisabled:!1,bufferSize:"1024",useSwap:!0,swapSize:"128",detectionModelsPath:"",defaultDetectionThreshold:50,defaultPreBuffer:5,defaultPostBuffer:10}),{data:o,isLoading:l,error:g,refetch:b}=a(["settings"],"/api/settings",{timeout:15e3,retries:2,retryDelay:1e3}),h=s({mutationKey:["saveSettings"],mutationFn:async e=>await d("/api/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),timeout:2e4,retries:1,retryDelay:2e3}),onSuccess:()=>{c("Settings saved successfully"),b()},onError:e=>{console.error("Error saving settings:",e),c(`Error saving settings: ${e.message}`)}});n((()=>{if(o){console.log("Settings loaded:",o);const e={logLevel:o.log_level?.toString()||"",storagePath:o.storage_path||"",storagePathHls:o.storage_path_hls||"",maxStorage:o.max_storage_size?.toString()||"",retention:o.retention_days?.toString()||"",autoDelete:o.auto_delete_oldest||!1,dbPath:o.db_path||"",webPort:o.web_port?.toString()||"",authEnabled:o.web_auth_enabled||!1,username:o.web_username||"",password:o.web_password||"",webrtcDisabled:o.webrtc_disabled||!1,bufferSize:o.buffer_size?.toString()||"",useSwap:o.use_swap||!1,swapSize:o.swap_size?.toString()||"",detectionModelsPath:o.models_path||"",defaultDetectionThreshold:o.default_detection_threshold||50,defaultPreBuffer:o.pre_detection_buffer?.toString()||"5",defaultPostBuffer:o.post_detection_buffer?.toString()||"10"};t((t=>({...t,...e})))}}),[o]);const m=e=>{const{name:r,value:a,type:s,checked:d}=e.target;t((e=>({...e,[r]:"checkbox"===s?d:a})))};return i("section",{id:"settings-page",class:"page",children:[i("div",{class:"page-header flex justify-between items-center mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow",children:[i("h2",{class:"text-xl font-bold",children:"Settings"}),i("div",{class:"controls",children:i("button",{id:"save-settings-btn",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",onClick:()=>{const t={log_level:parseInt(e.logLevel,10),storage_path:e.storagePath,storage_path_hls:e.storagePathHls,max_storage_size:parseInt(e.maxStorage,10),retention_days:parseInt(e.retention,10),auto_delete_oldest:e.autoDelete,db_path:e.dbPath,web_port:parseInt(e.webPort,10),web_auth_enabled:e.authEnabled,web_username:e.username,web_password:e.password,webrtc_disabled:e.webrtcDisabled,buffer_size:parseInt(e.bufferSize,10),use_swap:e.useSwap,swap_size:parseInt(e.swapSize,10),models_path:e.detectionModelsPath,default_detection_threshold:e.defaultDetectionThreshold,pre_detection_buffer:parseInt(e.defaultPreBuffer,10),post_detection_buffer:parseInt(e.defaultPostBuffer,10)};h.mutate(t)},children:"Save Settings"})})]}),i(u,{isLoading:l,hasData:!!o,loadingMessage:"Loading settings...",emptyMessage:"No settings available. Please try again later.",children:i("div",{class:"settings-container space-y-6",children:[i("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[i("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"General Settings"}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-log-level",class:"font-medium",children:"Log Level"}),i("select",{id:"setting-log-level",name:"logLevel",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.logLevel,onChange:m,children:[i("option",{value:"0",children:"Error"}),i("option",{value:"1",children:"Warning"}),i("option",{value:"2",children:"Info"}),i("option",{value:"3",children:"Debug"})]})]})]}),i("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[i("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Storage Settings"}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-storage-path",class:"font-medium",children:"Storage Path"}),i("input",{type:"text",id:"setting-storage-path",name:"storagePath",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.storagePath,onChange:m})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-storage-path-hls",class:"font-medium",children:"HLS Storage Path"}),i("div",{class:"col-span-2",children:[i("input",{type:"text",id:"setting-storage-path-hls",name:"storagePathHls",class:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.storagePathHls,onChange:m}),i("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Optional path for HLS segments. If not specified, Storage Path will be used."})]})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-max-storage",class:"font-medium",children:"Maximum Storage Size (GB)"}),i("div",{class:"col-span-2 flex items-center",children:[i("input",{type:"number",id:"setting-max-storage",name:"maxStorage",min:"0",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.maxStorage,onChange:m}),i("span",{class:"hint ml-2 text-sm text-gray-500 dark:text-gray-400",children:"0 = unlimited"})]})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-retention",class:"font-medium",children:"Retention Period (days)"}),i("input",{type:"number",id:"setting-retention",name:"retention",min:"1",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.retention,onChange:m})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-auto-delete",class:"font-medium",children:"Auto Delete Oldest"}),i("div",{class:"col-span-2",children:i("input",{type:"checkbox",id:"setting-auto-delete",name:"autoDelete",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:e.autoDelete,onChange:m})})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-db-path",class:"font-medium",children:"Database Path"}),i("input",{type:"text",id:"setting-db-path",name:"dbPath",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.dbPath,onChange:m})]})]}),i("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[i("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Web Interface Settings"}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-web-port",class:"font-medium",children:"Web Port"}),i("input",{type:"number",id:"setting-web-port",name:"webPort",min:"1",max:"65535",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.webPort,onChange:m})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-auth-enabled",class:"font-medium",children:"Enable Authentication"}),i("div",{class:"col-span-2",children:i("input",{type:"checkbox",id:"setting-auth-enabled",name:"authEnabled",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:e.authEnabled,onChange:m})})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-username",class:"font-medium",children:"Username"}),i("input",{type:"text",id:"setting-username",name:"username",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.username,onChange:m})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-password",class:"font-medium",children:"Password"}),i("input",{type:"password",id:"setting-password",name:"password",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.password,onChange:m})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-webrtc-disabled",class:"font-medium",children:"Disable WebRTC (Use HLS Only)"}),i("div",{class:"col-span-2",children:[i("input",{type:"checkbox",id:"setting-webrtc-disabled",name:"webrtcDisabled",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:e.webrtcDisabled,onChange:m}),i("span",{class:"hint ml-2 text-sm text-gray-500 dark:text-gray-400",children:"When enabled, all streams will use HLS instead of WebRTC"})]})]})]}),i("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[i("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Memory Optimization"}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-buffer-size",class:"font-medium",children:"Buffer Size (KB)"}),i("input",{type:"number",id:"setting-buffer-size",name:"bufferSize",min:"128",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.bufferSize,onChange:m})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-use-swap",class:"font-medium",children:"Use Swap File"}),i("div",{class:"col-span-2",children:i("input",{type:"checkbox",id:"setting-use-swap",name:"useSwap",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:e.useSwap,onChange:m})})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-swap-size",class:"font-medium",children:"Swap Size (MB)"}),i("input",{type:"number",id:"setting-swap-size",name:"swapSize",min:"32",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.swapSize,onChange:m})]})]}),i("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[i("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Detection-Based Recording"}),i("div",{class:"setting mb-4",children:[i("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:"Configure detection-based recording for streams. When enabled, recordings will only be saved when objects are detected."}),i("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:[i("strong",{children:"Motion Detection:"}),' Built-in motion detection is available without requiring any external models. Select "motion" as the detection model in stream settings to use this feature.']}),i("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:[i("strong",{children:"Optimized Motion Detection:"}),' Memory and CPU optimized motion detection for embedded devices. Select "motion" as the detection model in stream settings to use this feature.']})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-detection-models-path",class:"font-medium",children:"Detection Models Path"}),i("div",{class:"col-span-2",children:[i("input",{type:"text",id:"setting-detection-models-path",name:"detectionModelsPath",placeholder:"/var/lib/lightnvr/models",class:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.detectionModelsPath,onChange:m}),i("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Directory where detection models are stored"})]})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-default-detection-threshold",class:"font-medium",children:"Default Detection Threshold"}),i("div",{class:"col-span-2",children:[i("div",{class:"flex items-center",children:[i("input",{type:"range",id:"setting-default-detection-threshold",name:"defaultDetectionThreshold",min:"0",max:"100",step:"1",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700",value:e.defaultDetectionThreshold,onChange:e=>{const r=parseInt(e.target.value,10);t((e=>({...e,defaultDetectionThreshold:r})))}}),i("span",{id:"threshold-value",class:"ml-2 min-w-[3rem] text-center",children:[e.defaultDetectionThreshold,"%"]})]}),i("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Confidence threshold for detection (0-100%)"})]})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-default-pre-buffer",class:"font-medium",children:"Default Pre-detection Buffer (seconds)"}),i("div",{class:"col-span-2",children:[i("input",{type:"number",id:"setting-default-pre-buffer",name:"defaultPreBuffer",min:"0",max:"60",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.defaultPreBuffer,onChange:m}),i("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Seconds of video to keep before detection"})]})]}),i("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[i("label",{for:"setting-default-post-buffer",class:"font-medium",children:"Default Post-detection Buffer (seconds)"}),i("div",{class:"col-span-2",children:[i("input",{type:"number",id:"setting-default-post-buffer",name:"defaultPostBuffer",min:"0",max:"300",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.defaultPostBuffer,onChange:m}),i("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Seconds of video to keep after detection"})]})]})]})]})})]})}document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("main-content");t&&o(i(g,{client:l,children:[i(b,{}),i(e,{}),i(h,{})]}),t)}))}}}));
//# sourceMappingURL=settings-legacy-BFvQbRSe.js.map
