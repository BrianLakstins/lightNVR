System.register(["./query-client-legacy-9D2AVzO6.js","./LoadingIndicator-legacy-DG1lqe4I.js","./Footer-legacy-B7LBuu5T.js"],(function(e,t){"use strict";var r,a,s,d,n,i,o,l,g,c,b,h,u,m;return{setters:[e=>{r=e.d,a=e.b,s=e.h,d=e.s,n=e.i,i=e.y,o=e.u,l=e.E,g=e.c,c=e.e,b=e.Q},e=>{h=e.C},e=>{u=e.H,m=e.F}],execute:function(){function e(){const[e,t]=r({logLevel:"2",storagePath:"/var/lib/lightnvr/recordings",storagePathHls:"",maxStorage:"0",retention:"30",autoDelete:!0,dbPath:"/var/lib/lightnvr/lightnvr.db",webPort:"8080",authEnabled:!0,username:"admin",password:"admin",webrtcDisabled:!1,bufferSize:"1024",useSwap:!0,swapSize:"128",detectionModelsPath:"",defaultDetectionThreshold:50,defaultPreBuffer:5,defaultPostBuffer:10}),{data:l,isLoading:g,error:c,refetch:b}=a(["settings"],"/api/settings",{timeout:15e3,retries:2,retryDelay:1e3}),u=s({mutationKey:["saveSettings"],mutationFn:async e=>await n("/api/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),timeout:2e4,retries:1,retryDelay:2e3}),onSuccess:()=>{d("Settings saved successfully"),b()},onError:e=>{console.error("Error saving settings:",e),d(`Error saving settings: ${e.message}`)}});i((()=>{if(l){console.log("Settings loaded:",l);const e={logLevel:l.log_level?.toString()||"",storagePath:l.storage_path||"",storagePathHls:l.storage_path_hls||"",maxStorage:l.max_storage_size?.toString()||"",retention:l.retention_days?.toString()||"",autoDelete:l.auto_delete_oldest||!1,dbPath:l.db_path||"",webPort:l.web_port?.toString()||"",authEnabled:l.web_auth_enabled||!1,username:l.web_username||"",password:l.web_password||"",webrtcDisabled:l.webrtc_disabled||!1,bufferSize:l.buffer_size?.toString()||"",useSwap:l.use_swap||!1,swapSize:l.swap_size?.toString()||"",detectionModelsPath:l.models_path||"",defaultDetectionThreshold:l.default_detection_threshold||50,defaultPreBuffer:l.pre_detection_buffer?.toString()||"5",defaultPostBuffer:l.post_detection_buffer?.toString()||"10"};t((t=>({...t,...e})))}}),[l]);const m=e=>{const{name:r,value:a,type:s,checked:d}=e.target;t((e=>({...e,[r]:"checkbox"===s?d:a})))};return o("section",{id:"settings-page",class:"page",children:[o("div",{class:"page-header flex justify-between items-center mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow",children:[o("h2",{class:"text-xl font-bold",children:"Settings"}),o("div",{class:"controls",children:o("button",{id:"save-settings-btn",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",onClick:()=>{const t={log_level:parseInt(e.logLevel,10),storage_path:e.storagePath,storage_path_hls:e.storagePathHls,max_storage_size:parseInt(e.maxStorage,10),retention_days:parseInt(e.retention,10),auto_delete_oldest:e.autoDelete,db_path:e.dbPath,web_port:parseInt(e.webPort,10),web_auth_enabled:e.authEnabled,web_username:e.username,web_password:e.password,webrtc_disabled:e.webrtcDisabled,buffer_size:parseInt(e.bufferSize,10),use_swap:e.useSwap,swap_size:parseInt(e.swapSize,10),models_path:e.detectionModelsPath,default_detection_threshold:e.defaultDetectionThreshold,pre_detection_buffer:parseInt(e.defaultPreBuffer,10),post_detection_buffer:parseInt(e.defaultPostBuffer,10)};u.mutate(t)},children:"Save Settings"})})]}),o(h,{isLoading:g,hasData:!!l,loadingMessage:"Loading settings...",emptyMessage:"No settings available. Please try again later.",children:o("div",{class:"settings-container space-y-6",children:[o("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[o("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"General Settings"}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-log-level",class:"font-medium",children:"Log Level"}),o("select",{id:"setting-log-level",name:"logLevel",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.logLevel,onChange:m,children:[o("option",{value:"0",children:"Error"}),o("option",{value:"1",children:"Warning"}),o("option",{value:"2",children:"Info"}),o("option",{value:"3",children:"Debug"})]})]})]}),o("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[o("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Storage Settings"}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-storage-path",class:"font-medium",children:"Storage Path"}),o("input",{type:"text",id:"setting-storage-path",name:"storagePath",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.storagePath,onChange:m})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-storage-path-hls",class:"font-medium",children:"HLS Storage Path"}),o("div",{class:"col-span-2",children:[o("input",{type:"text",id:"setting-storage-path-hls",name:"storagePathHls",class:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.storagePathHls,onChange:m}),o("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Optional path for HLS segments. If not specified, Storage Path will be used."})]})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-max-storage",class:"font-medium",children:"Maximum Storage Size (GB)"}),o("div",{class:"col-span-2 flex items-center",children:[o("input",{type:"number",id:"setting-max-storage",name:"maxStorage",min:"0",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.maxStorage,onChange:m}),o("span",{class:"hint ml-2 text-sm text-gray-500 dark:text-gray-400",children:"0 = unlimited"})]})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-retention",class:"font-medium",children:"Retention Period (days)"}),o("input",{type:"number",id:"setting-retention",name:"retention",min:"1",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.retention,onChange:m})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-auto-delete",class:"font-medium",children:"Auto Delete Oldest"}),o("div",{class:"col-span-2",children:o("input",{type:"checkbox",id:"setting-auto-delete",name:"autoDelete",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:e.autoDelete,onChange:m})})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-db-path",class:"font-medium",children:"Database Path"}),o("input",{type:"text",id:"setting-db-path",name:"dbPath",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.dbPath,onChange:m})]})]}),o("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[o("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Web Interface Settings"}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-web-port",class:"font-medium",children:"Web Port"}),o("input",{type:"number",id:"setting-web-port",name:"webPort",min:"1",max:"65535",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.webPort,onChange:m})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-auth-enabled",class:"font-medium",children:"Enable Authentication"}),o("div",{class:"col-span-2",children:o("input",{type:"checkbox",id:"setting-auth-enabled",name:"authEnabled",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:e.authEnabled,onChange:m})})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-username",class:"font-medium",children:"Username"}),o("input",{type:"text",id:"setting-username",name:"username",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.username,onChange:m})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-password",class:"font-medium",children:"Password"}),o("input",{type:"password",id:"setting-password",name:"password",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.password,onChange:m})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-webrtc-disabled",class:"font-medium",children:"Disable WebRTC (Use HLS Only)"}),o("div",{class:"col-span-2",children:[o("input",{type:"checkbox",id:"setting-webrtc-disabled",name:"webrtcDisabled",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:e.webrtcDisabled,onChange:m}),o("span",{class:"hint ml-2 text-sm text-gray-500 dark:text-gray-400",children:"When enabled, all streams will use HLS instead of WebRTC"})]})]})]}),o("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[o("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Memory Optimization"}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-buffer-size",class:"font-medium",children:"Buffer Size (KB)"}),o("input",{type:"number",id:"setting-buffer-size",name:"bufferSize",min:"128",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.bufferSize,onChange:m})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-use-swap",class:"font-medium",children:"Use Swap File"}),o("div",{class:"col-span-2",children:o("input",{type:"checkbox",id:"setting-use-swap",name:"useSwap",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600",checked:e.useSwap,onChange:m})})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-swap-size",class:"font-medium",children:"Swap Size (MB)"}),o("input",{type:"number",id:"setting-swap-size",name:"swapSize",min:"32",class:"col-span-2 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.swapSize,onChange:m})]})]}),o("div",{class:"settings-group bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[o("h3",{class:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Detection-Based Recording"}),o("div",{class:"setting mb-4",children:[o("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:"Configure detection-based recording for streams. When enabled, recordings will only be saved when objects are detected."}),o("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:[o("strong",{children:"Motion Detection:"}),' Built-in motion detection is available without requiring any external models. Select "motion" as the detection model in stream settings to use this feature.']}),o("p",{class:"setting-description mb-2 text-gray-700 dark:text-gray-300",children:[o("strong",{children:"Optimized Motion Detection:"}),' Memory and CPU optimized motion detection for embedded devices. Select "motion" as the detection model in stream settings to use this feature.']})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-detection-models-path",class:"font-medium",children:"Detection Models Path"}),o("div",{class:"col-span-2",children:[o("input",{type:"text",id:"setting-detection-models-path",name:"detectionModelsPath",placeholder:"/var/lib/lightnvr/models",class:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.detectionModelsPath,onChange:m}),o("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Directory where detection models are stored"})]})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-default-detection-threshold",class:"font-medium",children:"Default Detection Threshold"}),o("div",{class:"col-span-2",children:[o("div",{class:"flex items-center",children:[o("input",{type:"range",id:"setting-default-detection-threshold",name:"defaultDetectionThreshold",min:"0",max:"100",step:"1",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700",value:e.defaultDetectionThreshold,onChange:e=>{const r=parseInt(e.target.value,10);t((e=>({...e,defaultDetectionThreshold:r})))}}),o("span",{id:"threshold-value",class:"ml-2 min-w-[3rem] text-center",children:[e.defaultDetectionThreshold,"%"]})]}),o("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Confidence threshold for detection (0-100%)"})]})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-default-pre-buffer",class:"font-medium",children:"Default Pre-detection Buffer (seconds)"}),o("div",{class:"col-span-2",children:[o("input",{type:"number",id:"setting-default-pre-buffer",name:"defaultPreBuffer",min:"0",max:"60",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.defaultPreBuffer,onChange:m}),o("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Seconds of video to keep before detection"})]})]}),o("div",{class:"setting grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-4",children:[o("label",{for:"setting-default-post-buffer",class:"font-medium",children:"Default Post-detection Buffer (seconds)"}),o("div",{class:"col-span-2",children:[o("input",{type:"number",id:"setting-default-post-buffer",name:"defaultPostBuffer",min:"0",max:"300",class:"p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.defaultPostBuffer,onChange:m}),o("span",{class:"hint text-sm text-gray-500 dark:text-gray-400",children:"Seconds of video to keep after detection"})]})]})]})]})})]})}document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("main-content");t&&l(o(b,{client:g,children:[o(u,{}),o(c,{}),o(e,{}),o(m,{})]}),t)}))}}}));
//# sourceMappingURL=settings-legacy-CzvAHr04.js.map
