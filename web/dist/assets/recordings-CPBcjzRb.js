import{c as a,a as j,f as Ce,u as Te,b as ae,g as E,h as W,d as D,A as Pe,y as I,E as Ie,e as Ne,Q as Ee}from"./query-client-CTeJEwHK.js";import{c as h,D as Be,e as $e,H as Fe,F as Le}from"./Footer-Cdt15UQl.js";import{C as Me}from"./LoadingIndicator-vSMLbK2c.js";import{W as re,B as ne}from"./websocket-client-DzZLM-9M.js";function Ke(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function V(e,t=3e3){let n=document.getElementById("status-message-container");n||(n=document.createElement("div"),n.id="status-message-container",n.className="fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50 flex flex-col items-center",document.body.appendChild(n));const o=document.createElement("div");o.className="bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg mb-2 transition-all duration-300 opacity-0 transform translate-y-2",o.textContent=e,n.appendChild(o),setTimeout(()=>{o.classList.remove("opacity-0","translate-y-2")},10),setTimeout(()=>{o.classList.add("opacity-0","translate-y-2"),setTimeout(()=>{o.parentNode===n&&n.removeChild(o),n.children.length===0&&document.body.removeChild(n)},300)},t)}function z(){let e=document.getElementById("batch-delete-modal-container");e||(e=document.createElement("div"),e.id="batch-delete-modal-container",document.body.appendChild(e)),e.innerHTML='\n        <div id="batch-delete-modal" class="modal hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50">\n            <div class="modal-content relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md mx-auto p-6 w-full">\n                <div class="modal-header flex justify-between items-center mb-4 pb-2 border-b border-gray-200 dark:border-gray-700">\n                    <h3 id="batch-delete-modal-title" class="text-xl font-bold text-gray-900 dark:text-white">Batch Delete Progress</h3>\n                    <button id="batch-delete-close-btn" class="close text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-2xl font-bold">&times;</button>\n                </div>\n                <div class="modal-body">\n                    <div id="batch-delete-status" class="mb-4 text-gray-700 dark:text-gray-300">\n                        Preparing to delete recordings...\n                    </div>\n                    <div class="progress-container bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-4">\n                        <div id="batch-delete-progress-bar" class="bg-green-500 h-4 rounded-full text-center text-xs text-white" style="width: 0%"></div>\n                    </div>\n                    <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-6">\n                        <div id="batch-delete-count">0 / 0</div>\n                        <div id="batch-delete-percentage">0%</div>\n                    </div>\n                    <div id="batch-delete-details" class="mb-4">\n                        <div class="flex justify-between mb-2">\n                            <span class="text-gray-700 dark:text-gray-300">Succeeded:</span>\n                            <span id="batch-delete-succeeded" class="font-bold text-green-600 dark:text-green-400">0</span>\n                        </div>\n                        <div class="flex justify-between">\n                            <span class="text-gray-700 dark:text-gray-300">Failed:</span>\n                            <span id="batch-delete-failed" class="font-bold text-red-600 dark:text-red-400">0</span>\n                        </div>\n                    </div>\n                    <div id="batch-delete-message" class="text-sm italic text-gray-600 dark:text-gray-400 mb-4"></div>\n                </div>\n                <div class="modal-footer flex justify-end pt-2 border-t border-gray-200 dark:border-gray-700">\n                    <button id="batch-delete-done-btn" class="btn btn-primary hidden">Done</button>\n                    <button id="batch-delete-cancel-btn" class="btn btn-secondary">Cancel</button>\n                </div>\n            </div>\n        </div>\n    ';const t=document.getElementById("batch-delete-modal"),n=document.getElementById("batch-delete-close-btn"),o=document.getElementById("batch-delete-done-btn"),r=document.getElementById("batch-delete-cancel-btn");n&&n.addEventListener("click",M),o&&o.addEventListener("click",M),r&&r.addEventListener("click",Oe),window.addEventListener("click",d=>{d.target===t&&M()})}function O(){const e=document.getElementById("batch-delete-modal");e||z(),ze(),e.classList.remove("hidden")}function M(){const e=document.getElementById("batch-delete-modal");e&&e.classList.add("hidden")}function ze(){const e=document.getElementById("batch-delete-progress-bar");e&&(e.style.width="0%");const t=document.getElementById("batch-delete-status");t&&(t.textContent="Preparing to delete recordings...");const n=document.getElementById("batch-delete-count");n&&(n.textContent="0 / 0");const o=document.getElementById("batch-delete-percentage");o&&(o.textContent="0%");const r=document.getElementById("batch-delete-succeeded");r&&(r.textContent="0");const d=document.getElementById("batch-delete-failed");d&&(d.textContent="0");const i=document.getElementById("batch-delete-message");i&&(i.textContent="");const c=document.getElementById("batch-delete-done-btn");c&&c.classList.add("hidden");const m=document.getElementById("batch-delete-cancel-btn");m&&m.classList.remove("hidden")}window.updateBatchDeleteProgress=function(e){console.log("Updating batch delete progress UI:",e),O();const t=document.getElementById("batch-delete-progress-bar");if(t){if(console.log("Updating progress bar: current=".concat(e.current,", total=").concat(e.total)),e.total>0){const c=Math.round(e.current/e.total*100);console.log("Setting progress bar width to ".concat(c,"%")),t.style.width="".concat(c,"%"),t.classList.remove("animate-pulse"),t.offsetWidth}else if(e.current>0){const c=Math.min(90,e.current/10);console.log("Setting progress bar width to ".concat(c,"% (estimated)")),t.style.width="".concat(c,"%"),t.classList.add("animate-pulse"),t.offsetWidth}else e.complete?(console.log("Setting progress bar to 100% (complete)"),t.style.width="100%",t.classList.remove("animate-pulse"),t.offsetWidth):(console.log("Setting progress bar to 50% (indeterminate)"),t.style.width="50%",t.classList.add("animate-pulse"),t.offsetWidth);e.error?(t.classList.add("bg-red-500"),t.classList.remove("bg-blue-500")):(t.classList.add("bg-blue-500"),t.classList.remove("bg-red-500"))}const n=document.getElementById("batch-delete-status");n&&e.status&&(n.textContent=e.status);const o=document.getElementById("batch-delete-count");o&&(e.total>0?o.textContent="".concat(e.current," / ").concat(e.total):o.textContent="".concat(e.current," / ?"));const r=document.getElementById("batch-delete-percentage");if(r)if(e.total>0){const c=Math.round(e.current/e.total*100);r.textContent="".concat(c,"%")}else e.complete?r.textContent="100%":r.textContent="In progress";const d=document.getElementById("batch-delete-succeeded");d&&(d.textContent=e.succeeded||"0");const i=document.getElementById("batch-delete-failed");if(i&&(i.textContent=e.failed||"0"),e.complete){const c=document.getElementById("batch-delete-done-btn");c&&c.classList.remove("hidden");const m=document.getElementById("batch-delete-cancel-btn");m&&m.classList.add("hidden"),n&&(!e.status||e.status==="Preparing to delete recordings...")&&(n.textContent="Batch delete operation complete"),t&&(t.style.width="100%",t.classList.remove("animate-pulse"))}};function Oe(){M(),V("Batch delete operation cancelled",5e3)}window.batchDeleteRecordingsByHttpRequest=function(e){return console.log("Using HTTP fallback for batch delete with params:",e),new Promise((t,n)=>{O();let o=0;e.ids?o=e.ids.length:e.filter&&e.totalCount&&(o=e.totalCount),updateBatchDeleteProgress({current:0,total:o,status:"Using HTTP fallback for batch delete operation",succeeded:0,failed:0}),fetch("/api/recordings/batch-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(r=>{if(!r.ok)throw new Error("HTTP error ".concat(r.status,": ").concat(r.statusText));return r.json()}).then(r=>{console.log("HTTP batch delete result:",r);const d=r.total||o||0,i=r.succeeded||0,c=r.failed||0;updateBatchDeleteProgress({current:d,total:d,succeeded:i,failed:c,status:"Batch delete operation complete",complete:!0});const m=r.success?"Successfully deleted ".concat(i," recordings"):"Deleted ".concat(i," recordings with ").concat(c," failures");V(m,5e3),setTimeout(()=>{typeof loadRecordings=="function"&&loadRecordings()},1e3),t(r)}).catch(r=>{console.error("HTTP batch delete error:",r),updateBatchDeleteProgress({current:0,total:0,succeeded:0,failed:0,status:"Error: ".concat(r.message||"Unknown error"),complete:!0,error:!0}),V("Error: ".concat(r.message||"Unknown error"),5e3),n(r)})})};document.addEventListener("DOMContentLoaded",()=>{if(console.log("Initializing batch delete modal"),z(),!document.getElementById("batch-delete-modal-container")){console.error("Batch delete modal container not found, creating it");const t=document.createElement("div");t.id="batch-delete-modal-container",document.body.appendChild(t),z()}typeof window.updateBatchDeleteProgress!="function"&&(console.error("updateBatchDeleteProgress function not available, setting it up"),window.updateBatchDeleteProgress=updateBatchDeleteProgress),typeof window.showBatchDeleteModal!="function"&&(console.error("showBatchDeleteModal function not available, setting it up"),window.showBatchDeleteModal=O)});window.showBatchDeleteModal=O;window.updateBatchDeleteProgress=updateBatchDeleteProgress;window.initBatchDeleteModal=z;function Ue({filters:e,setFilters:t,pagination:n,setPagination:o,streams:r,filtersVisible:d,applyFilters:i,resetFilters:c,handleDateRangeChange:m,setDefaultDateRange:b}){return a("aside",{id:"filters-sidebar",className:"filters-sidebar w-full md:w-64 bg-white dark:bg-gray-800 rounded-lg shadow p-4 md:sticky md:top-4 md:self-start transition-all duration-300 ".concat(d?"":"hidden md:block"),children:[a("div",{className:"filter-group mb-4",children:[a("h3",{className:"text-lg font-medium mb-2 pb-1 border-b border-gray-200 dark:border-gray-700",children:"Date Range"}),a("div",{className:"filter-option mb-2",children:[a("label",{htmlFor:"date-range-select",className:"block mb-1 text-sm font-medium",children:"Quick Select:"}),a("select",{id:"date-range-select",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.dateRange,onChange:m,children:[a("option",{value:"today",children:"Today"}),a("option",{value:"yesterday",children:"Yesterday"}),a("option",{value:"last7days",children:"Last 7 Days"}),a("option",{value:"last30days",children:"Last 30 Days"}),a("option",{value:"custom",children:"Custom Range"})]})]}),a("div",{id:"custom-date-range",className:"filter-option space-y-3",style:{display:e.dateRange==="custom"?"block":"none"},children:[a("div",{className:"space-y-1",children:[a("label",{htmlFor:"start-date",className:"block text-sm font-medium",children:"Start Date:"}),a("input",{type:"date",id:"start-date",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.startDate,onChange:g=>t(p=>({...p,startDate:g.target.value}))}),a("div",{className:"mt-1",children:[a("label",{htmlFor:"start-time",className:"block text-sm font-medium",children:"Time:"}),a("input",{type:"time",id:"start-time",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.startTime,onChange:g=>t(p=>({...p,startTime:g.target.value}))})]})]}),a("div",{className:"space-y-1",children:[a("label",{htmlFor:"end-date",className:"block text-sm font-medium",children:"End Date:"}),a("input",{type:"date",id:"end-date",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.endDate,onChange:g=>t(p=>({...p,endDate:g.target.value}))}),a("div",{className:"mt-1",children:[a("label",{htmlFor:"end-time",className:"block text-sm font-medium",children:"Time:"}),a("input",{type:"time",id:"end-time",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.endTime,onChange:g=>t(p=>({...p,endTime:g.target.value}))})]})]})]})]}),a("div",{className:"filter-group mb-4",children:[a("h3",{className:"text-lg font-medium mb-2 pb-1 border-b border-gray-200 dark:border-gray-700",children:"Stream"}),a("div",{className:"filter-option",children:a("select",{id:"stream-filter",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.streamId,onChange:g=>t(p=>({...p,streamId:g.target.value})),children:[a("option",{value:"all",children:"All Streams"}),r.map(g=>a("option",{value:g.name,children:g.name},g.name))]})})]}),a("div",{className:"filter-group mb-4",children:[a("h3",{className:"text-lg font-medium mb-2 pb-1 border-b border-gray-200 dark:border-gray-700",children:"Recording Type"}),a("div",{className:"filter-option",children:a("select",{id:"detection-filter",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:e.recordingType,onChange:g=>t(p=>({...p,recordingType:g.target.value})),children:[a("option",{value:"all",children:"All Recordings"}),a("option",{value:"detection",children:"Detection Events Only"})]})})]}),a("div",{className:"filter-group mb-4",children:[a("h3",{className:"text-lg font-medium mb-2 pb-1 border-b border-gray-200 dark:border-gray-700",children:"Display Options"}),a("div",{className:"filter-option",children:[a("label",{htmlFor:"page-size",className:"block mb-1 text-sm font-medium",children:"Items per page:"}),a("select",{id:"page-size",className:"w-full p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:n.pageSize,onChange:g=>o(p=>({...p,pageSize:parseInt(g.target.value,10)})),children:[a("option",{value:"10",children:"10"}),a("option",{value:"20",children:"20"}),a("option",{value:"50",children:"50"}),a("option",{value:"100",children:"100"})]})]})]}),a("div",{className:"filter-actions flex space-x-2",children:[a("button",{id:"apply-filters-btn",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",onClick:i,children:"Apply Filters"}),a("button",{id:"reset-filters-btn",className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 transition-colors dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",onClick:c,children:"Reset"})]})]})}function _e({activeFiltersDisplay:e,removeFilter:t,hasActiveFilters:n}){return n?a("div",{id:"active-filters",className:"active-filters mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg flex flex-wrap gap-2",children:e.map((o,r)=>a("div",{className:"filter-tag inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200",children:[a("span",{children:o.label}),a("button",{className:"ml-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none",onClick:()=>t(o.key),children:"×"})]},r))}):null}const q={formatDateTime:e=>e?new Date(e).toLocaleString():"",formatDuration:e=>{if(!e)return"00:00:00";const t=Math.floor(e/3600),n=Math.floor(e%3600/60),o=Math.floor(e%60);return[t.toString().padStart(2,"0"),n.toString().padStart(2,"0"),o.toString().padStart(2,"0")].join(":")},formatFileSize:e=>{if(!e)return"0 B";const t=["B","KB","MB","GB","TB"];let n=0,o=e;for(;o>=1024&&n<t.length-1;)o/=1024,n++;return"".concat(o.toFixed(1)," ").concat(t[n])}};function Ae({recordings:e,sortField:t,sortDirection:n,sortBy:o,selectedRecordings:r,toggleRecordingSelection:d,selectAll:i,toggleSelectAll:c,getSelectedCount:m,openDeleteModal:b,playRecording:g,downloadRecording:p,deleteRecording:w,recordingsTableBodyRef:S,pagination:U}){return a("div",{className:"recordings-container bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden w-full",children:[a("div",{className:"batch-actions p-3 border-b border-gray-200 dark:border-gray-700 flex flex-wrap gap-2 items-center",children:[a("div",{className:"selected-count text-sm text-gray-600 dark:text-gray-400 mr-2",children:m()>0?"".concat(m()," recording").concat(m()!==1?"s":""," selected"):"No recordings selected"}),a("button",{className:"px-3 py-1.5 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:m()===0,onClick:()=>b("selected"),children:"Delete Selected"}),a("button",{className:"px-3 py-1.5 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",onClick:()=>b("all"),children:"Delete All Filtered"})]}),a("div",{className:"overflow-x-auto",children:a("table",{id:"recordings-table",className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[a("thead",{className:"bg-gray-50 dark:bg-gray-700",children:a("tr",{children:[a("th",{className:"w-10 px-4 py-3",children:a("input",{type:"checkbox",checked:i,onChange:c,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})}),a("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer",onClick:()=>o("stream_name"),children:a("div",{className:"flex items-center",children:["Stream",t==="stream_name"&&a("span",{className:"sort-icon ml-1",children:n==="asc"?"▲":"▼"})]})}),a("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer",onClick:()=>o("start_time"),children:a("div",{className:"flex items-center",children:["Start Time",t==="start_time"&&a("span",{className:"sort-icon ml-1",children:n==="asc"?"▲":"▼"})]})}),a("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Duration"}),a("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer",onClick:()=>o("size_bytes"),children:a("div",{className:"flex items-center",children:["Size",t==="size_bytes"&&a("span",{className:"sort-icon ml-1",children:n==="asc"?"▲":"▼"})]})}),a("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Detections"}),a("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a("tbody",{ref:S,className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:e.length===0?a("tr",{children:a("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:U.totalItems===0?"No recordings found":"Loading recordings..."})}):e.map(k=>a("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[a("td",{className:"px-4 py-4 whitespace-nowrap",children:a("input",{type:"checkbox",checked:!!r[k.id],onChange:()=>d(k.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:k.stream||""}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:q.formatDateTime(k.start_time)}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:q.formatDuration(k.duration)}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:k.size||""}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:k.has_detections?a("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100",children:[a("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[a("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),a("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}),"Yes"]}):""}),a("td",{className:"px-6 py-4 whitespace-nowrap",children:a("div",{className:"flex space-x-2",children:[a("button",{className:"p-1 rounded-full text-blue-600 hover:bg-blue-100 dark:text-blue-400 dark:hover:bg-blue-900 focus:outline-none",onClick:()=>g(k),title:"Play",children:a("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:a("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),a("button",{className:"p-1 rounded-full text-green-600 hover:bg-green-100 dark:text-green-400 dark:hover:bg-green-900 focus:outline-none",onClick:()=>p(k),title:"Download",children:a("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:a("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})}),a("button",{className:"p-1 rounded-full text-red-600 hover:bg-red-100 dark:text-red-400 dark:hover:bg-red-900 focus:outline-none",onClick:()=>w(k),title:"Delete",children:a("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:a("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})})]},k.id))})]})})]})}function He({pagination:e,goToPage:t}){return a("div",{className:"pagination-controls flex flex-col sm:flex-row justify-between items-center p-4 border-t border-gray-200 dark:border-gray-700",children:[a("div",{className:"pagination-info text-sm text-gray-600 dark:text-gray-400 mb-2 sm:mb-0",children:["Showing ",a("span",{id:"pagination-showing",children:[e.startItem,"-",e.endItem]})," of ",a("span",{id:"pagination-total",children:e.totalItems})," recordings"]}),a("div",{className:"pagination-buttons flex items-center space-x-1",children:[a("button",{id:"pagination-first",className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"First Page",onClick:()=>t(1),disabled:e.currentPage===1,children:"«"}),a("button",{id:"pagination-prev",className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous Page",onClick:()=>t(e.currentPage-1),disabled:e.currentPage===1,children:"‹"}),a("span",{id:"pagination-current",className:"px-2 text-sm text-gray-700 dark:text-gray-300",children:["Page ",e.currentPage," of ",e.totalPages]}),a("button",{id:"pagination-next",className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Next Page",onClick:()=>t(e.currentPage+1),disabled:e.currentPage===e.totalPages,children:"›"}),a("button",{id:"pagination-last",className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Last Page",onClick:()=>t(e.totalPages),disabled:e.currentPage===e.totalPages,children:"»"})]})]})}const v={hooks:{useStreams:()=>ae("streams","/api/streams",{timeout:15e3,retries:2,retryDelay:1e3}),useRecordings:(e,t,n,o)=>{const r=new URLSearchParams;if(r.append("page",t.currentPage),r.append("limit",t.pageSize),r.append("sort",n),r.append("order",o),e.dateRange==="custom")r.append("start","".concat(e.startDate,"T").concat(e.startTime,":00")),r.append("end","".concat(e.endDate,"T").concat(e.endTime,":00"));else{const{start:i,end:c}=v.getDateRangeFromPreset(e.dateRange);r.append("start",i),r.append("end",c)}return e.streamId!=="all"&&r.append("stream",e.streamId),e.recordingType==="detection"&&r.append("detection","1"),ae(["recordings",e,t,n,o],"/api/recordings?".concat(r.toString()),{timeout:3e4,retries:2,retryDelay:1e3})},useDeleteRecording:()=>{const e=j();return Te({mutationFn:async t=>{const n="/api/recordings/".concat(t);return await E(n,{method:"DELETE",timeout:15e3,retries:1,retryDelay:1e3})},onSuccess:()=>{e.invalidateQueries({queryKey:["recordings"]}),h("Recording deleted successfully")},onError:t=>{console.error("Error deleting recording:",t),h("Error deleting recording: "+t.message)}})},useBatchDeleteRecordings:()=>{const e=j();return Ce("/api/recordings/batch-delete",{timeout:6e4,retries:1,retryDelay:2e3},{onSuccess:t=>{e.invalidateQueries({queryKey:["recordings"]});const n=t.succeeded,o=t.failed;n>0&&o===0?h("Successfully deleted ".concat(n," recording").concat(n!==1?"s":"")):n>0&&o>0?h("Deleted ".concat(n," recording").concat(n!==1?"s":"",", but failed to delete ").concat(o)):h("Failed to delete ".concat(o," recording").concat(o!==1?"s":""))},onError:t=>{console.error("Error in batch delete operation:",t),h("Error in batch delete operation: "+t.message)}})}},loadStreams:async()=>{try{return await E("/api/streams",{timeout:15e3,retries:2,retryDelay:1e3})||[]}catch(e){return console.error("Error loading streams for filter:",e),h("Error loading streams: "+e.message),[]}},getDateRangeFromPreset:e=>{const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59),o=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);let r,d;switch(e){case"today":r=o.toISOString(),d=n.toISOString();break;case"yesterday":const i=new Date(o);i.setDate(i.getDate()-1);const c=new Date(i);c.setHours(23,59,59),r=i.toISOString(),d=c.toISOString();break;case"last7days":const m=new Date(o);m.setDate(m.getDate()-7),r=m.toISOString(),d=n.toISOString();break;case"last30days":const b=new Date(o);b.setDate(b.getDate()-30),r=b.toISOString(),d=n.toISOString();break;default:const g=new Date(o);g.setDate(g.getDate()-7),r=g.toISOString(),d=n.toISOString()}return{start:r,end:d}},loadRecordings:async(e,t,n,o)=>{try{const r=new URLSearchParams;if(r.append("page",t.currentPage),r.append("limit",t.pageSize),r.append("sort",n),r.append("order",o),e.dateRange==="custom")r.append("start","".concat(e.startDate,"T").concat(e.startTime,":00")),r.append("end","".concat(e.endDate,"T").concat(e.endTime,":00"));else{const{start:i,end:c}=v.getDateRangeFromPreset(e.dateRange);r.append("start",i),r.append("end",c)}e.streamId!=="all"&&r.append("stream",e.streamId),e.recordingType==="detection"&&r.append("detection","1"),console.log("API Request:","/api/recordings?".concat(r.toString()));const d=await E("/api/recordings?".concat(r.toString()),{timeout:3e4,retries:2,retryDelay:1e3});if(console.log("Recordings data received:",d),d.recordings&&d.recordings.length>0)for(let c=0;c<d.recordings.length;c+=5){const m=d.recordings.slice(c,c+5);await Promise.all(m.map(async b=>{try{b.has_detections=await v.checkRecordingHasDetections(b)}catch(g){console.error("Error checking detections for recording ".concat(b.id,":"),g),b.has_detections=!1}}))}return d}catch(r){throw console.error("Error loading recordings:",r),h("Error loading recordings: "+r.message),r}},deleteRecording:async e=>{try{return await W("/api/recordings/".concat(e.id),{method:"DELETE",timeout:15e3,retries:1,retryDelay:1e3}),h("Recording deleted successfully"),!0}catch(t){return console.error("Error deleting recording:",t),h("Error deleting recording: "+t.message),!1}},deleteSelectedRecordings:async e=>{const t=Object.entries(e).filter(([n,o])=>o).map(([n,o])=>parseInt(n,10));if(t.length===0)return h("No recordings selected"),{succeeded:0,failed:0};try{if(window.wsClient){if(console.log("Using WebSocket for batch delete operation"),window.wsClient.isConnected()||(console.log("WebSocket not connected, connecting now..."),window.wsClient.connect()),!window.batchDeleteClient)if(typeof BatchDeleteRecordingsClient<"u")console.log("Creating new BatchDeleteRecordingsClient"),window.batchDeleteClient=new BatchDeleteRecordingsClient(window.wsClient);else return console.warn("BatchDeleteRecordingsClient not available, falling back to HTTP"),v.deleteSelectedRecordingsHttp(t);return typeof showBatchDeleteModal=="function"&&showBatchDeleteModal(),await window.batchDeleteClient.deleteWithProgress({ids:t})}else return console.log("WebSocket client not available, using HTTP for batch delete"),v.deleteSelectedRecordingsHttp(t)}catch(n){return console.error("Error in batch delete operation:",n),h("Error in batch delete operation: "+n.message),{succeeded:0,failed:0}}},deleteSelectedRecordingsHttp:async e=>{try{const n=await(await W("/api/recordings/batch-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:e}),timeout:6e4,retries:1,retryDelay:2e3})).json(),o=n.succeeded,r=n.failed;return o>0&&r===0?h("Successfully deleted ".concat(o," recording").concat(o!==1?"s":"")):o>0&&r>0?h("Deleted ".concat(o," recording").concat(o!==1?"s":"",", but failed to delete ").concat(r)):h("Failed to delete ".concat(r," recording").concat(r!==1?"s":"")),n}catch(t){return console.error("Error in HTTP batch delete operation:",t),h("Error in batch delete operation: "+t.message),{succeeded:0,failed:0}}},deleteAllFilteredRecordings:async e=>{try{const t={};if(e.dateRange==="custom")t.start="".concat(e.startDate,"T").concat(e.startTime,":00"),t.end="".concat(e.endDate,"T").concat(e.endTime,":00");else{const{start:r,end:d}=v.getDateRangeFromPreset(e.dateRange);t.start=r,t.end=d}e.streamId!=="all"&&(t.stream_name=e.streamId),e.recordingType==="detection"&&(t.detection=1),console.log("Deleting with filter:",t),typeof showBatchDeleteModal=="function"&&(showBatchDeleteModal(),typeof window.updateBatchDeleteProgress=="function"&&window.updateBatchDeleteProgress({current:0,total:0,succeeded:0,failed:0,status:"Preparing to delete recordings matching filter...",complete:!1}));let n=0;try{const r=new URLSearchParams;t.start&&r.append("start",t.start),t.end&&r.append("end",t.end),t.stream_name&&r.append("stream",t.stream_name),t.detection&&r.append("detection","1"),r.append("page","1"),r.append("limit","1"),console.log("Getting total count with params:",r.toString());const d=await fetch("/api/recordings?".concat(r.toString()));if(d.ok){const i=await d.json();i&&i.pagination&&i.pagination.total&&(n=i.pagination.total,console.log("Found ".concat(n," recordings matching filter")),typeof window.updateBatchDeleteProgress=="function"&&window.updateBatchDeleteProgress({current:0,total:n,succeeded:0,failed:0,status:"Found ".concat(n," recordings matching filter. Starting deletion..."),complete:!1}))}}catch(r){console.warn("Error getting recording count:",r)}const o=r=>(console.error("Error in delete all operation:",r),h("Error in delete all operation: "+r.message),typeof window.updateBatchDeleteProgress=="function"&&window.updateBatchDeleteProgress({current:0,total:0,succeeded:0,failed:0,status:"Error: ".concat(r.message),complete:!0}),{succeeded:0,failed:0});if(window.wsClient){if(console.log("Using WebSocket for batch delete with filter"),window.wsClient.isConnected()||(console.log("WebSocket not connected, connecting now..."),window.wsClient.connect()),!window.batchDeleteClient)if(typeof BatchDeleteRecordingsClient<"u")console.log("Creating new BatchDeleteRecordingsClient for filtered delete"),window.batchDeleteClient=new BatchDeleteRecordingsClient(window.wsClient);else return console.warn("BatchDeleteRecordingsClient not available, falling back to HTTP"),v.deleteAllFilteredRecordingsHttp(t);console.log("Using WebSocket client ID for filtered batch delete:",window.wsClient.getClientId());const r=new Promise((d,i)=>{setTimeout(()=>{i(new Error("Operation timed out or server crashed. Some recordings may have been deleted."))},6e4)});try{return await Promise.race([window.batchDeleteClient.deleteWithProgress({filter:t,totalCount:n}),r])}catch(d){return console.error("WebSocket error or timeout:",d),setTimeout(()=>{typeof loadRecordings=="function"&&loadRecordings()},1e3),o(d)}}else return console.log("WebSocket client not available, using HTTP for batch delete with filter"),v.deleteAllFilteredRecordingsHttp(t)}catch(t){return console.error("Error in delete all operation:",t),h("Error in delete all operation: "+t.message),{succeeded:0,failed:0}}},deleteAllFilteredRecordingsHttp:async e=>{try{const n=await(await W("/api/recordings/batch-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filter:e}),timeout:12e4,retries:1,retryDelay:3e3})).json(),o=n.succeeded,r=n.failed;return o>0&&r===0?h("Successfully deleted ".concat(o," recording").concat(o!==1?"s":"")):o>0&&r>0?h("Deleted ".concat(o," recording").concat(o!==1?"s":"",", but failed to delete ").concat(r)):h("Failed to delete ".concat(r," recording").concat(r!==1?"s":"")),n}catch(t){return console.error("Error in HTTP delete all operation:",t),h("Error in delete all operation: "+t.message),{succeeded:0,failed:0}}},checkRecordingHasDetections:async e=>{if(!e||!e.id||!e.stream||!e.start_time||!e.end_time)return!1;try{const t=Math.floor(new Date(e.start_time).getTime()/1e3),n=Math.floor(new Date(e.end_time).getTime()/1e3),o=new URLSearchParams({start:t,end:n}),r=await E("/api/detection/results/".concat(e.stream,"?").concat(o.toString()),{timeout:1e4,retries:1,retryDelay:500});return r.detections&&r.detections.length>0}catch(t){return console.error("Error checking detections:",t),!1}},getRecordingDetections:async e=>{if(!e||!e.id||!e.stream||!e.start_time||!e.end_time)return[];try{const t=Math.floor(new Date(e.start_time).getTime()/1e3),n=Math.floor(new Date(e.end_time).getTime()/1e3),o=new URLSearchParams({start:t,end:n});return(await E("/api/detection/results/".concat(e.stream,"?").concat(o.toString()),{timeout:15e3,retries:1,retryDelay:1e3})).detections||[]}catch(t){return console.error("Error getting detections:",t),[]}},playRecording:(e,t)=>{if(console.log("Play recording clicked:",e),!e.id){console.error("Recording has no id property:",e),h("Error: Recording has no id property");return}const n="/api/recordings/play/".concat(e.id),o="".concat(e.stream," - ").concat(q.formatDateTime(e.start_time)),r="/api/recordings/download/".concat(e.id);console.log("Video URL:",n),console.log("Title:",o),console.log("Download URL:",r),t(n,o,r),console.log("Video modal should be shown now")},downloadRecording:e=>{const t="/api/recordings/download/".concat(e.id),n=document.createElement("a");n.href=t,n.download="".concat(e.stream,"_").concat(new Date(e.start_time).toISOString().replace(/[:.]/g,"-"),".mp4"),document.body.appendChild(n),n.click(),document.body.removeChild(n),h("Download started")}},T={getFiltersFromUrl:()=>{const e=new URLSearchParams(window.location.search);if(!e.has("dateRange")&&!e.has("page")&&!e.has("sort")&&!e.has("detection")&&!e.has("stream"))return null;const t={filters:{dateRange:"last7days",startDate:"",startTime:"00:00",endDate:"",endTime:"23:59",streamId:"all",recordingType:"all"},page:1,limit:20,sort:"start_time",order:"desc"};return e.has("dateRange")&&(t.filters.dateRange=e.get("dateRange"),t.filters.dateRange==="custom"&&(e.has("startDate")&&(t.filters.startDate=e.get("startDate")),e.has("startTime")&&(t.filters.startTime=e.get("startTime")),e.has("endDate")&&(t.filters.endDate=e.get("endDate")),e.has("endTime")&&(t.filters.endTime=e.get("endTime")))),e.has("stream")&&(t.filters.streamId=e.get("stream")),e.has("detection")&&e.get("detection")==="1"&&(t.filters.recordingType="detection"),e.has("page")&&(t.page=parseInt(e.get("page"),10)),e.has("limit")&&(t.limit=parseInt(e.get("limit"),10)),e.has("sort")&&(t.sort=e.get("sort")),e.has("order")&&(t.order=e.get("order")),t},getActiveFiltersDisplay:e=>{const t=[];if(e.dateRange!=="last7days"||e.streamId!=="all"||e.recordingType!=="all"){if(e.dateRange!=="last7days"){let o="";switch(e.dateRange){case"today":o="Today";break;case"yesterday":o="Yesterday";break;case"last30days":o="Last 30 Days";break;case"custom":o="".concat(e.startDate," to ").concat(e.endDate);break}t.push({key:"dateRange",label:"Date: ".concat(o)})}e.streamId!=="all"&&t.push({key:"streamId",label:"Stream: ".concat(e.streamId)}),e.recordingType!=="all"&&t.push({key:"recordingType",label:"Detection Events Only"})}return t},loadFiltersFromUrl:(e,t,n,o,r,d)=>{const i=new URLSearchParams(window.location.search),c={...e};i.has("dateRange")&&(c.dateRange=i.get("dateRange"),c.dateRange==="custom"&&(i.has("startDate")&&(c.startDate=i.get("startDate")),i.has("startTime")&&(c.startTime=i.get("startTime")),i.has("endDate")&&(c.endDate=i.get("endDate")),i.has("endTime")&&(c.endTime=i.get("endTime")))),i.has("stream")&&(c.streamId=i.get("stream")),i.has("detection")&&i.get("detection")==="1"&&(c.recordingType="detection"),n(c),i.has("page")&&o(m=>({...m,currentPage:parseInt(i.get("page"),10)})),i.has("limit")&&o(m=>({...m,pageSize:parseInt(i.get("limit"),10)})),i.has("sort")&&r(i.get("sort")),i.has("order")&&d(i.get("order"))},updateUrlWithFilters:(e,t,n,o)=>{const r=new URLSearchParams(window.location.search);r.set("t",Date.now().toString()),r.set("dateRange",e.dateRange),e.dateRange==="custom"?(r.set("startDate",e.startDate),r.set("startTime",e.startTime),r.set("endDate",e.endDate),r.set("endTime",e.endTime)):(r.delete("startDate"),r.delete("startTime"),r.delete("endDate"),r.delete("endTime")),e.streamId!=="all"?r.set("stream",e.streamId):r.delete("stream"),e.recordingType==="detection"?r.set("detection","1"):r.delete("detection"),r.set("page",t.currentPage.toString()),r.set("limit",t.pageSize.toString()),r.set("sort",n),r.set("order",o);const d="".concat(window.location.pathname,"?").concat(r.toString());window.history.pushState({path:d},"",d);const i=d;window.onbeforeunload=function(){window.history.replaceState({path:i},"",i)}}};function We(){const[e,t]=D([]),[n,o]=D([]),[r,d]=D(!0),[i,c]=D("start_time"),[m,b]=D("desc"),[g,p]=D({dateRange:"last7days",startDate:"",startTime:"00:00",endDate:"",endTime:"23:59",streamId:"all",recordingType:"all"}),[w,S]=D({currentPage:1,pageSize:20,totalItems:0,totalPages:1,startItem:0,endItem:0}),[U,k]=D(!1),[oe,se]=D([]),[_,B]=D({}),[Q,A]=D(!1),[ie,J]=D(!1),[K,de]=D("selected"),le=Pe(null);j();const{data:$,isLoading:je,error:F}=v.hooks.useStreams();I(()=>{$&&Array.isArray($)&&o($)},[$]),I(()=>{F&&(console.error("Error loading streams for filter:",F),h("Error loading streams: "+F.message))},[F]),I(()=>{if(typeof re<"u"){if(window.wsClient=new re,console.log("WebSocket client initialized at application level"),window.wsClient){console.log("Initial WebSocket connection state:",{connected:window.wsClient.isConnected(),clientId:window.wsClient.getClientId()});const l=window.wsClient.connect;window.wsClient.connect=function(){const f=l.apply(this,arguments);if(this.socket){const y=this.socket.onopen;this.socket.onopen=R=>{console.log("WebSocket connection opened at application level"),y&&y.call(this,R)};const x=this.socket.onerror;this.socket.onerror=R=>{console.error("WebSocket error at application level:",R),x&&x.call(this,R)};const C=this.socket.onclose;this.socket.onclose=R=>{console.log("WebSocket connection closed at application level: ".concat(R.code," ").concat(R.reason)),C&&C.call(this,R)};const P=this.socket.onmessage;this.socket.onmessage=R=>{R.data.includes('"type":"welcome"')||console.log("WebSocket message received at application level"),P&&P.call(this,R)}}return f};const u=window.wsClient.handleMessage;window.wsClient.handleMessage=function(f){const y=this.clientId;u.call(this,f);const x=this.clientId;y!==x&&x&&console.log("WebSocket client ID changed at application level: ".concat(x))}}typeof ne<"u"&&(window.batchDeleteClient=new ne(window.wsClient),console.log("Batch delete client initialized"))}Y();const s=T.getFiltersFromUrl();if(s){console.log("Found URL filters:",s);const l=new URLSearchParams(window.location.search);l.has("detection")&&l.get("detection")==="1"&&(s.filters.recordingType="detection"),p(s.filters),S(u=>({...u,currentPage:s.page||1,pageSize:s.limit||20})),c(s.sort||"start_time"),b(s.order||"desc")}return H(),window.addEventListener("resize",H),()=>{window.removeEventListener("resize",H)}},[]),I(()=>{pe()},[g]);const Y=()=>{const s=new Date,l=new Date(s);l.setDate(s.getDate()-7),p(u=>({...u,endDate:s.toISOString().split("T")[0],startDate:l.toISOString().split("T")[0]}))},{data:N,isLoading:ce,error:L,refetch:Ve}=v.hooks.useRecordings(g,w,i,m);I(()=>{if(N){const s=N.recordings||[];g.recordingType==="detection"&&s.forEach(l=>{l.has_detections=!0}),t(s),G(s.length>0),N.pagination&&X(N,w.currentPage)}},[N,g.recordingType]),I(()=>{L&&(console.error("Error loading recordings:",L),h("Error loading recordings: "+L.message),G(!1))},[L]);const H=()=>{window.innerWidth<768?d(!1):d(!0)},ge=()=>{d(!r)},[me,G]=D(!1),ue=(s=w.currentPage,l=!0)=>{console.log("Loading recordings with filters:",JSON.stringify(g));const u={...w,currentPage:s};S(u),l&&T.updateUrlWithFilters(g,u,i,m)},X=(s,l)=>{if(l=l||w.currentPage,s.pagination){const u=s.pagination.limit||20,f=s.pagination.total||0,y=s.pagination.pages||1;let x=0,C=0;s.recordings.length>0&&(x=(l-1)*u+1,C=Math.min(x+s.recordings.length-1,f)),console.log("Pagination update:",{currentPage:l,pageSize:u,totalItems:f,totalPages:y,startItem:x,endItem:C,recordingsLength:s.recordings.length}),S(P=>({...P,totalItems:f,totalPages:y,pageSize:u,startItem:x,endItem:C}))}else{const u=w.pageSize,f=s.total||0,y=Math.ceil(f/u)||1;let x=0,C=0;s.recordings.length>0&&(x=(l-1)*u+1,C=Math.min(x+s.recordings.length-1,f)),console.log("Pagination update (fallback):",{currentPage:l,pageSize:u,totalItems:f,totalPages:y,startItem:x,endItem:C,recordingsLength:s.recordings.length}),S(P=>({...P,totalItems:f,totalPages:y,startItem:x,endItem:C}))}},he=s=>{const l=s.target.value;if(p(u=>({...u,dateRange:l})),l==="custom"&&(!g.startDate||!g.endDate)){const u=new Date,f=new Date(u);f.setDate(u.getDate()-7),p(y=>({...y,endDate:u.toISOString().split("T")[0],startDate:f.toISOString().split("T")[0]}))}},pe=()=>{const s=T.getActiveFiltersDisplay(g);k(s.length>0),se(s)},Z=(s=!0)=>{s&&S(l=>({...l,currentPage:1})),T.updateUrlWithFilters(g,s?{...w,currentPage:1}:w,i,m)},fe=()=>{const s={dateRange:"last7days",startDate:"",startTime:"00:00",endDate:"",endTime:"23:59",streamId:"all",recordingType:"all"},l=new Date,u=new Date(l);u.setDate(l.getDate()-7),s.endDate=l.toISOString().split("T")[0],s.startDate=u.toISOString().split("T")[0],p(s),S(y=>({...y,currentPage:1})),c("start_time"),b("desc");const f=window.location.pathname;window.history.pushState({path:f},"",f)},ye=s=>{switch(s){case"dateRange":p(l=>({...l,dateRange:"last7days"}));break;case"streamId":p(l=>({...l,streamId:"all"}));break;case"recordingType":p(l=>({...l,recordingType:"all"}));break}Z()},be=s=>{i===s?b(m==="asc"?"desc":"asc"):(b(s==="start_time"?"desc":"asc"),c(s)),S(l=>({...l,currentPage:1})),T.updateUrlWithFilters(g,{...w,currentPage:1},s,s===i?m==="asc"?"desc":"asc":s==="start_time"?"desc":"asc")},we=s=>{s<1||s>w.totalPages||(S(l=>({...l,currentPage:s})),T.updateUrlWithFilters(g,{...w,currentPage:s},i,m))},xe=s=>{B(l=>({...l,[s]:!l[s]}))},ve=()=>{const s=!Q;A(s);const l={};s&&e.forEach(u=>{l[u.id]=!0}),B(l)},ee=()=>Object.values(_).filter(Boolean).length,De=s=>{de(s),J(!0)},te=()=>{J(!1)},ke=async()=>{te();const s=new URLSearchParams(window.location.search),l=s.get("sort")||i,u=s.get("order")||m,f=parseInt(s.get("page"),10)||w.currentPage;if(K==="selected"){const y=await v.deleteSelectedRecordings(_);B({}),A(!1),y.succeeded>0&&Se(l,u,f)}else{const y=await v.deleteAllFilteredRecordings(g);B({}),A(!1),y.succeeded>0&&ue()}},Se=(s,l,u)=>{c(s),b(l),S(f=>({...f,currentPage:u})),setTimeout(()=>{const f={...w,currentPage:u};T.updateUrlWithFilters(g,f,s,l),v.loadRecordings(g,f,s,l).then(y=>{console.log("Recordings data received:",y),t(y.recordings||[]),X(y,u)}).catch(y=>{console.error("Error loading recordings:",y),h("Error loading recordings: "+y.message)})},0)},{mutate:Re}=v.hooks.useDeleteRecording();return a("section",{id:"recordings-page",class:"page",children:[a("div",{class:"page-header flex justify-between items-center mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow",children:[a("div",{class:"flex items-center",children:[a("h2",{class:"text-xl font-bold",children:"Recordings"}),a("div",{class:"ml-4 flex",children:[a("a",{href:"recordings.html",class:"px-3 py-1 bg-blue-500 text-white rounded-l-md",children:"Table View"}),a("a",{href:"timeline.html",class:"px-3 py-1 bg-gray-300 text-gray-700 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-400 dark:hover:bg-gray-600 rounded-r-md",children:"Timeline View"})]})]}),a("button",{id:"toggle-filters-btn",class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 focus:outline-none",title:"Toggle Filters",onClick:ge,children:a("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:a("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})})})]}),a("div",{class:"recordings-layout flex flex-col md:flex-row gap-4 w-full",children:[a(Ue,{filters:g,setFilters:p,pagination:w,setPagination:S,streams:n,filtersVisible:r,applyFilters:Z,resetFilters:fe,handleDateRangeChange:he,setDefaultDateRange:Y}),a("div",{class:"recordings-content flex-1",children:[a(_e,{activeFiltersDisplay:oe,removeFilter:ye,hasActiveFilters:U}),a(Me,{isLoading:ce,hasData:me,loadingMessage:"Loading recordings...",emptyMessage:"No recordings found matching your criteria",children:[a(Ae,{recordings:e,sortField:i,sortDirection:m,sortBy:be,selectedRecordings:_,toggleRecordingSelection:xe,selectAll:Q,toggleSelectAll:ve,getSelectedCount:ee,openDeleteModal:De,playRecording:s=>{v.playRecording(s,$e)},downloadRecording:s=>{v.downloadRecording(s)},deleteRecording:s=>{confirm("Are you sure you want to delete this recording from ".concat(s.stream,"?"))&&Re(s.id)},recordingsTableBodyRef:le,pagination:w}),a(He,{pagination:w,goToPage:we})]})]})]}),a(Be,{isOpen:ie,onClose:te,onConfirm:ke,mode:K,count:ee()})]})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("main-content");e&&Ie(a(Ee,{client:Ne,children:[a(Fe,{}),a(We,{}),a(Le,{})]}),e)});export{Ke as __vite_legacy_guard};
//# sourceMappingURL=recordings-CPBcjzRb.js.map
