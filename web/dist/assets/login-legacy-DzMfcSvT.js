System.register(["./query-client-legacy-9D2AVzO6.js","./layout-legacy-DRwN0y1N.js"],(function(e,r){"use strict";var o,t,a,n,l,s,i,c;return{setters:[e=>{o=e.d,t=e.A,a=e.y,n=e.u,l=e.E,s=e.c,i=e.e,c=e.Q},null],execute:function(){function e(){const[e,r]=o(""),[l,s]=o(""),[i,c]=o(!1),[d,u]=o(""),g=t(null);return a((()=>{const e=new URLSearchParams(window.location.search);e.has("error")?u("Invalid username or password"):e.has("auth_required")&&e.has("logout")?u("You have been successfully logged out."):e.has("auth_required")?u("Authentication required. Please log in to continue."):e.has("logout")&&u("You have been successfully logged out.")}),[]),t(null),a((()=>()=>{g.current&&clearTimeout(g.current)}),[]),n("section",{id:"login-page",className:"page flex items-center justify-center min-h-screen",children:n("div",{className:"login-container w-full max-w-md p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[n("div",{className:"text-center mb-8",children:[n("h1",{className:"text-2xl font-bold",children:"LightNVR"}),n("p",{className:"text-gray-600 dark:text-gray-400",children:"Please sign in to continue"})]}),d&&n("div",{className:"mb-4 p-3 rounded-lg "+(d.includes("successfully logged out")||d.includes("Click the button below")||d.includes("Login successful")?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200"),children:d}),n("form",{id:"login-form",className:"space-y-6",action:"/api/auth/login",method:"POST",onSubmit:async r=>{if(r.preventDefault(),e&&l){c(!0),u("");try{const r=btoa(`${e}:${l}`);if(localStorage.setItem("auth",r),(await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Basic ${r}`},body:JSON.stringify({username:e,password:l}),timeout:1e4})).ok){console.log("Login successful, proceeding to redirect");try{const e=new URLSearchParams(window.location.search).get("redirect"),r=e||"/index.html";g.current=setTimeout((()=>{console.log("Fallback: trying window.location.href"),window.location.href=r,g.current=setTimeout((()=>{console.log("Fallback: trying window.location.replace"),window.location.replace(r)}),500)}),500)}catch(o){console.error("Redirect error:",o),window.location.replace("index.html")}}else c(!1),u("Invalid username or password"),localStorage.removeItem("auth")}catch(t){console.error("Login error:",t),c(!1),u("An error occurred during login. Please try again."),localStorage.removeItem("auth")}}else u("Please enter both username and password")},children:[n("div",{className:"form-group",children:[n("label",{htmlFor:"username",className:"block text-sm font-medium mb-1",children:"Username"}),n("input",{type:"text",id:"username",name:"username",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Enter your username",value:e,onChange:e=>r(e.target.value),required:!0,autoComplete:"username"})]}),n("div",{className:"form-group",children:[n("label",{htmlFor:"password",className:"block text-sm font-medium mb-1",children:"Password"}),n("input",{type:"password",id:"password",name:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Enter your password",value:l,onChange:e=>s(e.target.value),required:!0,autoComplete:"current-password"})]}),n("div",{className:"form-group",children:n("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:i,children:i?"Signing in...":"Sign In"})})]}),n("div",{className:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400",children:[n("p",{children:"Default credentials: admin / admin"}),n("p",{className:"mt-2",children:"You can change these in Settings after login"})]})]})})}document.addEventListener("DOMContentLoaded",(()=>{const r=document.getElementById("main-content");r&&l(n(c,{client:s,children:[n(i,{}),n(e,{})]}),r)}))}}}));
//# sourceMappingURL=login-legacy-DzMfcSvT.js.map
