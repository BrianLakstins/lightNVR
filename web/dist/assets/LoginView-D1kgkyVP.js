const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./preact-app-DMiXxE4W.js","../css/preact-app.css"])))=>i.map(i=>d[i]);
var f=Object.freeze,v=Object.defineProperty;var i=(t,a)=>f(v(t,"raw",{value:f(a||t.slice())}));import{d as n,A as x,h as c,_ as k}from"./preact-app-DMiXxE4W.js";var h,p;function P(){const[t,a]=n(""),[s,w]=n(""),[g,l]=n(!1),[d,r]=n("");n(()=>{const e=new URLSearchParams(window.location.search);e.has("error")?r("Invalid username or password"):e.has("auth_required")&&e.has("logout")?r("You have been successfully logged out."):e.has("auth_required")?r("Authentication required. Please log in to continue."):e.has("logout")&&r("You have been successfully logged out.")}),x(null);const u=()=>{const o=new URLSearchParams(window.location.search).get("redirect");o?window.location.href=o:window.location.href="/index.html?t="+new Date().getTime()},y=async e=>{if(e.preventDefault(),!t||!s){r("Please enter both username and password");return}l(!0),r("");try{const o=btoa("".concat(t,":").concat(s));localStorage.setItem("auth",o);const m=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic ".concat(o)},body:JSON.stringify({username:t,password:s}),timeout:1e4});m.ok||m.status===302?u():(l(!1),r("Invalid username or password"),localStorage.removeItem("auth"))}catch(o){console.error("Login error:",o),o.message==="Request timed out"&&localStorage.getItem("auth")?(console.log("Login request timed out, proceeding with stored credentials"),u()):localStorage.getItem("auth")?(console.log("Login API error, but proceeding with stored credentials"),u()):(l(!1),r("Login failed. Please try again."))}};return c(p||(p=i(['\n    <section id="login-page" class="page flex items-center justify-center min-h-screen">\n      <div class="login-container w-full max-w-md p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg">\n        <div class="text-center mb-8">\n          <h1 class="text-2xl font-bold">LightNVR</h1>\n          <p class="text-gray-600 dark:text-gray-400">Please sign in to continue</p>\n        </div>\n        \n        ','\n        \n        <form id="login-form" class="space-y-6" action="/api/auth/login" method="POST" onSubmit=','>\n          <div class="form-group">\n            <label for="username" class="block text-sm font-medium mb-1">Username</label>\n            <input \n              type="text" \n              id="username" \n              name="username"\n              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"\n              placeholder="Enter your username" \n              value=',"\n              onChange=",'\n              required\n              autocomplete="username"\n            />\n          </div>\n          <div class="form-group">\n            <label for="password" class="block text-sm font-medium mb-1">Password</label>\n            <input \n              type="password" \n              id="password" \n              name="password"\n              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"\n              placeholder="Enter your password" \n              value=',"\n              onChange=",'\n              required\n              autocomplete="current-password"\n            />\n          </div>\n          <div class="form-group">\n            <button \n              type="submit" \n              class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"\n              disabled=',"\n            >\n              ",'\n            </button>\n          </div>\n        </form>\n        \n        <div class="mt-6 text-center text-sm text-gray-600 dark:text-gray-400">\n          <p>Default credentials: admin / admin</p>\n          <p class="mt-2">You can change these in Settings after login</p>\n        </div>\n      </div>\n    </section>\n  '])),d&&c(h||(h=i(["\n          <div class=",">\n            ","\n          </div>\n        "])),"mb-4 p-3 rounded-lg ".concat(d.includes("successfully logged out")?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200"),d),y,t,e=>a(e.target.value),s,e=>w(e.target.value),g,g?"Signing in...":"Sign In")}var b;function I(){const t=document.getElementById("main-content");t&&k(async()=>{const{render:a}=await import("./preact-app-DMiXxE4W.js").then(s=>s.p);return{render:a}},__vite__mapDeps([0,1]),import.meta.url).then(({render:a})=>{a(c(b||(b=i(["<"," />"])),P),t)})}export{P as LoginView,I as loadLoginView};
//# sourceMappingURL=LoginView-D1kgkyVP.js.map
