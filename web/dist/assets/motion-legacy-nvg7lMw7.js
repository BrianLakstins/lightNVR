System.register(["./query-client-legacy-9D2AVzO6.js","./layout-legacy-DRwN0y1N.js","./LoadingIndicator-legacy-DG1lqe4I.js","./Footer-legacy-CIhhbTSM.js"],(function(e,r){"use strict";var t,a,n,o,d,i,s,l,c,m,g,u,y,b;return{setters:[e=>{t=e.a,a=e.d,n=e.b,o=e.h,d=e.s,i=e.i,s=e.u,l=e.E,c=e.c,m=e.e,g=e.Q},null,e=>{u=e.C},e=>{y=e.H,b=e.F}],execute:function(){function e(){const e=t(),[l,c]=a(null),[m,g]=a(!1),[y,b]=a({enabled:!0,pre_buffer_seconds:5,post_buffer_seconds:10,max_file_duration:300,codec:"h264",quality:"medium",retention_days:7}),{data:f=[],isLoading:h}=n(["streams"],"/api/streams",{timeout:1e4,retries:2,retryDelay:1e3}),{data:p,isLoading:k}=n(["motionStorage"],"/api/motion/storage",{timeout:5e3,retries:1,retryDelay:1e3}),v=Array.isArray(f)?f:f.streams||[],N=o({mutationFn:async e=>{const{streamName:r,...t}=e,a=`/api/motion/config/${encodeURIComponent(r)}`;return await i(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),timeout:1e4})},onSuccess:()=>{d("Motion recording configuration saved"),g(!1),e.invalidateQueries({queryKey:["motionConfig"]}),e.invalidateQueries({queryKey:["motionStats"]})},onError:e=>{d(`Error saving configuration: ${e.message}`,5e3,"error")}}),w=o({mutationFn:async e=>{const r=`/api/motion/config/${encodeURIComponent(e)}`;return await i(r,{method:"DELETE",timeout:1e4})},onSuccess:()=>{d("Motion recording disabled"),e.invalidateQueries({queryKey:["motionConfig"]}),e.invalidateQueries({queryKey:["motionStats"]})},onError:e=>{d(`Error disabling motion recording: ${e.message}`,5e3,"error")}}),C=async e=>{c(e);try{const r=await i(`/api/motion/config/${encodeURIComponent(e.name)}`,{timeout:5e3});b(r)}catch(r){b({enabled:!0,pre_buffer_seconds:5,post_buffer_seconds:10,max_file_duration:300,codec:"h264",quality:"medium",retention_days:7})}g(!0)},_=e=>{confirm(`Disable motion recording for ${e}?`)&&w.mutate(e)};return h?s(u,{}):s("div",{className:"container mx-auto px-4 py-8",children:[s("div",{className:"mb-8",children:[s("h1",{className:"text-3xl font-bold mb-2",children:"Motion Recording"}),s("p",{className:"text-gray-600 dark:text-gray-400",children:"Configure ONVIF motion detection recording for your cameras"})]}),p&&s("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8",children:[s("h2",{className:"text-xl font-semibold mb-4",children:"Storage Statistics"}),s("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded",children:[s("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Recordings"}),s("div",{className:"text-2xl font-bold",children:p.total_recordings||0})]}),s("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded",children:[s("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Size"}),s("div",{className:"text-2xl font-bold",children:(e=>{if(0===e)return"0 B";const r=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,r)*100)/100+" "+["B","KB","MB","GB","TB"][r]})(p.total_size_bytes||0)})]}),s("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded",children:[s("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Disk Usage"}),s("div",{className:"text-2xl font-bold",children:[(p.disk_space_used_percent||0).toFixed(1),"%"]})]})]})]}),s("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:[s("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:s("h2",{className:"text-xl font-semibold",children:"Camera Motion Settings"})}),s("div",{className:"overflow-x-auto",children:s("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[s("thead",{className:"bg-gray-50 dark:bg-gray-700",children:s("tr",{children:[s("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Camera"}),s("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),s("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pre-Buffer"}),s("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Post-Buffer"}),s("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Retention"}),s("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),s("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:v.map((e=>s(r,{stream:e,onConfigure:C,onDisable:_},e.name)))})]})})]}),m&&l&&s(x,{stream:l,config:y,onConfigChange:b,onSave:()=>{l&&N.mutate({streamName:l.name,...y})},onClose:()=>g(!1),isSaving:N.isPending})]})}function r({stream:e,onConfigure:r,onDisable:t}){const[o,d]=a(null),[i,l]=a(null),{data:c}=n(["motionStats",e.name],`/api/motion/stats/${encodeURIComponent(e.name)}`,{timeout:5e3,retries:1,retryDelay:1e3,onError:()=>{}}),{data:m}=n(["motionConfig",e.name],`/api/motion/config/${encodeURIComponent(e.name)}`,{timeout:5e3,retries:1,retryDelay:1e3,onError:()=>{}}),g=m?.enabled||!1;return s("tr",{children:[s("td",{className:"px-6 py-4 whitespace-nowrap",children:s("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.name})}),s("td",{className:"px-6 py-4 whitespace-nowrap",children:s("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(g?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:g?"Enabled":"Disabled"})}),s("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[m?.pre_buffer_seconds||"-","s"]}),s("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[m?.post_buffer_seconds||"-","s"]}),s("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[m?.retention_days||"-"," days"]}),s("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[s("button",{onClick:()=>r(e),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-4",children:"Configure"}),g&&s("button",{onClick:()=>t(e.name),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"Disable"})]})]})}function x({stream:e,config:r,onConfigChange:t,onSave:a,onClose:n,isSaving:o}){const d=(e,a)=>{t({...r,[e]:a})};return s("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[s("h2",{className:"text-2xl font-bold",children:"Motion Recording Configuration"}),s("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:["Camera: ",e.name]})]}),s("div",{className:"p-6 space-y-6",children:[s("div",{className:"flex items-center justify-between",children:[s("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Enable Motion Recording"}),s("label",{className:"relative inline-flex items-center cursor-pointer",children:[s("input",{type:"checkbox",checked:r.enabled,onChange:e=>d("enabled",e.target.checked),className:"sr-only peer"}),s("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),s("div",{children:[s("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pre-Event Buffer (seconds)"}),s("input",{type:"number",min:"0",max:"30",value:r.pre_buffer_seconds,onChange:e=>d("pre_buffer_seconds",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),s("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Seconds of video to include before motion event (0-30)"})]}),s("div",{children:[s("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Post-Event Buffer (seconds)"}),s("input",{type:"number",min:"0",max:"60",value:r.post_buffer_seconds,onChange:e=>d("post_buffer_seconds",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),s("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Seconds to continue recording after motion stops (0-60)"})]}),s("div",{children:[s("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Maximum File Duration (seconds)"}),s("input",{type:"number",min:"60",max:"3600",step:"60",value:r.max_file_duration,onChange:e=>d("max_file_duration",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),s("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Maximum duration for a single recording file (60-3600 seconds)"})]}),s("div",{children:[s("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Video Codec"}),s("select",{value:r.codec,onChange:e=>d("codec",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[s("option",{value:"h264",children:"H.264"}),s("option",{value:"h265",children:"H.265"})]})]}),s("div",{children:[s("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Recording Quality"}),s("select",{value:r.quality,onChange:e=>d("quality",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[s("option",{value:"low",children:"Low"}),s("option",{value:"medium",children:"Medium"}),s("option",{value:"high",children:"High"})]})]}),s("div",{children:[s("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Retention Period (days)"}),s("input",{type:"number",min:"1",max:"365",value:r.retention_days,onChange:e=>d("retention_days",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),s("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Automatically delete recordings older than this many days (1-365)"})]})]}),s("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3",children:[s("button",{onClick:n,disabled:o,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),s("button",{onClick:a,disabled:o,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:o?"Saving...":"Save Configuration"})]})]})})}document.addEventListener("DOMContentLoaded",(()=>{const r=document.getElementById("main-content");r&&l(s(g,{client:c,children:[s(y,{}),s(m,{}),s(e,{}),s(b,{})]}),r)}))}}}));
//# sourceMappingURL=motion-legacy-nvg7lMw7.js.map
