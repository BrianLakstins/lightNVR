System.register(["./query-client-legacy-BsQz_eUz.js","./UI-legacy-NBPkm0hC.js"],(function(e,t){"use strict";var o,n,a,s,r,i;return{setters:[e=>{o=e.d,n=e.q,a=e.s,s=e.y,r=e.u},e=>{i=e.c}],execute:function(){function t(){const[e,t]=o({canvas:null,fileName:null});return{takeSnapshot:n(((e,o)=>{console.log(`Taking snapshot of stream with ID: ${e}`);const n=document.querySelector(`.snapshot-btn[data-id="${e}"]`);let s;if(n)s=n.getAttribute("data-name");else if(o){const e=o.currentTarget||o.target,t=e?e.closest(".video-cell"):null;t&&(s=t.dataset.streamName)}if(!s)return console.error("Stream name not found for ID:",e),void a("Cannot take snapshot: Stream not identified","error");const r=`video-${s.replace(/\s+/g,"-")}`,d=document.getElementById(r);if(!d)return void console.error("Video element not found for stream:",s);const l=document.createElement("canvas");if(l.width=d.videoWidth,l.height=d.videoHeight,0===l.width||0===l.height)return console.error("Invalid video dimensions:",l.width,l.height),void a("Cannot take snapshot: Video not loaded or has invalid dimensions");l.getContext("2d").drawImage(d,0,0,l.width,l.height);try{const e=(new Date).toISOString().replace(/[:.]/g,"-"),o=`snapshot-${s.replace(/\s+/g,"-")}-${e}.jpg`;t({canvas:l,fileName:o}),i(l.toDataURL("image/jpeg",.95),`Snapshot: ${s}`),a("Snapshot taken successfully")}catch(c){console.error("Error creating snapshot:",c),a("Failed to create snapshot: "+c.message)}}),[]),downloadSnapshot:n((()=>{const{canvas:t,fileName:o}=e;if(!t)return console.error("No snapshot canvas available"),void a("Download failed: No snapshot data available");t.toBlob((function(e){if(!e)return console.error("Failed to create blob from canvas"),void a("Download failed: Unable to create image data");console.log("Created blob:",e.size,"bytes");const t=URL.createObjectURL(e);console.log("Created blob URL:",t);const n=document.createElement("a");n.href=t,n.download=o||"snapshot.jpg",document.body.appendChild(n),console.log("Added download link to document"),n.click(),setTimeout((()=>{document.body.contains(n)&&document.body.removeChild(n),URL.revokeObjectURL(t),console.log("Cleaned up download resources")}),1e3),a("Download started")}),"image/jpeg",.95)}),[e]),hasSnapshot:!!e.canvas}}e({SnapshotButton:function({streamId:e,streamName:o}){const{takeSnapshot:n}=t();return r("button",{className:"snapshot-btn",title:"Take Snapshot","data-id":e,"data-name":o,onClick:t=>{t.preventDefault(),t.stopPropagation(),n(e,t)},children:r("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[r("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r("circle",{cx:"12",cy:"13",r:"4"})]})})},SnapshotManager:function(){const{takeSnapshot:e,downloadSnapshot:o}=t();return s((()=>(window.takeSnapshot=e,()=>{delete window.takeSnapshot})),[e]),null},useSnapshotManager:t})}}}));
//# sourceMappingURL=SnapshotManager-legacy-BEbReu8i.js.map
