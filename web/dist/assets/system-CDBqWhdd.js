import{u as e,d as v,A as D,y as w,c as H,a as E,s as y,g as P,E as B,e as I,T as K,Q}from"./query-client-CKvJ69Lv.js";/* empty css               */import{C as G}from"./LoadingIndicator-DNuPz-3P.js";import{W as z}from"./websocket-client-DzZLM-9M.js";import{H as Y,F as J}from"./Footer-BGfTnlCZ.js";function de(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function Z({restartSystem:t,shutdownSystem:n,isRestarting:l,isShuttingDown:o}){return e("div",{className:"page-header flex justify-between items-center mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow",children:[e("h2",{className:"text-xl font-bold",children:"System"}),e("div",{className:"controls space-x-2",children:[e("button",{id:"restart-btn",className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed",onClick:t,disabled:l||o,children:"Restart"}),e("button",{id:"shutdown-btn",className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed",onClick:n,disabled:l||o,children:"Shutdown"})]})]})}function X({systemInfo:t,formatUptime:n}){var l,o,i,s;return e("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"System Information"}),e("div",{className:"space-y-2",children:[e("div",{className:"flex justify-between",children:[e("span",{className:"font-medium",children:"Version:"}),e("span",{children:t.version||"Unknown"})]}),e("div",{className:"flex justify-between",children:[e("span",{className:"font-medium",children:"Uptime:"}),e("span",{children:t.uptime?n(t.uptime):"Unknown"})]}),e("div",{className:"flex justify-between",children:[e("span",{className:"font-medium",children:"CPU Model:"}),e("span",{children:((l=t.cpu)==null?void 0:l.model)||"Unknown"})]}),e("div",{className:"flex justify-between",children:[e("span",{className:"font-medium",children:"CPU Cores:"}),e("span",{children:((o=t.cpu)==null?void 0:o.cores)||"Unknown"})]}),e("div",{className:"flex justify-between items-center",children:[e("span",{className:"font-medium",children:"CPU Usage:"}),e("div",{className:"w-32 bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:e("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(((i=t.cpu)==null?void 0:i.usage)||0,"%")}})}),e("span",{children:(s=t.cpu)!=null&&s.usage?"".concat(t.cpu.usage.toFixed(1),"%"):"Unknown"})]})]})]})}function ee({systemInfo:t,formatBytes:n}){var c,u,f,h,m,S,p,C,$,W,L,M;const l=((c=t.memory)==null?void 0:c.used)||0,o=((u=t.go2rtcMemory)==null?void 0:u.used)||0,i=((f=t.memory)==null?void 0:f.total)||0,s=l+o,a=i?(s/i*100).toFixed(1):0,d=s?(l/s*100).toFixed(1):0,r=s?(o/s*100).toFixed(1):0;return e("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Memory & Storage"}),e("div",{className:"space-y-4",children:[e("div",{children:[e("div",{className:"flex justify-between mb-1",children:[e("span",{className:"font-medium",children:"Process Memory:"}),e("div",{children:[e("span",{className:"inline-block px-2 py-0.5 mr-1 text-xs rounded bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:["LightNVR: ",n(l)]}),e("span",{className:"inline-block px-2 py-0.5 text-xs rounded bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:["go2rtc: ",n(o)]})]})]}),e("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[e("span",{children:["Combined: ",n(s)," / ",n(i)]}),e("span",{children:[a,"% of total memory"]})]}),e("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 overflow-hidden",children:e("div",{className:"flex h-full",style:{width:"".concat(a,"%")},children:[e("div",{className:"bg-blue-600 h-2.5",style:{width:"".concat(d,"%")}}),e("div",{className:"bg-green-500 h-2.5",style:{width:"".concat(r,"%")}})]})})]}),e("div",{children:[e("div",{className:"flex justify-between mb-1",children:[e("span",{className:"font-medium",children:"System Memory:"}),e("span",{children:[(h=t.systemMemory)!=null&&h.used?n(t.systemMemory.used):"0"," /",(m=t.systemMemory)!=null&&m.total?n(t.systemMemory.total):"0"]})]}),e("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:e("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat((S=t.systemMemory)!=null&&S.total?(t.systemMemory.used/t.systemMemory.total*100).toFixed(1):0,"%")}})})]}),e("div",{children:[e("div",{className:"flex justify-between mb-1",children:[e("span",{className:"font-medium",children:"LightNVR Storage:"}),e("span",{children:[(p=t.disk)!=null&&p.used?n(t.disk.used):"0"," /",(C=t.disk)!=null&&C.total?n(t.disk.total):"0"]})]}),e("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:e("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(($=t.disk)!=null&&$.total?(t.disk.used/t.disk.total*100).toFixed(1):0,"%")}})})]}),e("div",{children:[e("div",{className:"flex justify-between mb-1",children:[e("span",{className:"font-medium",children:"System Storage:"}),e("span",{children:[(W=t.systemDisk)!=null&&W.used?n(t.systemDisk.used):"0"," /",(L=t.systemDisk)!=null&&L.total?n(t.systemDisk.total):"0"]})]}),e("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:e("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat((M=t.systemDisk)!=null&&M.total?(t.systemDisk.used/t.systemDisk.total*100).toFixed(1):0,"%")}})})]})]})]})}function te({systemInfo:t,formatBytes:n}){var d;if(!t.streamStorage||!Array.isArray(t.streamStorage)||t.streamStorage.length===0)return e("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Stream Storage"}),e("div",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No stream storage information available"})]});const l=t.streamStorage.reduce((r,c)=>r+c.size,0),o=((d=t.disk)==null?void 0:d.total)||0,i=o?(l/o*100).toFixed(1):0,s=t.streamStorage.map(r=>({name:r.name,size:r.size,count:r.count,slicePercent:l?(r.size/l*100).toFixed(1):0}));s.sort((r,c)=>c.size-r.size);const a=["bg-blue-600","bg-green-500","bg-yellow-500","bg-red-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500"];return e("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Stream Storage"}),e("div",{className:"space-y-4",children:e("div",{children:[e("div",{className:"flex justify-between mb-1",children:[e("span",{className:"font-medium",children:"Storage per Stream:"}),e("div",{className:"flex flex-wrap justify-end gap-1",children:s.map((r,c)=>e("span",{className:"inline-block px-2 py-0.5 text-xs rounded ".concat(a[c%a.length].replace("bg-","bg-opacity-20 bg-")," ").concat(a[c%a.length].replace("bg-","text-")),children:[r.name,": ",n(r.size)]},r.name))})]}),e("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[e("span",{children:["Combined: ",n(l)," / ",n(o)]}),e("span",{children:[i,"% of total storage"]})]}),e("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 overflow-hidden",children:e("div",{className:"flex h-full",style:{width:"".concat(i,"%")},children:s.map((r,c)=>e("div",{className:"".concat(a[c%a.length]," h-2.5"),style:{width:"".concat(r.slicePercent,"%")}},r.name))})}),e("div",{className:"mt-4",children:[e("h4",{className:"font-medium mb-2",children:"Stream Details:"}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:s.map((r,c)=>e("a",{href:"recordings.html?stream=".concat(encodeURIComponent(r.name)),className:"flex items-center p-2 rounded bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:[e("div",{className:"w-3 h-3 rounded-full mr-2 ".concat(a[c%a.length])}),e("div",{children:[e("div",{className:"font-medium",children:r.name}),e("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n(r.size)," (",r.slicePercent,"%) â€¢ ",r.count," recordings"]})]})]},r.name))})]})]})})]})}function ne({systemInfo:t}){var n,l;return e("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Network Interfaces"}),e("div",{className:"space-y-2",children:(l=(n=t.network)==null?void 0:n.interfaces)!=null&&l.length?t.network.interfaces.map(o=>e("div",{className:"mb-2 pb-2 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[e("div",{className:"flex justify-between",children:[e("span",{className:"font-medium",children:[o.name,":"]}),e("span",{children:o.address||"No IP"})]}),e("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["MAC: ",o.mac||"Unknown"," | ",o.up?"Up":"Down"]})]},o.name)):e("div",{className:"text-gray-500 dark:text-gray-400",children:"No network interfaces found"})})]})}function se({systemInfo:t,formatBytes:n}){var l,o,i,s;return e("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e("h3",{className:"text-lg font-semibold mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:"Streams & Recordings"}),e("div",{className:"space-y-2",children:[e("div",{className:"flex justify-between",children:[e("span",{className:"font-medium",children:"Active Streams:"}),e("span",{children:[((l=t.streams)==null?void 0:l.active)||0," / ",((o=t.streams)==null?void 0:o.total)||0]})]}),e("div",{className:"flex justify-between",children:[e("span",{className:"font-medium",children:"Recordings:"}),e("span",{children:((i=t.recordings)==null?void 0:i.count)||0})]}),e("div",{className:"flex justify-between",children:[e("span",{className:"font-medium",children:"Recordings Size:"}),e("span",{children:(s=t.recordings)!=null&&s.size?n(t.recordings.size):"0"})]})]})]})}function re(t){if(t==null)return e("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:"UNKNOWN"});const n=String(t).toLowerCase().trim();if(n==="error"||n==="err")return e("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"ERROR"});if(n==="warning"||n==="warn")return e("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"WARN"});if(n==="info")return e("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"INFO"});if(n==="debug"||n==="dbg")return e("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:"DEBUG"});{const l=String(t).toUpperCase();return e("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:l})}}function oe({logs:t,logLevel:n,logCount:l,setLogLevel:o,setLogCount:i,loadLogs:s,clearLogs:a}){return e("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-4",children:[e("div",{className:"flex justify-between items-center mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:[e("h3",{className:"text-lg font-semibold",children:"System Logs"}),e("div",{className:"flex space-x-2",children:[e("select",{id:"log-level",className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:n,onChange:d=>{const r=d.target.value;console.log("LogsView: Log level changed from ".concat(n," to ").concat(r)),o(r)},children:[e("option",{value:"error",children:"Error"}),e("option",{value:"warning",children:"Warning"}),e("option",{value:"info",children:"Info"}),e("option",{value:"debug",children:"Debug"})]}),e("select",{id:"log-count",className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:l,onChange:d=>i(parseInt(d.target.value,10)),children:[e("option",{value:"50",children:"50 lines"}),e("option",{value:"100",children:"100 lines"}),e("option",{value:"200",children:"200 lines"}),e("option",{value:"500",children:"500 lines"})]}),e("button",{id:"refresh-logs-btn",className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",onClick:s,children:"Refresh"}),e("button",{id:"clear-logs-btn",className:"px-3 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",onClick:a,children:"Clear Logs"})]})]}),e("div",{className:"logs-container bg-gray-100 dark:bg-gray-900 rounded p-4 overflow-auto max-h-96 font-mono text-sm",children:t.length===0?e("div",{className:"text-gray-500 dark:text-gray-400",children:"No logs found"}):t.map((d,r)=>e("div",{className:"log-entry mb-1 last:mb-0",children:[e("span",{className:"text-gray-500 dark:text-gray-400",children:d.timestamp}),e("span",{className:"mx-2",children:re(d.level)}),e("span",{className:"log-message ".concat(d.level==="error"?"text-red-600 dark:text-red-400":""),children:d.message})]},r))})]})}function R(t,n=1){if(t===0)return"0 Bytes";const l=1024,o=n<0?0:n,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(t)/Math.log(l));return parseFloat((t/Math.pow(l,s)).toFixed(o))+" "+i[s]}function le(t){const n=Math.floor(t/86400),l=Math.floor(t%86400/3600),o=Math.floor(t%3600/60),i=Math.floor(t%60);let s="";return n>0&&(s+="".concat(n,"d ")),(l>0||n>0)&&(s+="".concat(l,"h ")),(o>0||l>0||n>0)&&(s+="".concat(o,"m ")),s+="".concat(i,"s"),s}function ie(t,n){if(String(n||"").toLowerCase()==="debug")return!0;let l=2,o=2;const i=String(t||"").toLowerCase(),s=String(n||"").toLowerCase();return i==="error"?l=0:i==="warning"||i==="warn"?l=1:i==="info"?l=2:i==="debug"&&(l=3),s==="error"?o=0:s==="warning"||s==="warn"?o=1:s==="info"?o=2:s==="debug"&&(o=3),l<=o}function ae({logLevel:t,logCount:n,onLogsReceived:l}){const[o,i]=v(!1),s=D(null),a=D(null);w(()=>{const r=localStorage.getItem("lastLogTimestamp");r&&(console.log("Loaded last log timestamp from localStorage:",r),a.current=r)},[]);const d=()=>{if(!window.wsClient){console.log("WebSocket client not available, will retry on next poll");return}if(!window.wsClient.isConnected()){console.log("WebSocket not connected, attempting to connect"),window.wsClient.connect();return}if(!document.getElementById("system-page")){console.log("Not on system page, skipping log fetch");return}console.log("Fetching logs via WebSocket with level: debug (to get all logs, will filter on frontend)");const r={level:"debug",count:n};a.current&&(r.last_timestamp=a.current),window.wsClient.getClientId&&(r.client_id=window.wsClient.getClientId()),console.log("Sending fetch request with payload:",r);try{window.wsClient.send("fetch","system/logs",r)?console.log("Fetch request sent successfully"):console.warn("Failed to send fetch request, will retry on next poll")}catch(c){console.error("Error sending fetch request:",c)}};return w(()=>{if(window.wsClient)return r();{console.log("WebSocket client not available, will check again later");const c=setInterval(()=>{window.wsClient&&(console.log("WebSocket client now available, setting up handlers"),clearInterval(c),r())},1e3);return()=>{clearInterval(c)}}function r(){console.log("Setting up WebSocket handlers for logs");const c=u=>{if(console.log("Received logs update via WebSocket:",u),!document.getElementById("system-page")){console.log("Not on system page, ignoring log update");return}if(u&&u.logs&&Array.isArray(u.logs)){const f=u.logs.map(h=>{const m={timestamp:h.timestamp||"Unknown",level:h.level||"info",message:h.message||""};return m.level&&(m.level=m.level.toLowerCase()),m.level==="warn"&&(m.level="warning"),m});u.latest_timestamp&&(a.current=u.latest_timestamp,localStorage.setItem("lastLogTimestamp",u.latest_timestamp),console.log("Updated and saved last log timestamp:",u.latest_timestamp)),f.length>0?(console.log("Received ".concat(f.length," logs via WebSocket")),f.sort((h,m)=>new Date(m.timestamp)-new Date(h.timestamp)),l(f)):console.log("No logs received via WebSocket")}};return console.log("Registering handler for system/logs via WebSocket (once on mount)"),window.wsClient.on("update","system/logs",c),()=>{console.log("Unregistering handler for system/logs via WebSocket (component unmounting)"),window.wsClient.off("update","system/logs"),s.current&&(clearInterval(s.current),s.current=null)}}},[]),w(()=>{if(o&&!s.current){if(console.log("Starting log polling"),window.wsClient&&typeof window.wsClient.subscribe=="function"){console.log("Subscribing to system/logs via WebSocket for polling");const r={level:"debug",...a.current?{since:a.current}:{}};window.wsClient.subscribe("system/logs",r),console.log("Subscribed to system/logs with level: debug and last_timestamp: ".concat(a.current||"NULL"))}d(),console.log("Setting up polling interval for logs (every 5 seconds)"),s.current=setInterval(()=>{console.log("Polling interval triggered, fetching logs..."),d()},5e3)}else!o&&s.current&&(console.log("Stopping log polling"),window.wsClient&&typeof window.wsClient.unsubscribe=="function"&&(console.log("Unsubscribing from system/logs via WebSocket"),window.wsClient.unsubscribe("system/logs")),clearInterval(s.current),s.current=null);return()=>{s.current&&(clearInterval(s.current),s.current=null),window.wsClient&&typeof window.wsClient.unsubscribe=="function"&&(console.log("Unsubscribing from system/logs via WebSocket on cleanup"),window.wsClient.unsubscribe("system/logs"))}},[o,t]),w(()=>{const r=()=>{console.log("Received refresh-logs-websocket event, triggering fetch"),d()};return window.addEventListener("refresh-logs-websocket",r),()=>{window.removeEventListener("refresh-logs-websocket",r)}},[]),w(()=>(console.log("LogsPoller: Setting up polling with log level ".concat(t)),i(!1),setTimeout(()=>{i(!0)},100),()=>{console.log("LogsPoller: Cleaning up on unmount"),i(!1)}),[t,n]),null}function ce(){const[t,n]=v({version:"",uptime:"",cpu:{model:"",cores:0,usage:0},memory:{total:0,used:0,free:0},go2rtcMemory:{total:0,used:0,free:0},systemMemory:{total:0,used:0,free:0},disk:{total:0,used:0,free:0},systemDisk:{total:0,used:0,free:0},network:{interfaces:[]},streams:{active:0,total:0},recordings:{count:0,size:0}}),[l,o]=v([]),[i,s]=v("debug"),a=D("debug"),[d,r]=v(100),[c,u]=v(!1),[f,h]=v(!1),[m,S]=v(!1),{data:p,isLoading:C,error:$,refetch:W}=H(["systemInfo"],"/api/system/info",{timeout:15e3,retries:2,retryDelay:1e3}),L=E({mutationKey:["clearLogs"],mutationFn:async()=>await P("/api/system/logs/clear",{method:"POST",timeout:1e4,retries:1}),onSuccess:()=>{y("Logs cleared successfully"),o([])},onError:g=>{console.error("Error clearing logs:",g),y("Error clearing logs: ".concat(g.message))}}),M=g=>{console.log("SystemView: Setting log level from ".concat(i," to ").concat(g)),s(g),a.current=g},_=g=>{console.log("SystemView received new logs:",g.length);const U=a.current,N=g.filter(k=>ie(k.level,U));o(N)};w(()=>{p&&S(!0)},[p]);const O=E({mutationFn:async()=>await P("/api/system/restart",{method:"POST",timeout:3e4,retries:0}),onMutate:()=>{u(!0),y("Restarting system...")},onSuccess:()=>{y("System is restarting. Please wait..."),setTimeout(()=>{window.location.reload()},1e4)},onError:g=>{console.error("Error restarting system:",g),y("Error restarting system: ".concat(g.message)),u(!1)}}),T=E({mutationFn:async()=>await P("/api/system/shutdown",{method:"POST",timeout:3e4,retries:0}),onMutate:()=>{h(!0),y("Shutting down system...")},onSuccess:()=>{y("System is shutting down. You will need to manually restart it.")},onError:g=>{console.error("Error shutting down system:",g),y("Error shutting down system: ".concat(g.message)),h(!1)}});w(()=>{p&&n(p)},[p]),w(()=>()=>{window.wsClient&&typeof window.wsClient.unsubscribe=="function"&&(console.log("Cleaning up any WebSocket subscriptions on unmount"),window.wsClient.unsubscribe("system/logs"))},[]);const A=()=>{confirm("Are you sure you want to clear all logs?")&&L.mutate()},V=()=>{confirm("Are you sure you want to restart the system?")&&O.mutate()},q=()=>{confirm("Are you sure you want to shut down the system?")&&T.mutate()};return w(()=>{if(typeof z<"u"){if(window.wsClient=new z,console.log("WebSocket client initialized at application level"),window.wsClient){console.log("Initial WebSocket connection state:",{connected:window.wsClient.isConnected(),clientId:window.wsClient.getClientId()});const g=window.wsClient.connect;window.wsClient.connect=function(){const N=g.apply(this,arguments);if(this.socket){const k=this.socket.onopen;this.socket.onopen=b=>{console.log("WebSocket connection opened at application level"),k&&k.call(this,b)};const x=this.socket.onerror;this.socket.onerror=b=>{console.error("WebSocket error at application level:",b),x&&x.call(this,b)};const F=this.socket.onclose;this.socket.onclose=b=>{console.log("WebSocket connection closed at application level: ".concat(b.code," ").concat(b.reason)),F&&F.call(this,b)};const j=this.socket.onmessage;this.socket.onmessage=b=>{b.data.includes('"type":"welcome"')||console.log("WebSocket message received at application level"),j&&j.call(this,b)}}return N};const U=window.wsClient.handleMessage;window.wsClient.handleMessage=function(N){const k=this.clientId;U.call(this,N);const x=this.clientId;k!==x&&x&&console.log("WebSocket client ID changed at application level: ".concat(x))}}}else console.log("WebSocketClient is not defined, cannot initialize WebSocket client")},[]),e("section",{id:"system-page",className:"page",children:[e(Z,{restartSystem:V,shutdownSystem:q,isRestarting:c,isShuttingDown:f}),e(G,{isLoading:C,hasData:m,loadingMessage:"Loading system information...",emptyMessage:"System information not available. Please try again later.",children:[e("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e(X,{systemInfo:t,formatUptime:le}),e(ee,{systemInfo:t,formatBytes:R})]}),e("div",{className:"grid grid-cols-1 gap-4 mb-4",children:e(te,{systemInfo:t,formatBytes:R})}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e(ne,{systemInfo:t}),e(se,{systemInfo:t,formatBytes:R})]}),e(oe,{logs:l,logLevel:i,logCount:d,setLogLevel:M,setLogCount:r,loadLogs:()=>{if(window.wsClient&&window.wsClient.isConnected()){console.log("Manually triggering WebSocket fetch for logs");const g=new CustomEvent("refresh-logs-websocket");window.dispatchEvent(g)}},clearLogs:A}),e(ae,{logLevel:i,logCount:d,onLogsReceived:_})]})]})}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("main-content");t&&B(e(Q,{client:I,children:[e(Y,{}),e(K,{}),e(ce,{}),e(J,{})]}),t)});export{de as __vite_legacy_guard};
//# sourceMappingURL=system-CDBqWhdd.js.map
