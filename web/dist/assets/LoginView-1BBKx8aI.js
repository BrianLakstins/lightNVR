const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./preact-app-BgFzbx9V.js","./preact-app-BxuTjwGD.css"])))=>i.map(i=>d[i]);
var f=Object.freeze,v=Object.defineProperty;var i=(e,r)=>f(v(e,"raw",{value:f(r||e.slice())}));import{d as s,A as k,h as d,_ as I}from"./preact-app-BgFzbx9V.js";import{c as L,e as P}from"./fetch-utils-GN-4zfXA.js";var h,b;function S(){const[e,r]=s(""),[o,y]=s(""),[u,l]=s(!1),[c,a]=s("");s(()=>{const t=new URLSearchParams(window.location.search);t.has("error")?a("Invalid username or password"):t.has("auth_required")&&a("Authentication required. Please log in to continue.")});const g=k(null),x=async t=>{var p;if(t.preventDefault(),!e||!o){a("Please enter both username and password");return}l(!0),g.current=L();const m=btoa("".concat(e,":").concat(o));localStorage.setItem("auth",m);try{const n=await P("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+m,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify({username:e,password:o}),credentials:"include",mode:"same-origin",signal:(p=g.current)==null?void 0:p.signal,timeout:5e3,retries:1,retryDelay:1e3});n.ok||n.status===302?window.location.href="/index.html?t="+new Date().getTime():(l(!1),a("Invalid username or password"),localStorage.removeItem("auth"))}catch(n){console.error("Login error:",n),n.message==="Request timed out"&&localStorage.getItem("auth")?(console.log("Login request timed out, proceeding with stored credentials"),window.location.href="/index.html?t="+new Date().getTime()):localStorage.getItem("auth")?(console.log("Login API error, but proceeding with stored credentials"),window.location.href="/index.html?t="+new Date().getTime()):(l(!1),a("Login failed. Please try again."))}};return d(b||(b=i(['\n    <section id="login-page" class="page flex items-center justify-center min-h-screen">\n      <div class="login-container w-full max-w-md p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg">\n        <div class="text-center mb-8">\n          <h1 class="text-2xl font-bold">LightNVR</h1>\n          <p class="text-gray-600 dark:text-gray-400">Please sign in to continue</p>\n        </div>\n        \n        ','\n        \n        <form id="login-form" class="space-y-6" action="/api/auth/login" method="POST" onSubmit=','>\n          <div class="form-group">\n            <label for="username" class="block text-sm font-medium mb-1">Username</label>\n            <input \n              type="text" \n              id="username" \n              name="username"\n              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"\n              placeholder="Enter your username" \n              value=',"\n              onChange=",'\n              required\n              autocomplete="username"\n            />\n          </div>\n          <div class="form-group">\n            <label for="password" class="block text-sm font-medium mb-1">Password</label>\n            <input \n              type="password" \n              id="password" \n              name="password"\n              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"\n              placeholder="Enter your password" \n              value=',"\n              onChange=",'\n              required\n              autocomplete="current-password"\n            />\n          </div>\n          <div class="form-group">\n            <button \n              type="submit" \n              class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"\n              disabled=',"\n            >\n              ",'\n            </button>\n          </div>\n        </form>\n        \n        <div class="mt-6 text-center text-sm text-gray-600 dark:text-gray-400">\n          <p>Default credentials: admin / admin</p>\n          <p class="mt-2">You can change these in Settings after login</p>\n        </div>\n      </div>\n    </section>\n  '])),c&&d(h||(h=i(['\n          <div class="mb-4 p-3 bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200 rounded-lg">\n            ',"\n          </div>\n        "])),c),x,e,t=>r(t.target.value),o,t=>y(t.target.value),u,u?"Signing in...":"Sign In")}var w;function R(){const e=document.getElementById("main-content");e&&I(async()=>{const{render:r}=await import("./preact-app-BgFzbx9V.js").then(o=>o.p);return{render:r}},__vite__mapDeps([0,1]),import.meta.url).then(({render:r})=>{r(d(w||(w=i(["<"," />"])),S),e)})}export{S as LoginView,R as loadLoginView};
//# sourceMappingURL=LoginView-1BBKx8aI.js.map
