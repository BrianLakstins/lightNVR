{"version":3,"file":"users-BCSq-HYc.js","sources":["../../js/components/preact/users/UserRoles.js","../../js/components/preact/users/UsersTable.jsx","../../js/components/preact/users/AddUserModal.jsx","../../js/components/preact/users/EditUserModal.jsx","../../js/components/preact/users/DeleteUserModal.jsx","../../js/components/preact/users/ApiKeyModal.jsx","../../js/components/preact/UsersView.jsx","../../js/pages/users-page.jsx"],"sourcesContent":["/**\n * User role definitions\n */\nexport const USER_ROLES = {\n  0: 'Admin',\n  1: 'User',\n  2: 'Viewer',\n  3: 'API'\n};\n","/**\n * Users Table Component\n */\n\nimport { h } from 'preact';\nimport { USER_ROLES } from './UserRoles.js';\n\n/**\n * Users Table Component\n * @param {Object} props - Component props\n * @param {Array} props.users - List of users to display\n * @param {Function} props.onEdit - Function to handle edit action\n * @param {Function} props.onDelete - Function to handle delete action\n * @param {Function} props.onApiKey - Function to handle API key action\n * @returns {JSX.Element} Users table\n */\nexport function UsersTable({ users, onEdit, onDelete, onApiKey }) {\n  // Create direct handlers for each button\n  const handleEdit = (user, e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    onEdit(user);\n  };\n\n  const handleDelete = (user, e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    onDelete(user);\n  };\n\n  const handleApiKey = (user, e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    onApiKey(user);\n  };\n\n  return (\n    <div className=\"overflow-x-auto\">\n      <table className=\"w-full border-collapse\">\n        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n          <tr>\n            <th className=\"py-3 px-6 text-left font-semibold\">ID</th>\n            <th className=\"py-3 px-6 text-left font-semibold\">Username</th>\n            <th className=\"py-3 px-6 text-left font-semibold\">Email</th>\n            <th className=\"py-3 px-6 text-left font-semibold\">Role</th>\n            <th className=\"py-3 px-6 text-left font-semibold\">Status</th>\n            <th className=\"py-3 px-6 text-left font-semibold\">Last Login</th>\n            <th className=\"py-3 px-6 text-left font-semibold\">Actions</th>\n          </tr>\n        </thead>\n        <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700\">\n          {users.map(user => (\n            <tr key={user.id} className=\"hover:bg-gray-100 dark:hover:bg-gray-600\">\n              <td className=\"py-3 px-6 border-b border-gray-200 dark:border-gray-700\">{user.id}</td>\n              <td className=\"py-3 px-6 border-b border-gray-200 dark:border-gray-700\">{user.username}</td>\n              <td className=\"py-3 px-6 border-b border-gray-200 dark:border-gray-700\">{user.email || '-'}</td>\n              <td className=\"py-3 px-6 border-b border-gray-200 dark:border-gray-700\">{USER_ROLES[user.role] || 'Unknown'}</td>\n              <td className=\"py-3 px-6 border-b border-gray-200 dark:border-gray-700\">\n                <span className={`inline-block px-2 py-1 text-xs font-semibold rounded-full ${user.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\n                  {user.is_active ? 'Active' : 'Inactive'}\n                </span>\n              </td>\n              <td className=\"py-3 px-6 border-b border-gray-200 dark:border-gray-700\">{user.last_login ? new Date(user.last_login * 1000).toLocaleString() : 'Never'}</td>\n              <td className=\"py-3 px-6 border-b border-gray-200 dark:border-gray-700\">\n                <div className=\"flex space-x-2\">\n                  <button\n                    className=\"p-1 text-blue-600 hover:text-blue-800 rounded hover:bg-blue-100 transition-colors\"\n                    onClick={(e) => handleEdit(user, e)}\n                    title=\"Edit User\"\n                  >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n                    </svg>\n                  </button>\n                  <button\n                    className=\"p-1 text-red-600 hover:text-red-800 rounded hover:bg-red-100 transition-colors\"\n                    onClick={(e) => handleDelete(user, e)}\n                    title=\"Delete User\"\n                  >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                    </svg>\n                  </button>\n                  <button\n                    className=\"p-1 text-gray-600 hover:text-gray-800 rounded hover:bg-gray-100 transition-colors\"\n                    onClick={(e) => handleApiKey(user, e)}\n                    title=\"Manage API Key\"\n                  >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\" />\n                    </svg>\n                  </button>\n                </div>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","/**\n * Add User Modal Component\n */\n\nimport { h } from 'preact';\nimport { USER_ROLES } from './UserRoles.js';\n\n/**\n * Add User Modal Component\n * @param {Object} props - Component props\n * @param {Object} props.formData - Form data for adding a user\n * @param {Function} props.handleInputChange - Function to handle input changes\n * @param {Function} props.handleAddUser - Function to handle user addition\n * @param {Function} props.onClose - Function to close the modal\n * @returns {JSX.Element} Add user modal\n */\nexport function AddUserModal({ formData, handleInputChange, handleAddUser, onClose }) {\n  // Direct submit handler\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    e.stopPropagation(); // Stop event from bubbling up\n    handleAddUser(e);\n  };\n\n  // Stop click propagation on modal content\n  const stopPropagation = (e) => {\n    e.stopPropagation();\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50\" onClick={onClose}>\n      <div className=\"bg-white rounded-lg p-6 max-w-md w-full dark:bg-gray-800 dark:text-white\" onClick={stopPropagation}>\n        <h2 className=\"text-xl font-bold mb-4\">Add New User</h2>\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-bold mb-2\" htmlFor=\"username\">\n              Username\n            </label>\n            <input\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              id=\"username\"\n              type=\"text\"\n              name=\"username\"\n              value={formData.username}\n              onChange={handleInputChange}\n              required\n            />\n          </div>\n\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-bold mb-2\" htmlFor=\"password\">\n              Password\n            </label>\n            <input\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              id=\"password\"\n              type=\"password\"\n              name=\"password\"\n              value={formData.password}\n              onChange={handleInputChange}\n              required\n            />\n          </div>\n\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-bold mb-2\" htmlFor=\"email\">\n              Email\n            </label>\n            <input\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              id=\"email\"\n              type=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleInputChange}\n            />\n          </div>\n\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-bold mb-2\" htmlFor=\"role\">\n              Role\n            </label>\n            <select\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              id=\"role\"\n              name=\"role\"\n              value={formData.role}\n              onChange={handleInputChange}\n            >\n              {Object.entries(USER_ROLES).map(([value, label]) => (\n                <option key={value} value={value}>{label}</option>\n              ))}\n            </select>\n          </div>\n\n          <div className=\"mb-6\">\n            <label className=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                name=\"is_active\"\n                checked={formData.is_active}\n                onChange={handleInputChange}\n                className=\"mr-2\"\n              />\n              <span className=\"text-sm font-bold\">Active</span>\n            </label>\n          </div>\n\n          <div className=\"flex justify-end mt-6\">\n            <button\n              type=\"button\"\n              className=\"px-4 py-2 bg-gray-300 text-gray-800 dark:bg-gray-600 dark:text-white rounded hover:bg-gray-400 dark:hover:bg-gray-500 mr-2\"\n              onClick={onClose}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n            >\n              Add User\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","/**\n * Edit User Modal Component\n */\n\nimport { h } from 'preact';\nimport { USER_ROLES } from './UserRoles.js';\n\n/**\n * Edit User Modal Component\n * @param {Object} props - Component props\n * @param {Object} props.currentUser - Current user being edited\n * @param {Object} props.formData - Form data for editing a user\n * @param {Function} props.handleInputChange - Function to handle input changes\n * @param {Function} props.handleEditUser - Function to handle user editing\n * @param {Function} props.onClose - Function to close the modal\n * @returns {JSX.Element} Edit user modal\n */\nexport function EditUserModal({ currentUser, formData, handleInputChange, handleEditUser, onClose }) {\n  // Direct submit handler\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    e.stopPropagation(); // Stop event from bubbling up\n    handleEditUser(e);\n  };\n\n  // Stop click propagation on modal content\n  const stopPropagation = (e) => {\n    e.stopPropagation();\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50\" onClick={onClose}>\n      <div className=\"bg-white rounded-lg p-6 max-w-md w-full dark:bg-gray-800 dark:text-white\" onClick={stopPropagation}>\n        <h2 className=\"text-xl font-bold mb-4\">Edit User: {currentUser.username}</h2>\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-bold mb-2\" htmlFor=\"username\">\n              Username\n            </label>\n            <input\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              id=\"username\"\n              type=\"text\"\n              name=\"username\"\n              value={formData.username}\n              onChange={handleInputChange}\n              required\n            />\n          </div>\n\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-bold mb-2\" htmlFor=\"password\">\n              Password (leave blank to keep current)\n            </label>\n            <input\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              id=\"password\"\n              type=\"password\"\n              name=\"password\"\n              value={formData.password}\n              onChange={handleInputChange}\n            />\n          </div>\n\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-bold mb-2\" htmlFor=\"email\">\n              Email\n            </label>\n            <input\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              id=\"email\"\n              type=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleInputChange}\n            />\n          </div>\n\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-bold mb-2\" htmlFor=\"role\">\n              Role\n            </label>\n            <select\n              className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n              id=\"role\"\n              name=\"role\"\n              value={formData.role}\n              onChange={handleInputChange}\n            >\n              {Object.entries(USER_ROLES).map(([value, label]) => (\n                <option key={value} value={value}>{label}</option>\n              ))}\n            </select>\n          </div>\n\n          <div className=\"mb-6\">\n            <label className=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                name=\"is_active\"\n                checked={formData.is_active}\n                onChange={handleInputChange}\n                className=\"mr-2\"\n              />\n              <span className=\"text-sm font-bold\">Active</span>\n            </label>\n          </div>\n\n          <div className=\"flex justify-end mt-6\">\n            <button\n              type=\"button\"\n              className=\"px-4 py-2 bg-gray-300 text-gray-800 dark:bg-gray-600 dark:text-white rounded hover:bg-gray-400 dark:hover:bg-gray-500 mr-2\"\n              onClick={onClose}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n            >\n              Update User\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","/**\n * Delete User Modal Component\n */\n\nimport { h } from 'preact';\n\n/**\n * Delete User Modal Component\n * @param {Object} props - Component props\n * @param {Object} props.currentUser - Current user being deleted\n * @param {Function} props.handleDeleteUser - Function to handle user deletion\n * @param {Function} props.onClose - Function to close the modal\n * @returns {JSX.Element} Delete user modal\n */\nexport function DeleteUserModal({ currentUser, handleDeleteUser, onClose }) {\n  // Direct delete handler\n  const handleDeleteClick = (e) => {\n    e.stopPropagation(); // Stop event from bubbling up\n    handleDeleteUser();\n  };\n\n  // Stop click propagation on modal content\n  const stopPropagation = (e) => {\n    e.stopPropagation();\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50\" onClick={onClose}>\n      <div className=\"bg-white rounded-lg p-6 max-w-md w-full dark:bg-gray-800 dark:text-white\" onClick={stopPropagation}>\n        <h2 className=\"text-xl font-bold mb-4\">Delete User</h2>\n\n        <p className=\"mb-6\">\n          Are you sure you want to delete the user \"{currentUser.username}\"? This action cannot be undone.\n        </p>\n\n        <div className=\"flex justify-end\">\n          <button\n            className=\"px-4 py-2 bg-gray-300 text-gray-800 dark:bg-gray-600 dark:text-white rounded hover:bg-gray-400 dark:hover:bg-gray-500 mr-2\"\n            onClick={onClose}\n          >\n            Cancel\n          </button>\n          <button\n            className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\n            onClick={handleDeleteClick}\n          >\n            Delete User\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * API Key Modal Component\n */\n\nimport { h } from 'preact';\n\n/**\n * API Key Modal Component\n * @param {Object} props - Component props\n * @param {Object} props.currentUser - Current user for API key generation\n * @param {string} props.newApiKey - Newly generated API key\n * @param {Function} props.handleGenerateApiKey - Function to handle API key generation\n * @param {Function} props.copyApiKey - Function to copy API key to clipboard\n * @param {Function} props.onClose - Function to close the modal\n * @returns {JSX.Element} API key modal\n */\nexport function ApiKeyModal({ currentUser, newApiKey, handleGenerateApiKey, copyApiKey, onClose }) {\n  // Stop click propagation on modal content\n  const stopPropagation = (e) => {\n    e.stopPropagation();\n  };\n\n  // Log the API key for debugging\n  console.log('API Key Modal - newApiKey:', newApiKey);\n\n  // Create a custom close handler that prevents closing if an API key is displayed\n  const handleClose = (e) => {\n    // If we have an API key, prevent closing when clicking outside\n    if (newApiKey && newApiKey !== 'Generating...') {\n      // Only allow closing via the close button\n      return;\n    }\n    // Otherwise, proceed with normal close\n    onClose(e);\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50\" onClick={handleClose}>\n      <div className=\"bg-white rounded-lg p-6 max-w-md w-full dark:bg-gray-800 dark:text-white\" onClick={stopPropagation}>\n        <h2 className=\"text-xl font-bold mb-4\">API Key for {currentUser.username}</h2>\n\n        <div className=\"mb-6\">\n          {newApiKey ? (\n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-bold mb-2\">\n                API Key\n              </label>\n              <div className=\"flex\">\n                <input\n                  className=\"shadow appearance-none border rounded-l w-full py-2 px-3 text-gray-700 dark:text-white dark:bg-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                  type=\"text\"\n                  value={newApiKey}\n                  readOnly\n                />\n                <button\n                  className=\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-r\"\n                  onClick={copyApiKey}\n                >\n                  Copy\n                </button>\n              </div>\n              <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-2\">\n                This key will only be shown once. Save it securely.\n              </p>\n            </div>\n          ) : (\n            <>\n              <p className=\"mb-4\">\n                Generate a new API key for this user. This will invalidate any existing API key.\n              </p>\n              <button\n                className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mb-4\"\n                onClick={handleGenerateApiKey}\n              >\n                Generate New API Key\n              </button>\n            </>\n          )}\n        </div>\n\n        <div className=\"flex justify-end\">\n          <button\n            className={newApiKey && newApiKey !== 'Generating...' ? 'px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700' : 'px-4 py-2 bg-gray-300 text-gray-800 dark:bg-gray-600 dark:text-white rounded hover:bg-gray-400 dark:hover:bg-gray-500'}\n            onClick={onClose}\n          >\n            {newApiKey && newApiKey !== 'Generating...' ? 'Done' : 'Close'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * LightNVR Web Interface Users View Component\n * Preact component for the user management page\n */\n\nimport { useState, useCallback } from 'preact/hooks';\nimport { showStatusMessage } from './ToastContainer.jsx';\nimport { useQuery, useMutation, fetchJSON } from '../../query-client.js';\n\n// Import user components\nimport { USER_ROLES } from './users/UserRoles.js';\nimport { UsersTable } from './users/UsersTable.jsx';\nimport { AddUserModal } from './users/AddUserModal.jsx';\nimport { EditUserModal } from './users/EditUserModal.jsx';\nimport { DeleteUserModal } from './users/DeleteUserModal.jsx';\nimport { ApiKeyModal } from './users/ApiKeyModal.jsx';\n\n/**\n * UsersView component\n * @returns {JSX.Element} UsersView component\n */\nexport function UsersView() {\n  // State for modal visibility\n  const [activeModal, setActiveModal] = useState(null); // 'add', 'edit', 'delete', 'apiKey', or null\n\n  // State for selected user and API key\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [apiKey, setApiKey] = useState('');\n\n  // Form state for adding/editing users\n  const [formData, setFormData] = useState({\n    username: '',\n    password: '',\n    email: '',\n    role: 1,\n    is_active: true\n  });\n\n  /**\n   * Get auth headers for requests\n   * @returns {Object} Headers object with Authorization if available\n   */\n  const getAuthHeaders = useCallback(() => {\n    const auth = localStorage.getItem('auth');\n    return auth ? { 'Authorization': 'Basic ' + auth } : {};\n  }, []);\n\n  // Fetch users using useQuery\n  const {\n    data: usersData,\n    isLoading: loading,\n    error,\n    refetch: refetchUsers\n  } = useQuery(\n    ['users'],\n    '/api/auth/users',\n    {\n      headers: getAuthHeaders(),\n      cache: 'no-store',\n      timeout: 15000, // 15 second timeout\n      retries: 2,     // Retry twice\n      retryDelay: 1000 // 1 second between retries\n    }\n  );\n\n  // Extract users array from response\n  const users = usersData?.users || [];\n\n  // Handler for the add user button\n  const handleAddUserClick = useCallback(() => {\n    // Reset form data for new user\n    setFormData({\n      username: '',\n      password: '',\n      email: '',\n      role: 1,\n      is_active: true\n    });\n    setActiveModal('add');\n  }, []);\n\n  /**\n   * Handle form input changes\n   * @param {Event} e - Input change event\n   */\n  const handleInputChange = useCallback((e) => {\n    const { name, value, type, checked } = e.target;\n\n    setFormData(prevData => ({\n      ...prevData,\n      [name]: type === 'checkbox' ? checked : (name === 'role' ? parseInt(value, 10) : value)\n    }));\n  }, []);\n\n  // Add user mutation\n  const addUserMutation = useMutation({\n    mutationFn: async (userData) => {\n      return await fetchJSON('/api/auth/users', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders()\n        },\n        body: JSON.stringify(userData),\n        timeout: 15000, // 15 second timeout\n        retries: 1,     // Retry once\n        retryDelay: 1000 // 1 second between retries\n      });\n    },\n    onSuccess: () => {\n      // Close modal and show success message\n      setActiveModal(null);\n      showStatusMessage('User added successfully', 'success', 5000);\n\n      // Refresh users list\n      refetchUsers();\n    },\n    onError: (error) => {\n      console.error('Error adding user:', error);\n      showStatusMessage(`Error adding user: ${error.message}`, 'error', 8000);\n    }\n  });\n\n  // Edit user mutation\n  const editUserMutation = useMutation({\n    mutationFn: async ({ userId, userData }) => {\n      return await fetchJSON(`/api/auth/users/${userId}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders()\n        },\n        body: JSON.stringify(userData),\n        timeout: 15000, // 15 second timeout\n        retries: 1,     // Retry once\n        retryDelay: 1000 // 1 second between retries\n      });\n    },\n    onSuccess: () => {\n      // Close modal and show success message\n      setActiveModal(null);\n      showStatusMessage('User updated successfully', 'success', 5000);\n\n      // Refresh users list\n      refetchUsers();\n    },\n    onError: (error) => {\n      console.error('Error updating user:', error);\n      showStatusMessage(`Error updating user: ${error.message}`, 'error', 8000);\n    }\n  });\n\n  // Delete user mutation\n  const deleteUserMutation = useMutation({\n    mutationFn: async (userId) => {\n      return await fetchJSON(`/api/auth/users/${userId}`, {\n        method: 'DELETE',\n        headers: getAuthHeaders(),\n        timeout: 15000, // 15 second timeout\n        retries: 1,     // Retry once\n        retryDelay: 1000 // 1 second between retries\n      });\n    },\n    onSuccess: () => {\n      // Close modal and show success message\n      setActiveModal(null);\n      showStatusMessage('User deleted successfully', 'success', 5000);\n\n      // Refresh users list\n      refetchUsers();\n    },\n    onError: (error) => {\n      console.error('Error deleting user:', error);\n      showStatusMessage(`Error deleting user: ${error.message}`, 'error', 8000);\n    }\n  });\n\n  // Generate API key mutation\n  const generateApiKeyMutation = useMutation({\n    mutationFn: async (userId) => {\n      return await fetchJSON(`/api/auth/users/${userId}/api-key`, {\n        method: 'POST',\n        headers: getAuthHeaders(),\n        timeout: 20000, // 20 second timeout for key generation\n        retries: 1,     // Retry once\n        retryDelay: 2000 // 2 seconds between retries\n      });\n    },\n    onMutate: () => {\n      // Show loading state\n      setApiKey('Generating...');\n    },\n    onSuccess: (data) => {\n      // Set the API key and ensure the modal stays open\n      setApiKey(data.api_key);\n      showStatusMessage('API key generated successfully', 'success');\n\n      // Refresh users list without affecting the modal\n      // We'll use a separate function to avoid closing the modal\n      setTimeout(() => {\n        refetchUsers();\n      }, 100);\n    },\n    onError: (error) => {\n      console.error('Error generating API key:', error);\n      setApiKey('');\n      showStatusMessage(`Error generating API key: ${error.message}`, 'error');\n    }\n  });\n\n  /**\n   * Handle form submission for adding a user\n   * @param {Event} e - Form submit event\n   */\n  const handleAddUser = useCallback((e) => {\n    if (e) e.preventDefault();\n\n    console.log('Adding user:', formData.username);\n    addUserMutation.mutate(formData);\n  }, [formData]);\n\n  /**\n   * Handle form submission for editing a user\n   * @param {Event} e - Form submit event\n   */\n  const handleEditUser = useCallback((e) => {\n    if (e) e.preventDefault();\n\n    console.log('Editing user:', selectedUser.id, selectedUser.username);\n    editUserMutation.mutate({\n      userId: selectedUser.id,\n      userData: formData\n    });\n  }, [selectedUser, formData]);\n\n  /**\n   * Handle user deletion\n   */\n  const handleDeleteUser = useCallback(() => {\n    console.log('Deleting user:', selectedUser.id, selectedUser.username);\n    deleteUserMutation.mutate(selectedUser.id);\n  }, [selectedUser]);\n\n  /**\n   * Handle generating a new API key for a user\n   */\n  const handleGenerateApiKey = useCallback(() => {\n    console.log('Generating API key for user:', selectedUser.id, selectedUser.username);\n    generateApiKeyMutation.mutate(selectedUser.id);\n  }, [selectedUser]);\n\n  /**\n   * Copy API key to clipboard\n   */\n  const copyApiKey = useCallback(() => {\n    navigator.clipboard.writeText(apiKey)\n      .then(() => {\n        // Use global toast function if available\n        if (window.showSuccessToast) {\n          window.showSuccessToast('API key copied to clipboard');\n        } else {\n          // Fallback to standard showStatusMessage\n          showStatusMessage('API key copied to clipboard', 'success');\n        }\n      })\n      .catch((err) => {\n        console.error('Error copying API key:', err);\n\n        // Use global toast function if available\n        if (window.showErrorToast) {\n          window.showErrorToast('Failed to copy API key');\n        } else {\n          // Fallback to standard showStatusMessage\n          showStatusMessage('Failed to copy API key', 'error');\n        }\n      });\n  }, [apiKey]);\n\n  /**\n   * Open the edit modal for a user\n   * @param {Object} user - User to edit\n   */\n  const openEditModal = useCallback((user) => {\n    setSelectedUser(user);\n    setFormData({\n      username: user.username,\n      password: '', // Don't include the password in the form\n      email: user.email || '',\n      role: user.role,\n      is_active: user.is_active\n    });\n    setActiveModal('edit');\n  }, []);\n\n  /**\n   * Open the delete modal for a user\n   * @param {Object} user - User to delete\n   */\n  const openDeleteModal = useCallback((user) => {\n    setSelectedUser(user);\n    setActiveModal('delete');\n  }, []);\n\n  /**\n   * Open the API key modal for a user\n   * @param {Object} user - User to generate API key for\n   */\n  const openApiKeyModal = useCallback((user) => {\n    setSelectedUser(user);\n    setApiKey('');\n    setActiveModal('apiKey');\n  }, []);\n\n  /**\n   * Close any open modal\n   */\n  const closeModal = useCallback(() => {\n    setActiveModal(null);\n  }, []);\n\n  // Render loading state\n  if (loading && users.length === 0) {\n    return (\n      <div className=\"flex justify-center items-center p-8\">\n        <div className=\"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n        <span className=\"sr-only\">Loading...</span>\n      </div>\n    );\n  }\n\n  // Render empty state\n  if (users.length === 0 && !loading) {\n    return (\n      <div>\n        <div className=\"mb-4 flex justify-between items-center\">\n          <h2 className=\"text-xl font-semibold\">User Management</h2>\n          <button\n            className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors\"\n            onClick={handleAddUserClick}\n          >\n            Add User\n          </button>\n        </div>\n\n        <div className=\"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative mb-4\">\n          <h4 className=\"font-bold mb-2\">No Users Found</h4>\n          <p>Click the \"Add User\" button to create your first user.</p>\n        </div>\n        {activeModal === 'add' && (\n          <AddUserModal\n            formData={formData}\n            handleInputChange={handleInputChange}\n            handleAddUser={handleAddUser}\n            onClose={closeModal}\n          />\n        )}\n      </div>\n    );\n  }\n\n  // Render users table with modals\n  return (\n    <div>\n      <div className=\"mb-4 flex justify-between items-center\">\n        <h2 className=\"text-xl font-semibold\">User Management</h2>\n        <button\n          className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors\"\n          onClick={handleAddUserClick}\n        >\n          Add User\n        </button>\n      </div>\n\n      <UsersTable\n        users={users}\n        onEdit={openEditModal}\n        onDelete={openDeleteModal}\n        onApiKey={openApiKeyModal}\n      />\n\n      {activeModal === 'add' && (\n        <AddUserModal\n          formData={formData}\n          handleInputChange={handleInputChange}\n          handleAddUser={handleAddUser}\n          onClose={closeModal}\n        />\n      )}\n\n      {activeModal === 'edit' && (\n        <EditUserModal\n          currentUser={selectedUser}\n          formData={formData}\n          handleInputChange={handleInputChange}\n          handleEditUser={handleEditUser}\n          onClose={closeModal}\n        />\n      )}\n\n      {activeModal === 'delete' && (\n        <DeleteUserModal\n          currentUser={selectedUser}\n          handleDeleteUser={handleDeleteUser}\n          onClose={closeModal}\n        />\n      )}\n\n      {activeModal === 'apiKey' && (\n        <ApiKeyModal\n          currentUser={selectedUser}\n          newApiKey={apiKey}\n          handleGenerateApiKey={handleGenerateApiKey}\n          copyApiKey={copyApiKey}\n          onClose={closeModal}\n        />\n      )}\n    </div>\n  );\n}\n","/**\n * LightNVR Web Interface Users Page\n * Entry point for the users page\n */\n\nimport { render } from 'preact';\nimport { UsersView } from '../components/preact/UsersView.jsx';\nimport { QueryClientProvider, queryClient } from '../query-client.js';\nimport {Header} from \"../components/preact/Header.jsx\";\nimport {Footer} from \"../components/preact/Footer.jsx\";\nimport { ToastContainer } from \"../components/preact/ToastContainer.jsx\";\n\n// Render the UsersView component when the DOM is loaded\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Get the container element\n  const container = document.getElementById('main-content');\n\n  if (container) {\n    render(\n      <QueryClientProvider client={queryClient}>\n        <Header />\n        <ToastContainer />\n        <UsersView />\n        <Footer />\n      </QueryClientProvider>,\n      container\n    );\n  }\n});\n"],"names":["USER_ROLES","UsersTable","users","onEdit","onDelete","onApiKey","handleEdit","user","e","handleDelete","handleApiKey","jsxs","jsx","AddUserModal","formData","handleInputChange","handleAddUser","onClose","value","label","EditUserModal","currentUser","handleEditUser","handleSubmit","DeleteUserModal","handleDeleteUser","handleDeleteClick","ApiKeyModal","newApiKey","handleGenerateApiKey","copyApiKey","stopPropagation","Fragment","UsersView","activeModal","setActiveModal","useState","selectedUser","setSelectedUser","apiKey","setApiKey","setFormData","getAuthHeaders","useCallback","auth","usersData","loading","error","refetchUsers","useQuery","handleAddUserClick","name","type","checked","prevData","addUserMutation","useMutation","userData","fetchJSON","showStatusMessage","editUserMutation","userId","deleteUserMutation","generateApiKeyMutation","data","err","openEditModal","openDeleteModal","openApiKeyModal","closeModal","container","render","QueryClientProvider","queryClient","Header","ToastContainer","Footer"],"mappings":"6RAGO,MAAMA,EAAa,CACxB,EAAG,QACH,EAAG,OACH,EAAG,SACH,EAAG,KACL,ECQO,SAASC,EAAW,CAAE,MAAAC,EAAO,OAAAC,EAAQ,SAAAC,EAAU,SAAAC,GAAY,CAE1D,MAAAC,EAAa,CAACC,EAAMC,IAAM,CAC9BA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAClBL,EAAOI,CAAI,CACb,EAEME,EAAe,CAACF,EAAMC,IAAM,CAChCA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAClBJ,EAASG,CAAI,CACf,EAEMG,EAAe,CAACH,EAAMC,IAAM,CAChCA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAClBH,EAASE,CAAI,CACf,EAEA,SACG,MAAI,CAAA,UAAU,kBACb,SAACI,EAAA,QAAA,CAAM,UAAU,yBACf,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,8BACf,SAAAD,EAAC,KACC,CAAA,SAAA,CAACC,EAAA,KAAA,CAAG,UAAU,oCAAoC,SAAE,KAAA,EACnDA,EAAA,KAAA,CAAG,UAAU,oCAAoC,SAAQ,WAAA,EACzDA,EAAA,KAAA,CAAG,UAAU,oCAAoC,SAAK,QAAA,EACtDA,EAAA,KAAA,CAAG,UAAU,oCAAoC,SAAI,OAAA,EACrDA,EAAA,KAAA,CAAG,UAAU,oCAAoC,SAAM,SAAA,EACvDA,EAAA,KAAA,CAAG,UAAU,oCAAoC,SAAU,aAAA,EAC3DA,EAAA,KAAA,CAAG,UAAU,oCAAoC,SAAO,SAAA,CAAA,CAAA,CAAA,CAC3D,CACF,CAAA,EACAA,EAAC,QAAM,CAAA,UAAU,gDACd,SAAAV,EAAM,IACLK,GAAAI,EAAC,KAAiB,CAAA,UAAU,2CAC1B,SAAA,CAAAC,EAAC,KAAG,CAAA,UAAU,0DAA2D,SAAAL,EAAK,GAAG,EAChFK,EAAA,KAAA,CAAG,UAAU,0DAA2D,WAAK,SAAS,IACtF,KAAG,CAAA,UAAU,0DAA2D,SAAAL,EAAK,OAAS,IAAI,EAC3FK,EAAC,MAAG,UAAU,0DAA2D,WAAWL,EAAK,IAAI,GAAK,UAAU,IAC3G,KAAG,CAAA,UAAU,0DACZ,SAAAK,EAAC,QAAK,UAAW,6DAA6D,OAAAL,EAAK,UAAY,8BAAgC,2BAC5H,WAAK,UAAY,SAAW,UAC/B,CAAA,EACF,EACCK,EAAA,KAAA,CAAG,UAAU,0DAA2D,WAAK,WAAa,IAAI,KAAKL,EAAK,WAAa,GAAI,EAAE,eAAA,EAAmB,QAAQ,IACtJ,KAAG,CAAA,UAAU,0DACZ,SAACI,EAAA,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAC,EAAC,SAAA,CACC,UAAU,oFACV,QAAUJ,GAAMF,EAAWC,EAAMC,CAAC,EAClC,MAAM,YAEN,SAAAI,EAAC,OAAI,MAAM,6BAA6B,UAAU,UAAU,KAAK,OAAO,QAAQ,YAAY,OAAO,eACjG,SAACA,EAAA,OAAA,CAAK,cAAc,QAAQ,eAAe,QAAQ,YAAY,IAAI,EAAE,wHAAyH,CAAA,CAChM,CAAA,CAAA,CACF,EACAA,EAAC,SAAA,CACC,UAAU,iFACV,QAAUJ,GAAMC,EAAaF,EAAMC,CAAC,EACpC,MAAM,cAEN,SAAAI,EAAC,OAAI,MAAM,6BAA6B,UAAU,UAAU,KAAK,OAAO,QAAQ,YAAY,OAAO,eACjG,SAACA,EAAA,OAAA,CAAK,cAAc,QAAQ,eAAe,QAAQ,YAAY,IAAI,EAAE,8HAA+H,CAAA,CACtM,CAAA,CAAA,CACF,EACAA,EAAC,SAAA,CACC,UAAU,oFACV,QAAUJ,GAAME,EAAaH,EAAMC,CAAC,EACpC,MAAM,iBAEN,SAAAI,EAAC,OAAI,MAAM,6BAA6B,UAAU,UAAU,KAAK,OAAO,QAAQ,YAAY,OAAO,eACjG,SAACA,EAAA,OAAA,CAAK,cAAc,QAAQ,eAAe,QAAQ,YAAY,IAAI,EAAE,4HAA6H,CAAA,CACpM,CAAA,CAAA,CAAA,CACF,CAAA,CACF,CACF,CAAA,CAAA,GAzCOL,EAAK,EA0Cd,CACD,CACH,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAEJ,CCpFO,SAASM,EAAa,CAAE,SAAAC,EAAU,kBAAAC,EAAmB,cAAAC,EAAe,QAAAC,GAAW,CAclF,OAAAL,EAAC,MAAI,CAAA,UAAU,6EAA6E,QAASK,EACnG,SAAAN,EAAC,MAAI,CAAA,UAAU,2EAA2E,QANrEH,GAAM,CAC7BA,EAAE,gBAAgB,CACpB,EAKM,SAAA,CAACI,EAAA,KAAA,CAAG,UAAU,yBAAyB,SAAY,eAAA,EAEnDD,EAAC,OAAK,CAAA,SAhBUH,GAAM,CAC1BA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAClBQ,EAAcR,CAAC,CACjB,EAaQ,SAAA,CAACG,EAAA,MAAA,CAAI,UAAU,OACb,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,+BAA+B,QAAQ,WAAW,SAEnE,WAAA,EACAA,EAAC,QAAA,CACC,UAAU,8JACV,GAAG,WACH,KAAK,OACL,KAAK,WACL,MAAOE,EAAS,SAChB,SAAUC,EACV,SAAQ,EAAA,CAAA,CACV,EACF,EAEAJ,EAAC,MAAI,CAAA,UAAU,OACb,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,+BAA+B,QAAQ,WAAW,SAEnE,WAAA,EACAA,EAAC,QAAA,CACC,UAAU,8JACV,GAAG,WACH,KAAK,WACL,KAAK,WACL,MAAOE,EAAS,SAChB,SAAUC,EACV,SAAQ,EAAA,CAAA,CACV,EACF,EAEAJ,EAAC,MAAI,CAAA,UAAU,OACb,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,+BAA+B,QAAQ,QAAQ,SAEhE,QAAA,EACAA,EAAC,QAAA,CACC,UAAU,8JACV,GAAG,QACH,KAAK,QACL,KAAK,QACL,MAAOE,EAAS,MAChB,SAAUC,CAAA,CAAA,CACZ,EACF,EAEAJ,EAAC,MAAI,CAAA,UAAU,OACb,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,+BAA+B,QAAQ,OAAO,SAE/D,OAAA,EACAA,EAAC,SAAA,CACC,UAAU,8JACV,GAAG,OACH,KAAK,OACL,MAAOE,EAAS,KAChB,SAAUC,EAET,SAAO,OAAA,QAAQf,CAAU,EAAE,IAAI,CAAC,CAACkB,EAAOC,CAAK,IAC3CP,EAAA,SAAA,CAAmB,MAAAM,EAAe,SAAAC,CAAA,EAAtBD,CAA4B,CAC1C,CAAA,CAAA,CACH,EACF,IAEC,MAAI,CAAA,UAAU,OACb,SAACP,EAAA,QAAA,CAAM,UAAU,oBACf,SAAA,CAAAC,EAAC,QAAA,CACC,KAAK,WACL,KAAK,YACL,QAASE,EAAS,UAClB,SAAUC,EACV,UAAU,MAAA,CACZ,EACCH,EAAA,OAAA,CAAK,UAAU,oBAAoB,SAAM,QAAA,CAAA,CAAA,CAAA,CAC5C,CACF,CAAA,EAEAD,EAAC,MAAI,CAAA,UAAU,wBACb,SAAA,CAAAC,EAAC,SAAA,CACC,KAAK,SACL,UAAU,6HACV,QAASK,EACV,SAAA,QAAA,CAED,EACAL,EAAC,SAAA,CACC,KAAK,SACL,UAAU,6DACX,SAAA,UAAA,CAAA,CAED,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAEJ,CC/GO,SAASQ,EAAc,CAAE,YAAAC,EAAa,SAAAP,EAAU,kBAAAC,EAAmB,eAAAO,EAAgB,QAAAL,GAAW,CAE7F,MAAAM,EAAgBf,GAAM,CAC1BA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAClBc,EAAed,CAAC,CAClB,EAQE,OAAAI,EAAC,MAAI,CAAA,UAAU,6EAA6E,QAASK,EACnG,SAAAN,EAAC,MAAI,CAAA,UAAU,2EAA2E,QANrEH,GAAM,CAC7BA,EAAE,gBAAgB,CACpB,EAKM,SAAA,CAACG,EAAA,KAAA,CAAG,UAAU,yBAAyB,SAAA,CAAA,cAAYU,EAAY,QAAA,EAAS,EAExEV,EAAC,OAAK,CAAA,SAAUY,EACd,SAAA,CAACZ,EAAA,MAAA,CAAI,UAAU,OACb,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,+BAA+B,QAAQ,WAAW,SAEnE,WAAA,EACAA,EAAC,QAAA,CACC,UAAU,8JACV,GAAG,WACH,KAAK,OACL,KAAK,WACL,MAAOE,EAAS,SAChB,SAAUC,EACV,SAAQ,EAAA,CAAA,CACV,EACF,EAEAJ,EAAC,MAAI,CAAA,UAAU,OACb,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,+BAA+B,QAAQ,WAAW,SAEnE,yCAAA,EACAA,EAAC,QAAA,CACC,UAAU,8JACV,GAAG,WACH,KAAK,WACL,KAAK,WACL,MAAOE,EAAS,SAChB,SAAUC,CAAA,CAAA,CACZ,EACF,EAEAJ,EAAC,MAAI,CAAA,UAAU,OACb,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,+BAA+B,QAAQ,QAAQ,SAEhE,QAAA,EACAA,EAAC,QAAA,CACC,UAAU,8JACV,GAAG,QACH,KAAK,QACL,KAAK,QACL,MAAOE,EAAS,MAChB,SAAUC,CAAA,CAAA,CACZ,EACF,EAEAJ,EAAC,MAAI,CAAA,UAAU,OACb,SAAA,CAAAC,EAAC,QAAM,CAAA,UAAU,+BAA+B,QAAQ,OAAO,SAE/D,OAAA,EACAA,EAAC,SAAA,CACC,UAAU,8JACV,GAAG,OACH,KAAK,OACL,MAAOE,EAAS,KAChB,SAAUC,EAET,SAAO,OAAA,QAAQf,CAAU,EAAE,IAAI,CAAC,CAACkB,EAAOC,CAAK,IAC3CP,EAAA,SAAA,CAAmB,MAAAM,EAAe,SAAAC,CAAA,EAAtBD,CAA4B,CAC1C,CAAA,CAAA,CACH,EACF,IAEC,MAAI,CAAA,UAAU,OACb,SAACP,EAAA,QAAA,CAAM,UAAU,oBACf,SAAA,CAAAC,EAAC,QAAA,CACC,KAAK,WACL,KAAK,YACL,QAASE,EAAS,UAClB,SAAUC,EACV,UAAU,MAAA,CACZ,EACCH,EAAA,OAAA,CAAK,UAAU,oBAAoB,SAAM,QAAA,CAAA,CAAA,CAAA,CAC5C,CACF,CAAA,EAEAD,EAAC,MAAI,CAAA,UAAU,wBACb,SAAA,CAAAC,EAAC,SAAA,CACC,KAAK,SACL,UAAU,6HACV,QAASK,EACV,SAAA,QAAA,CAED,EACAL,EAAC,SAAA,CACC,KAAK,SACL,UAAU,6DACX,SAAA,aAAA,CAAA,CAED,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAEJ,CClHO,SAASY,EAAgB,CAAE,YAAAH,EAAa,iBAAAI,EAAkB,QAAAR,GAAW,CAEpE,MAAAS,EAAqBlB,GAAM,CAC/BA,EAAE,gBAAgB,EACDiB,EAAA,CACnB,EAQE,OAAAb,EAAC,MAAI,CAAA,UAAU,6EAA6E,QAASK,EACnG,SAAAN,EAAC,MAAI,CAAA,UAAU,2EAA2E,QANrEH,GAAM,CAC7BA,EAAE,gBAAgB,CACpB,EAKM,SAAA,CAACI,EAAA,KAAA,CAAG,UAAU,yBAAyB,SAAW,cAAA,EAElDD,EAAC,IAAE,CAAA,UAAU,OAAO,SAAA,CAAA,6CACyBU,EAAY,SAAS,kCAAA,EAClE,EAEAV,EAAC,MAAI,CAAA,UAAU,mBACb,SAAA,CAAAC,EAAC,SAAA,CACC,UAAU,6HACV,QAASK,EACV,SAAA,QAAA,CAED,EACAL,EAAC,SAAA,CACC,UAAU,2DACV,QAASc,EACV,SAAA,aAAA,CAAA,CAED,CACF,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAEJ,CCpCO,SAASC,EAAY,CAAE,YAAAN,EAAa,UAAAO,EAAW,qBAAAC,EAAsB,WAAAC,EAAY,QAAAb,GAAW,CAE3F,MAAAc,EAAmBvB,GAAM,CAC7BA,EAAE,gBAAgB,CACpB,EAGQ,eAAA,IAAI,6BAA8BoB,CAAS,EAcjDhB,EAAC,MAAI,CAAA,UAAU,6EAA6E,QAXzEJ,GAAM,CAErBoB,GAAaA,IAAc,iBAK/BX,EAAQT,CAAC,CACX,EAII,SAAAG,EAAC,MAAI,CAAA,UAAU,2EAA2E,QAASoB,EACjG,SAAA,CAACpB,EAAA,KAAA,CAAG,UAAU,yBAAyB,SAAA,CAAA,eAAaU,EAAY,QAAA,EAAS,EAEzET,EAAC,OAAI,UAAU,OACZ,WACED,EAAA,MAAA,CAAI,UAAU,OACb,SAAA,CAACC,EAAA,QAAA,CAAM,UAAU,+BAA+B,SAEhD,UAAA,EACAD,EAAC,MAAI,CAAA,UAAU,OACb,SAAA,CAAAC,EAAC,QAAA,CACC,UAAU,gKACV,KAAK,OACL,MAAOgB,EACP,SAAQ,EAAA,CACV,EACAhB,EAAC,SAAA,CACC,UAAU,yEACV,QAASkB,EACV,SAAA,MAAA,CAAA,CAED,EACF,EACClB,EAAA,IAAA,CAAE,UAAU,gDAAgD,SAE7D,qDAAA,CAAA,CAAA,CAAA,CACF,EAGED,EAAAqB,EAAA,CAAA,SAAA,CAACpB,EAAA,IAAA,CAAE,UAAU,OAAO,SAEpB,mFAAA,EACAA,EAAC,SAAA,CACC,UAAU,mFACV,QAASiB,EACV,SAAA,sBAAA,CAAA,CAED,CAAA,CACF,CAEJ,CAAA,EAEAjB,EAAC,MAAI,CAAA,UAAU,mBACb,SAAAA,EAAC,SAAA,CACC,UAAWgB,GAAaA,IAAc,gBAAkB,6DAA+D,wHACvH,QAASX,EAER,SAAAW,GAAaA,IAAc,gBAAkB,OAAS,OAAA,CAAA,CAE3D,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAEJ,CCtEO,SAASK,IAAY,CAE1B,KAAM,CAACC,EAAaC,CAAc,EAAIC,EAAS,IAAI,EAG7C,CAACC,EAAcC,CAAe,EAAIF,EAAS,IAAI,EAC/C,CAACG,EAAQC,CAAS,EAAIJ,EAAS,EAAE,EAGjC,CAACtB,EAAU2B,CAAW,EAAIL,EAAS,CACvC,SAAU,GACV,SAAU,GACV,MAAO,GACP,KAAM,EACN,UAAW,EAAA,CACZ,EAMKM,EAAiBC,EAAY,IAAM,CACjC,MAAAC,EAAO,aAAa,QAAQ,MAAM,EACxC,OAAOA,EAAO,CAAE,cAAiB,SAAWA,GAAS,CAAC,CACxD,EAAG,EAAE,EAGC,CACJ,KAAMC,EACN,UAAWC,EACX,MAAAC,GACA,QAASC,CAAA,EACPC,EACF,CAAC,OAAO,EACR,kBACA,CACE,QAASP,EAAe,EACxB,MAAO,WACP,QAAS,KACT,QAAS,EACT,WAAY,GAAA,CAEhB,EAGMxC,GAAQ2C,GAAA,YAAAA,EAAW,QAAS,CAAC,EAG7BK,EAAqBP,EAAY,IAAM,CAE/BF,EAAA,CACV,SAAU,GACV,SAAU,GACV,MAAO,GACP,KAAM,EACN,UAAW,EAAA,CACZ,EACDN,EAAe,KAAK,CACtB,EAAG,EAAE,EAMCpB,EAAoB4B,EAAanC,GAAM,CAC3C,KAAM,CAAE,KAAA2C,EAAM,MAAAjC,EAAO,KAAAkC,EAAM,QAAAC,CAAA,EAAY7C,EAAE,OAEzCiC,EAAyBa,IAAA,CACvB,GAAGA,EACH,CAACH,CAAI,EAAGC,IAAS,WAAaC,EAAWF,IAAS,OAAS,SAASjC,EAAO,EAAE,EAAIA,CAAA,EACjF,CACJ,EAAG,EAAE,EAGCqC,EAAkBC,EAAY,CAClC,WAAY,MAAOC,GACV,MAAMC,EAAU,kBAAmB,CACxC,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,GAAGhB,EAAe,CACpB,EACA,KAAM,KAAK,UAAUe,CAAQ,EAC7B,QAAS,KACT,QAAS,EACT,WAAY,GAAA,CACb,EAEH,UAAW,IAAM,CAEftB,EAAe,IAAI,EACDwB,EAAA,0BAA2B,UAAW,GAAI,EAG/CX,EAAA,CACf,EACA,QAAUD,GAAU,CACV,QAAA,MAAM,qBAAsBA,CAAK,EACzCY,EAAkB,sBAAsBZ,OAAAA,EAAM,SAAW,QAAS,GAAI,CAAA,CACxE,CACD,EAGKa,EAAmBJ,EAAY,CACnC,WAAY,MAAO,CAAE,OAAAK,EAAQ,SAAAJ,KACpB,MAAMC,EAAU,mBAAmB,OAAAG,GAAU,CAClD,OAAQ,MACR,QAAS,CACP,eAAgB,mBAChB,GAAGnB,EAAe,CACpB,EACA,KAAM,KAAK,UAAUe,CAAQ,EAC7B,QAAS,KACT,QAAS,EACT,WAAY,GAAA,CACb,EAEH,UAAW,IAAM,CAEftB,EAAe,IAAI,EACDwB,EAAA,4BAA6B,UAAW,GAAI,EAGjDX,EAAA,CACf,EACA,QAAUD,GAAU,CACV,QAAA,MAAM,uBAAwBA,CAAK,EAC3CY,EAAkB,wBAAwBZ,OAAAA,EAAM,SAAW,QAAS,GAAI,CAAA,CAC1E,CACD,EAGKe,EAAqBN,EAAY,CACrC,WAAY,MAAOK,GACV,MAAMH,EAAU,mBAAmB,OAAAG,GAAU,CAClD,OAAQ,SACR,QAASnB,EAAe,EACxB,QAAS,KACT,QAAS,EACT,WAAY,GAAA,CACb,EAEH,UAAW,IAAM,CAEfP,EAAe,IAAI,EACDwB,EAAA,4BAA6B,UAAW,GAAI,EAGjDX,EAAA,CACf,EACA,QAAUD,GAAU,CACV,QAAA,MAAM,uBAAwBA,CAAK,EAC3CY,EAAkB,wBAAwBZ,OAAAA,EAAM,SAAW,QAAS,GAAI,CAAA,CAC1E,CACD,EAGKgB,EAAyBP,EAAY,CACzC,WAAY,MAAOK,GACV,MAAMH,EAAU,mBAAmB,OAAAG,EAAM,YAAY,CAC1D,OAAQ,OACR,QAASnB,EAAe,EACxB,QAAS,IACT,QAAS,EACT,WAAY,GAAA,CACb,EAEH,SAAU,IAAM,CAEdF,EAAU,eAAe,CAC3B,EACA,UAAYwB,GAAS,CAEnBxB,EAAUwB,EAAK,OAAO,EACtBL,EAAkB,iCAAkC,SAAS,EAI7D,WAAW,IAAM,CACFX,EAAA,GACZ,GAAG,CACR,EACA,QAAUD,GAAU,CACV,QAAA,MAAM,4BAA6BA,CAAK,EAChDP,EAAU,EAAE,EACZmB,EAAkB,6BAA6BZ,OAAAA,EAAM,SAAW,OAAO,CAAA,CACzE,CACD,EAMK/B,EAAgB2B,EAAanC,GAAM,CACnCA,KAAK,eAAe,EAEhB,QAAA,IAAI,eAAgBM,EAAS,QAAQ,EAC7CyC,EAAgB,OAAOzC,CAAQ,CAAA,EAC9B,CAACA,CAAQ,CAAC,EAMPQ,EAAiBqB,EAAanC,GAAM,CACpCA,KAAK,eAAe,EAExB,QAAQ,IAAI,gBAAiB6B,EAAa,GAAIA,EAAa,QAAQ,EACnEuB,EAAiB,OAAO,CACtB,OAAQvB,EAAa,GACrB,SAAUvB,CAAA,CACX,CAAA,EACA,CAACuB,EAAcvB,CAAQ,CAAC,EAKrBW,EAAmBkB,EAAY,IAAM,CACzC,QAAQ,IAAI,iBAAkBN,EAAa,GAAIA,EAAa,QAAQ,EACjDyB,EAAA,OAAOzB,EAAa,EAAE,CAAA,EACxC,CAACA,CAAY,CAAC,EAKXR,EAAuBc,EAAY,IAAM,CAC7C,QAAQ,IAAI,+BAAgCN,EAAa,GAAIA,EAAa,QAAQ,EAC3D0B,EAAA,OAAO1B,EAAa,EAAE,CAAA,EAC5C,CAACA,CAAY,CAAC,EAKXP,EAAaa,EAAY,IAAM,CACnC,UAAU,UAAU,UAAUJ,CAAM,EACjC,KAAK,IAAM,CAEN,OAAO,iBACT,OAAO,iBAAiB,6BAA6B,EAGrDoB,EAAkB,8BAA+B,SAAS,CAC5D,CACD,EACA,MAAOM,GAAQ,CACN,QAAA,MAAM,yBAA0BA,CAAG,EAGvC,OAAO,eACT,OAAO,eAAe,wBAAwB,EAG9CN,EAAkB,yBAA0B,OAAO,CACrD,CACD,CAAA,EACF,CAACpB,CAAM,CAAC,EAML2B,EAAgBvB,EAAapC,GAAS,CAC1C+B,EAAgB/B,CAAI,EACRkC,EAAA,CACV,SAAUlC,EAAK,SACf,SAAU,GACV,MAAOA,EAAK,OAAS,GACrB,KAAMA,EAAK,KACX,UAAWA,EAAK,SAAA,CACjB,EACD4B,EAAe,MAAM,CACvB,EAAG,EAAE,EAMCgC,EAAkBxB,EAAapC,GAAS,CAC5C+B,EAAgB/B,CAAI,EACpB4B,EAAe,QAAQ,CACzB,EAAG,EAAE,EAMCiC,EAAkBzB,EAAapC,GAAS,CAC5C+B,EAAgB/B,CAAI,EACpBiC,EAAU,EAAE,EACZL,EAAe,QAAQ,CACzB,EAAG,EAAE,EAKCkC,EAAa1B,EAAY,IAAM,CACnCR,EAAe,IAAI,CACrB,EAAG,EAAE,EAGD,OAAAW,GAAW5C,EAAM,SAAW,EAE5BS,EAAC,MAAI,CAAA,UAAU,uCACb,SAAA,CAACC,EAAA,MAAA,CAAI,UAAU,mFAAoF,CAAA,EAClGA,EAAA,OAAA,CAAK,UAAU,UAAU,SAAU,YAAA,CAAA,CAAA,EACtC,EAKAV,EAAM,SAAW,GAAK,CAAC4C,IAEtB,MACC,CAAA,SAAA,CAACnC,EAAA,MAAA,CAAI,UAAU,yCACb,SAAA,CAACC,EAAA,KAAA,CAAG,UAAU,wBAAwB,SAAe,kBAAA,EACrDA,EAAC,SAAA,CACC,UAAU,+EACV,QAASsC,EACV,SAAA,UAAA,CAAA,CAED,EACF,EAEAvC,EAAC,MAAI,CAAA,UAAU,mFACb,SAAA,CAACC,EAAA,KAAA,CAAG,UAAU,iBAAiB,SAAc,iBAAA,EAC7CA,EAAC,KAAE,SAAsD,wDAAA,CAAA,CAAA,EAC3D,EACCsB,IAAgB,OACftB,EAACC,EAAA,CACC,SAAAC,EACA,kBAAAC,EACA,cAAAC,EACA,QAASqD,CAAA,CAAA,CACX,EAEJ,IAMD,MACC,CAAA,SAAA,CAAC1D,EAAA,MAAA,CAAI,UAAU,yCACb,SAAA,CAACC,EAAA,KAAA,CAAG,UAAU,wBAAwB,SAAe,kBAAA,EACrDA,EAAC,SAAA,CACC,UAAU,+EACV,QAASsC,EACV,SAAA,UAAA,CAAA,CAED,EACF,EAEAtC,EAACX,EAAA,CACC,MAAAC,EACA,OAAQgE,EACR,SAAUC,EACV,SAAUC,CAAA,CACZ,EAEClC,IAAgB,OACftB,EAACC,EAAA,CACC,SAAAC,EACA,kBAAAC,EACA,cAAAC,EACA,QAASqD,CAAA,CACX,EAGDnC,IAAgB,QACftB,EAACQ,EAAA,CACC,YAAaiB,EACb,SAAAvB,EACA,kBAAAC,EACA,eAAAO,EACA,QAAS+C,CAAA,CACX,EAGDnC,IAAgB,UACftB,EAACY,EAAA,CACC,YAAaa,EACb,iBAAAZ,EACA,QAAS4C,CAAA,CACX,EAGDnC,IAAgB,UACftB,EAACe,EAAA,CACC,YAAaU,EACb,UAAWE,EACX,qBAAAV,EACA,WAAAC,EACA,QAASuC,CAAA,CAAA,CACX,EAEJ,CAEJ,CCrZA,SAAS,iBAAiB,mBAAoB,IAAM,CAE5C,MAAAC,EAAY,SAAS,eAAe,cAAc,EAEpDA,GACFC,EACE5D,EAAC6D,EAAoB,CAAA,OAAQC,EAC3B,SAAA,CAAA7D,EAAC8D,EAAO,EAAA,IACPC,EAAe,EAAA,IACf1C,GAAU,EAAA,IACV2C,EAAO,CAAA,CAAA,CAAA,EACV,EACAN,CACF,CAEJ,CAAC"}